!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ExifReader=e():t.ExifReader=e()}(Object("undefined"!=typeof self?self:this),function(){return function(){"use strict";var t={d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:1,get:n[r]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:1})}},e={};function n(t,e,n){for(var r=[],o=0;o<n&&e+o<t.byteLength;o++)r.push(t.getUint8(e+o));return i(r)}function r(t,e){for(var n=[],r=0;e+r<t.byteLength;){var o=t.getUint8(e+r);if(0===o)break;n.push(o),r++}return i(n)}function i(t){return t.map(function(t){return String.fromCharCode(t)}).join("")}function o(){for(var t=1;t<arguments.length;t++)for(var e in arguments[t])arguments[0][e]=arguments[t][e];return arguments[0]}t.r(e),t.d(e,{default:function(){return Mn},errors:function(){return Rn},load:function(){return Bn},loadView:function(){return jn}});var u=void 0;function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function f(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""}(t);return"symbol"==a(e)?e:e+""}var c=function(){return t=function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t){return"object"!==a(t)||void 0===t.length||void 0===t.readUInt8||void 0===t.readUInt16LE||void 0===t.readUInt16BE||void 0===t.readUInt32LE||void 0===t.readUInt32BE||void 0===t.readInt32LE||void 0===t.readInt32BE}(e))throw Error("DataView: Passed buffer type is unsupported.");this.buffer=e,this.byteLength=this.buffer.length},(e=[{key:"getUint8",value:function(t){return this.buffer.readUInt8(t)}},{key:"getUint16",value:function(t,e){return e?this.buffer.readUInt16LE(t):this.buffer.readUInt16BE(t)}},{key:"getUint32",value:function(t,e){return e?this.buffer.readUInt32LE(t):this.buffer.readUInt32BE(t)}},{key:"getInt32",value:function(t,e){return e?this.buffer.readInt32LE(t):this.buffer.readInt32BE(t)}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||0,r.configurable=1,"value"in r&&(r.writable=1),Object.defineProperty(t,f(r.key),r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:0}),t;var t,e}();function s(t){return t[0][0]/t[0][1]+t[1][0]/t[1][1]/60+t[2][0]/t[2][1]/3600}var l=2,d=65496,p=2,v=4,g=2,h=10,m=18,y=33,b=79,x=65472,A=65474,S=65476,w=65499,U=65501,I=65498,O=65504,T=65505,C=65517,P=65519,E=65534,k=65535,L="Exif",N="http://ns.adobe.com/xap/1.0/\0",M="http://ns.adobe.com/xmp/extension/\0",R="Photoshop 3.0";function B(t,e){var r=L.length;return t.getUint16(e)===T&&n(t,e+v,r)===L&&0===t.getUint8(e+v+r)}function _(t,e){return t.getUint16(e)===T&&function(t,e){var r=N.length;return n(t,e+v,r)===N}(t,e)}function j(t,e){return t.getUint16(e)===T&&function(t,e){var r=M.length;return n(t,e+v,r)===M}(t,e)}function D(t,e){return{dataOffset:t+y,length:e-(y-g)}}function z(t,e){return{dataOffset:t+b,length:e-(b-g)}}function F(t,e){var r=R.length;return t.getUint16(e)===C&&n(t,e+v,r)===R&&0===t.getUint8(e+v+r)}function G(t,e){var n=t.getUint16(e);return n>=O&&n<=P||n===E||n===x||n===A||n===S||n===w||n===U||n===I}function H(t,e){return t.getUint16(e)===k}var V="Â‰PNG\r\n\n",W=4,X=4,Y=0,$=W,q=W+X,Z="XML:com.adobe.xmp\0",K="tEXt",J="iTXt",Q="zTXt",tt="pHYs",et="tIME",nt="eXIf";function rt(t,e){return n(t,e+$,X)===J&&n(t,e+q,Z.length)===Z}function it(t,e,r){var i=n(t,e+$,X);return i===K||i===J||i===Q&&r}function ot(t,e){return n(t,e+$,X)===nt}function ut(t,e){var r=[tt,et],i=n(t,e+$,X);return r.includes(i)}function at(t,e){e+=q+Z.length+1+1;for(var n=0;n<2&&e<t.byteLength;)0===t.getUint8(e)&&n++,e++;if(!(n<2))return e}function ft(t,e,n,r,i,o,u,a){if(void 0===a)return[];for(var f=[],c=n.items,s=0;s<a;s++){var l={extents:[]};l.itemId=ct(t,c,e),c+=r.item.itemId,l.constructionMethod=1===e||2===e?15&t.getUint16(c):void 0,c+=r.item.constructionMethod,l.dataReferenceIndex=t.getUint16(c),c+=r.item.dataReferenceIndex,l.baseOffset=lt(t,c,r.item.baseOffset),c+=r.item.baseOffset,l.extentCount=t.getUint16(c),c+=r.item.extentCount;for(var d=0;d<l.extentCount;d++){var p={};p.extentIndex=st(t,e,c,u),c+=r.item.extent.extentIndex,p.extentOffset=lt(t,c,i),c+=r.item.extent.extentOffset,p.extentLength=lt(t,c,o),c+=r.item.extent.extentLength,l.extents.push(p)}f.push(l)}return f}function ct(t,e,n){return n<2?t.getUint16(e):2===n?t.getUint32(e):void 0}function st(t,e,n,r){if((1===e||2===e)&&r>0)return lt(t,n,r)}function lt(t,e,n){return 4===n?t.getUint32(e):8===n?(console.warn("This file uses an 8-bit offset which is currently not supported by ExifReader. Contact the maintainer to get it fixed."),function(t,e){return t.getUint32(e+4)}(t,e)):0}var dt=1165519206,pt=1835625829;function vt(t,e){var i=function(t,e){var n=t.getUint32(e);return function(t){return 0===t}(n)?{length:t.byteLength-e,contentOffset:e+4+4}:function(t){return 1===t}(n)&&function(t,e){return 0===t.getUint32(e+8)}(t,e)?{length:t.getUint32(e+12),contentOffset:e+4+4+8}:{length:n,contentOffset:e+4+4}}(t,e),o=i.length,u=i.contentOffset;if(!(o<8)){var a=t.getUint32(e+4);if(1718909296===a)return function(t,e,r){return{type:"ftyp",majorBrand:n(t,e,4),length:r}}(t,u,o);if(1768977008===a)return function(t,e,n,r){return{type:"iprp",subBoxes:mt(t,n,r-(n-e)),length:r}}(t,e,u,o);if(1768973167===a)return function(t,e,n,r){return{type:"ipco",properties:mt(t,n,r-(n-e)),length:r}}(t,e,u,o);if(1668246642===a)return function(t,e,n){return{type:"colr",icc:ht(t,e),length:n}}(t,u,o);var f=t.getUint8(u);return 1835365473===a?function(t,e,n,r){return{type:"meta",subBoxes:mt(t,n+3,r-(n+3-e)),length:r}}(t,e,u+1,o):1768714083===a?function(t,e,n,r){var i=function(t,e){var n={item:{dataReferenceIndex:2,extentCount:2,extent:{}}};t<2?(n.itemCount=2,n.item.itemId=2):2===t&&(n.itemCount=4,n.item.itemId=4),n.item.constructionMethod=1===t||2===t?2:0;var r={offsetSize:e,lengthSize:e,baseOffsetSize:e+1,indexSize:e+1};return r.itemCount=e+2,r.items=r.itemCount+n.itemCount,r.item={itemId:0},r.item.constructionMethod=r.item.itemId+n.item.itemId,r.item.dataReferenceIndex=r.item.constructionMethod+n.item.constructionMethod,{offsets:r,sizes:n}}(e,n+3),o=i.offsets,u=i.sizes,a=t.getUint8(o.offsetSize)>>4;u.item.extent.extentOffset=a;var f=15&t.getUint8(o.lengthSize);u.item.extent.extentLength=f;var c=t.getUint8(o.baseOffsetSize)>>4;u.item.baseOffset=c;var s=function(t,e,n){if(1===n||2===n)return 15&t.getUint8(e)}(t,o.indexSize,e);u.item.extent.extentIndex=void 0!==s?s:0;var l=function(t,e,n){return n<2?t.getUint16(e):2===n?t.getUint32(e):void 0}(t,o.itemCount,e);return{type:"iloc",items:ft(t,e,o,u,a,f,s,l),length:r}}(t,f,u+1,o):1768517222===a?function(t,e,n,r,i){var o=function(t,e){var n={entryCount:e+3},r={};return r.entryCount=0===t?2:4,n.itemInfos=n.entryCount+r.entryCount,{offsets:n}}(n,r),u=o.offsets;return{type:"iinf",itemInfos:mt(t,u.itemInfos,i-(u.itemInfos-e)),length:i}}(t,e,f,u+1,o):1768842853===a?function(t,e,n,i,o){i+=3;var u={type:"infe",length:o};return 0!==n&&1!==n||(u.itemId=t.getUint16(i),i+=2,u.itemProtectionIndex=t.getUint16(i),i+=2,u.itemName=r(t,i),i+=u.itemName.length+1),n>=2&&(2===n?(u.itemId=t.getUint16(i),i+=2):3===n&&(u.itemId=t.getUint32(i),i+=4),u.itemProtectionIndex=t.getUint16(i),i+=2,u.itemType=t.getUint32(i),i+=4,u.itemName=r(t,i),i+=u.itemName.length+1,u.itemType===pt?(u.contentType=r(t,i),e+o>(i+=u.contentType.length+1)&&(u.contentEncoding=r(t,i),i+=u.contentEncoding.length+1)):1970432288===u.itemType&&(u.itemUri=r(t,i),i+=u.itemUri.length+1)),u}(t,e,f,u+1,o):{type:void 0,length:o}}}function gt(t,e){return t.subBoxes.find(function(t){return"iloc"===t.type}).items.find(function(t){return t.itemId===e})}function ht(t,e){var r=n(t,e,4);if("prof"===r||"rICC"===r)return{offset:e+4,length:t.getUint32(e+4),chunkNumber:1,chunksTotal:1}}function mt(t,e,n){for(var r=[dt,pt],i=[],o=e;o<e+n;){var u=vt(t,o);if(void 0===u)break;void 0===u.type||void 0!==u.itemType&&-1===r.indexOf(u.itemType)||i.push(u),o+=u.length}return i}var yt=0,bt="<?xpacket begin",xt={parseAppMarkers:function(t,e){if(function(t){return!!t&&t.byteLength>=l&&t.getUint16(0)===d}(t))return At(function(t){for(var e,n,r,i,o=p;o+v+5<=t.byteLength;){if(B(t,o))e=t.getUint16(o+g),n=o+h;else if(_(t,o))i||(i=[]),e=t.getUint16(o+g),i.push(D(o,e));else if(j(t,o))i||(i=[]),e=t.getUint16(o+g),i.push(z(o,e));else if(F(t,o))e=t.getUint16(o+g),r=o+m;else{if(!G(t,o)){if(H(t,o)){o++;continue}break}e=t.getUint16(o+g)}o+=g+e}return{hasAppMarkers:o>p,fileDataOffset:void 0,jfifDataOffset:void 0,tiffHeaderOffset:n,iptcDataOffset:r,xmpChunks:i,iccChunks:void 0,mpfDataOffset:void 0}}(t),"jpeg","JPEG");if(function(t){return!!t&&n(t,0,V.length)===V}(t))return At(function(t,e){for(var r={hasAppMarkers:0},i=V.length;i+W+X<=t.byteLength;){if(rt(t,i)){var o=at(t,i);void 0!==o&&(r.hasAppMarkers=1,r.xmpChunks=[{dataOffset:o,length:t.getUint32(i+Y)-(o-(i+q))}])}else if(it(t,i,e)){r.hasAppMarkers=1;var u=n(t,i+$,X);r.pngTextChunks||(r.pngTextChunks=[]),r.pngTextChunks.push({length:t.getUint32(i+Y),type:u,offset:i+q})}else ot(t,i)?(r.hasAppMarkers=1,r.tiffHeaderOffset=i+q):ut(t,i)&&(r.hasAppMarkers=1,r.pngChunkOffsets||(r.pngChunkOffsets=[]),r.pngChunkOffsets.push(i+Y));i+=t.getUint32(i+Y)+W+X+4}return r}(t,e),"png","PNG");if(function(t){if(!t)return 0;try{var e=vt(t,0);return e&&-1!==["heic","heix","hevc","hevx","heim","heis","hevm","hevs","mif1"].indexOf(e.majorBrand)}catch(t){return 0}}(t))return At(function(t){return function(t){var e={},n=function(t){for(var e=0;e+4+4<=t.byteLength;){var n=vt(t,e);if(void 0===n)break;if("meta"===n.type)return n;e+=n.length}}(t);return n?(e.tiffHeaderOffset=function(t,e){try{var n=function(t){return t.subBoxes.find(function(t){return"iinf"===t.type}).itemInfos.find(function(t){return t.itemType===dt})}(e).itemId,r=gt(e,n);return function(t,e){return e+4+t.getUint32(e)}(t,r.baseOffset+r.extents[0].extentOffset)}catch(t){return}}(t,n),e.xmpChunks=function(t){try{var e=function(t){return t.subBoxes.find(function(t){return"iinf"===t.type}).itemInfos.find(function(t){return t.itemType===pt&&"application/rdf+xml"===t.contentType})}(t).itemId,n=gt(t,e),r=gt(t,e).extents[0];return[{dataOffset:n.baseOffset+r.extentOffset,length:r.extentLength}]}catch(t){return}}(n),e.hasAppMarkers=void 0!==e.tiffHeaderOffset||void 0!==e.xmpChunks||void 0!==e.iccChunks,e):{hasAppMarkers:0}}(t)}(t),"heic","HEIC");if(function(t){return!!t&&"RIFF"===n(t,0,4)&&"WEBP"===n(t,8,4)}(t))return At(function(t){for(var e,r,i,o=12,u=0;o+8<t.byteLength;){var a=n(t,o,4),f=t.getUint32(o+4,1);"EXIF"===a?(u=1,e="Exif\0\0"===n(t,o+8,6)?o+8+6:o+8):"XMP "===a?(u=1,r=[{dataOffset:o+8,length:f}]):"VP8X"===a&&(u=1,i=o+8),o+=8+(f%2==0?f:f+1)}return{hasAppMarkers:u,tiffHeaderOffset:e,xmpChunks:r,iccChunks:void 0,vp8xChunkOffset:i}}(t),"webp","WebP");if(function(t){return!!t&&n(t,yt,bt.length)===bt}(t))return At(function(t){var e=[];return e.push({dataOffset:yt,length:t.byteLength}),{xmpChunks:e}}(t),"xml","XML");throw Error("Invalid image format")}};function At(t,e,n){return o({},t,{fileType:{value:e,description:n}})}var St=18761,wt=St,Ut={270:"ImageDescription",700:"ApplicationNotes",33723:"IPTC-NAA",34665:"Exif IFD Pointer"};function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function Ot(t,e,n){return(e=function(t){var e=function(t){if("object"!=It(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=It(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""}(t);return"symbol"==It(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:1,configurable:1,writable:1}):t[e]=n,t}var Tt=o({},Ut,{}),Ct="exif",Pt="interoperability",Et="pentax",kt=Ot(Ot(Ot(Ot(Ot(Ot(Ot(Ot({},"0th",Tt),"1st",Ut),Ct,Tt),"gps",{}),Pt,{}),"mpf",{}),"canon",{}),Et,{}),Lt={1:1,2:1,3:2,4:4,5:8,7:1,9:4,10:8,13:4},Nt={BYTE:1,ASCII:2,SHORT:3,LONG:4,RATIONAL:5,UNDEFINED:7,SLONG:9,SRATIONAL:10,IFD:13},Mt={getAsciiValue:function(t){return t.map(function(t){return String.fromCharCode(t)})},getByteAt:Rt,getAsciiAt:function(t,e){return t.getUint8(e)},getShortAt:function(t,e,n){return t.getUint16(e,n===wt)},getLongAt:Bt,getRationalAt:function(t,e,n){return[Bt(t,e,n),Bt(t,e+4,n)]},getUndefinedAt:function(t,e){return Rt(t,e)},getSlongAt:_t,getSrationalAt:function(t,e,n){return[_t(t,e,n),_t(t,e+4,n)]},getIfdPointerAt:function(t,e,n){return Bt(t,e,n)},typeSizes:Lt,tagTypes:Nt,getTypeSize:function(t){if(void 0===Nt[t])throw Error("No such type found.");return Lt[Nt[t]]}};function Rt(t,e){return t.getUint8(e)}function Bt(t,e,n){return t.getUint32(e,n===wt)}function _t(t,e,n){return t.getInt32(e,n===wt)}var jt={1:Mt.getByteAt,2:Mt.getAsciiAt,3:Mt.getShortAt,4:Mt.getLongAt,5:Mt.getRationalAt,7:Mt.getUndefinedAt,9:Mt.getSlongAt,10:Mt.getSrationalAt,13:Mt.getIfdPointerAt};function Dt(t,e,n,r,i,o){var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=Mt.getTypeSize("SHORT"),f={},c=function(t,e,n){return e+Mt.getTypeSize("SHORT")<=t.byteLength?Mt.getShortAt(t,e,n):0}(t,r,i);r+=a;for(var s=0;s<c&&!(r+12>t.byteLength);s++){var l=zt(t,e,n,r,i,o);void 0!==l&&(f[l.name]={id:l.id,value:l.value,description:l.description},u&&(f[l.name].computed=Ht(l.tagType,l.value)),("MakerNote"===l.name||e===Et&&"LevelInfo"===l.name)&&(f[l.name].__offset=l.__offset)),r+=12}return f}function zt(t,e,n,r,i,o){var u,a,f=Mt.getTypeSize("SHORT"),c=f+Mt.getTypeSize("SHORT"),s=c+Mt.getTypeSize("LONG"),l=Mt.getShortAt(t,r,i),d=Mt.getShortAt(t,r+f,i),p=Mt.getLongAt(t,r+c,i);if(void 0!==Mt.typeSizes[d]&&(o||void 0!==kt[e][l])){u=function(t,e){return Mt.typeSizes[t]*e<=Mt.getTypeSize("LONG")}(d,p)?Ft(t,a=r+s,d,p,i):function(t,e,n,r,i){return e+n+Mt.typeSizes[r]*i<=t.byteLength}(t,n,a=Mt.getLongAt(t,r+s,i),d,p)?Ft(t,n+a,d,p,i,33723===l):"<faulty value>",d===Mt.tagTypes.ASCII&&(u=function(t){try{return t.map(function(t){return decodeURIComponent(escape(t))})}catch(e){return t}}(u=function(t){for(var e=[],n=0,r=0;r<t.length;r++)"\0"!==t[r]?(void 0===e[n]&&(e[n]=""),e[n]+=t[r]):n++;return e}(u)));var v="undefined-".concat(l),g=u;if(void 0!==kt[e][l])if(void 0!==kt[e][l].name&&void 0!==kt[e][l].description){v=kt[e][l].name;try{g=kt[e][l].description(u)}catch(t){g=Gt(u)}}else d===Mt.tagTypes.RATIONAL||d===Mt.tagTypes.SRATIONAL?(v=kt[e][l],g=""+u[0]/u[1]):(v=kt[e][l],g=Gt(u));return{id:l,name:v,value:u,description:g,tagType:d,__offset:a}}}function Ft(t,e,n,r,i){var o=[];arguments.length>5&&void 0!==arguments[5]&&arguments[5]&&(r*=Mt.typeSizes[n],n=Mt.tagTypes.BYTE);for(var u=0;u<r;u++)o.push(jt[n](t,e,i)),e+=Mt.typeSizes[n];return n===Mt.tagTypes.ASCII?o=Mt.getAsciiValue(o):1===o.length&&(o=o[0]),o}function Gt(t){return t instanceof Array?t.join(", "):t}function Ht(t,e){return t===Mt.tagTypes.ASCII?Array.isArray(e)&&1===e.length?e[0]:e:t===Mt.tagTypes.RATIONAL||t===Mt.tagTypes.SRATIONAL?function(t){return Array.isArray(t)&&2===t.length?"number"==typeof t[0]&&"number"==typeof t[1]:0}(e)?Vt(e):Array.isArray(e)?e.map(function(t){return Vt(t)}):e:e}function Vt(t){if(!Array.isArray(t)||2!==t.length)return t;var e=t[0],n=t[1];return Number.isFinite(e)&&Number.isFinite(n)?0===n?null:e/n:t}var Wt="Exif IFD Pointer",Xt="GPS Info IFD Pointer",Yt="Interoperability IFD Pointer",$t={read:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=function(t,e){if(t.getUint16(e)===St)return St;if(19789===t.getUint16(e))return 19789;throw Error("Illegal byte order value. Faulty image.")}(t,e),o=function(t,e,n,r,i){return Dt(t,"0th",e,function(t,e,n){return e+Mt.getLongAt(t,e+4,n)}(t,e,n),n,r,i)}(t,e,i,n,r);return{tags:o=Kt(o=Zt(o=qt(o,t,e,i,n,r),t,e,i,n,r),t,e,i,n,r),byteOrder:i}}};function qt(t,e,n,r,i,u){return void 0!==t[Wt]?o(t,Dt(e,Ct,n,n+t[Wt].value,r,i,u)):t}function Zt(t,e,n,r,i,u){return void 0!==t[Xt]?o(t,Dt(e,"gps",n,n+t[Xt].value,r,i,u)):t}function Kt(t,e,n,r,i,u){return void 0!==t[Yt]?o(t,Dt(e,Pt,n,n+t[Yt].value,r,i,u)):t}var Jt={iptc:{632:"Caption/Abstract"}},Qt=function(t,e){var n=function(){if("undefined"!=typeof TextDecoder)return TextDecoder}();if("undefined"!=typeof n&&void 0!==t)try{return new n(t).decode(e instanceof DataView?e.buffer:Uint8Array.from(e))}catch(t){}return function(t){try{return decodeURIComponent(escape(t))}catch(e){return t}}(e.map(function(t){return String.fromCharCode(t)}).join(""))},te={read:function(t,e,n){try{if(Array.isArray(t))return ie(new DataView(Uint8Array.from(t).buffer),{size:t.length},0,n);var r=function(t,e){for(;e+12<=t.byteLength;){var n=ee(t,e);if(ne(n))return{naaBlock:n,dataOffset:e+n.headerSize};e+=n.headerSize+n.size+re(n)}throw Error("No IPTC NAA resource block.")}(t,e);return ie(t,r.naaBlock,r.dataOffset,n)}catch(t){return{}}}};function ee(t,e){if(943868237!==t.getUint32(e,0))throw Error("Not an IPTC resource block.");var n=t.getUint8(e+4+2),r=(n%2==0?n+1:n)+1;return{headerSize:6+r+4,type:t.getUint16(e+4),size:t.getUint32(e+4+2+r)}}function ne(t){return 1028===t.type}function re(t){return t.size%2!=0?1:0}function ie(t,e,n,r){for(var i={},o=void 0,u=n+e.size;n<u&&n<t.byteLength;){var a=oe(t,n,i,o,r),f=a.tag,c=a.tagSize;if(null===f)break;f&&("encoding"in f&&(o=f.encoding),void 0===i[f.name]||void 0===f.repeatable?i[f.name]={id:f.id,value:f.value,description:f.description}:(i[f.name]instanceof Array||(i[f.name]=[{id:i[f.name].id,value:i[f.name].value,description:i[f.name].description}]),i[f.name].push({id:f.id,value:f.value,description:f.description}))),n+=5+c}return i}function oe(t,e,n,r,i){if(function(t,e){return 28!==t.getUint8(e)}(t,e))return{tag:null,tagSize:0};var o=t.getUint16(e+1),u=t.getUint16(e+3);if(!i&&!Jt.iptc[o])return{tag:void 0,tagSize:u};var a=function(t,e,n){for(var r=[],i=0;i<n;i++)r.push(t.getUint8(e+i));return r}(t,e+5,u),f={id:o,name:ue(Jt.iptc[o],o,a),value:a,description:ae(Jt.iptc[o],a,n,r)};return function(t){return Jt.iptc[t]&&Jt.iptc[t].repeatable}(o)&&(f.repeatable=1),function(t){return Jt.iptc[t]&&void 0!==Jt.iptc[t].encoding_name}(o)&&(f.encoding=Jt.iptc[o].encoding_name(a)),{tag:f,tagSize:u}}function ue(t,e,n){return t?function(t){return"string"==typeof t}(t)?t:function(t){return"function"==typeof t.name}(t)?t.name(n):t.name:"undefined-".concat(e)}function ae(t,e,n,r){if(function(t){return t&&void 0!==t.description}(t))try{return t.description(e,n)}catch(t){}return function(t,e){return t&&e instanceof Array}(t,e)?Qt(r,e):e}var fe=function(t){return Math.pow(Math.sqrt(2),t[0]/t[1]).toFixed(2)},ce=function(t){return"f/".concat(Number(t[0]/t[1]).toFixed(1))},se=function(t){return t[0]/t[1]+" mm"},le=function(t){var e=Math.pow(2,t[0]/t[1]);return e<=1?"".concat(Math.round(1/e)):"1/".concat(Math.round(e))},de=function(t){return""+Math.round(t[0]/t[1])},pe=function(t){return""+Math.round(t[0]/t[1])};function ve(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var ge={"tiff:Orientation":function(t){return"1"===t?"Horizontal (normal)":"2"===t?"Mirror horizontal":"3"===t?"Rotate 180":"4"===t?"Mirror vertical":"5"===t?"Mirror horizontal and rotate 270 CW":"6"===t?"Rotate 90 CW":"7"===t?"Mirror horizontal and rotate 90 CW":"8"===t?"Rotate 270 CW":t},"tiff:ResolutionUnit":function(t){return function(t){return 2===t?"inches":3===t?"centimeters":"Unknown"}(parseInt(t,10))},"tiff:XResolution":function(t){return he(de,t)},"tiff:YResolution":function(t){return he(pe,t)},"exif:ApertureValue":function(t){return he(fe,t)},"exif:GPSLatitude":ye,"exif:GPSLongitude":ye,"exif:FNumber":function(t){return he(ce,t)},"exif:FocalLength":function(t){return he(se,t)},"exif:FocalPlaneResolutionUnit":function(t){return function(t){return 2===t?"inches":3===t?"centimeters":4===t?"millimeters":"Unknown"}(parseInt(t,10))},"exif:ColorSpace":function(t){return function(t){return 1===t?"sRGB":65535===t?"Uncalibrated":"Unknown"}(function(t){return"0x"===t.substring(0,2)?parseInt(t.substring(2),16):parseInt(t,10)}(t))},"exif:ComponentsConfiguration":function(t,e){return/^\d, \d, \d, \d$/.test(e)?function(t){return t.map(function(t){return 49===t?"Y":50===t?"Cb":51===t?"Cr":52===t?"R":53===t?"G":54===t?"B":void 0}).join("")}(e.split(", ").map(function(t){return t.charCodeAt(0)})):e},"exif:Contrast":function(t){return function(t){return 0===t?"Normal":1===t?"Soft":2===t?"Hard":"Unknown"}(parseInt(t,10))},"exif:CustomRendered":function(t){return function(t){return 0===t?"Normal process":1===t?"Custom process":"Unknown"}(parseInt(t,10))},"exif:ExposureMode":function(t){return function(t){return 0===t?"Auto exposure":1===t?"Manual exposure":2===t?"Auto bracket":"Unknown"}(parseInt(t,10))},"exif:ExposureProgram":function(t){return function(t){return 0===t?"Undefined":1===t?"Manual":2===t?"Normal program":3===t?"Aperture priority":4===t?"Shutter priority":5===t?"Creative program":6===t?"Action program":7===t?"Portrait mode":8===t?"Landscape mode":9===t?"Bulb":"Unknown"}(parseInt(t,10))},"exif:ExposureTime":function(t){return me(t)?function(t){if(t[0]/t[1]>.25){var e=t[0]/t[1];return Number.isInteger(e)?""+e:e.toFixed(1)}return 0!==t[0]?"1/".concat(Math.round(t[1]/t[0])):"0/".concat(t[1])}(t.split("/").map(function(t){return parseInt(t,10)})):t},"exif:MeteringMode":function(t){return function(t){return 1===t?"Average":2===t?"CenterWeightedAverage":3===t?"Spot":4===t?"MultiSpot":5===t?"Pattern":6===t?"Partial":255===t?"Other":"Unknown"}(parseInt(t,10))},"exif:Saturation":function(t){return function(t){return 0===t?"Normal":1===t?"Low saturation":2===t?"High saturation":"Unknown"}(parseInt(t,10))},"exif:SceneCaptureType":function(t){return function(t){return 0===t?"Standard":1===t?"Landscape":2===t?"Portrait":3===t?"Night scene":"Unknown"}(parseInt(t,10))},"exif:Sharpness":function(t){return function(t){return 0===t?"Normal":1===t?"Soft":2===t?"Hard":"Unknown"}(parseInt(t,10))},"exif:ShutterSpeedValue":function(t){return he(le,t)},"exif:WhiteBalance":function(t){return function(t){return 0===t?"Auto white balance":1===t?"Manual white balance":"Unknown"}(parseInt(t,10))}};function he(t,e){return me(e)?t(e.split("/")):e}function me(t){return/^-?\d+\/-?\d+$/.test(t)}function ye(t){var e,n=function(t){if(Array.isArray(t))return t}(e=t.split(","))||function(t){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,i,o,u=[],a=1,f=0;try{for(i=(e=e.call(t)).next,!2;!(a=(n=i.call(e)).done)&&(u.push(n.value),2!==u.length);a=1);}catch(t){f=1,r=t}finally{try{if(!a&&null!=e.return&&(o=e.return(),Object(o)!==o))return}finally{if(f)throw r}}return u}}(e)||function(t){if(t){if("string"==typeof t)return ve(t,2);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?ve(t,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r=n[0],i=n[1];if(void 0!==r&&void 0!==i){var o=parseFloat(r),u=parseFloat(i),a=i.charAt(i.length-1);if(!Number.isNaN(o)&&!Number.isNaN(u))return""+(o+u/60)+a}return t}var be={xmp:"http://ns.adobe.com/xap/1.0/",tiff:"http://ns.adobe.com/tiff/1.0/",exif:"http://ns.adobe.com/exif/1.0/",dc:"http://purl.org/dc/elements/1.1/",xmpMM:"http://ns.adobe.com/xap/1.0/mm/",stEvt:"http://ns.adobe.com/xap/1.0/sType/ResourceEvent#",stRef:"http://ns.adobe.com/xap/1.0/sType/ResourceRef#",photoshop:"http://ns.adobe.com/photoshop/1.0/"};function xe(t){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(t)}function Ae(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Se(t){var e="function"==typeof Map?new Map:void 0;return Se=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(we())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var i=new(t.bind.apply(t,r));return n&&Ue(i,n.prototype),i}(t,arguments,Ie(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:0,writable:1,configurable:1}}),Ue(n,t)},Se(t)}function we(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(we=function(){return!!t})()}function Ue(t,e){return Ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ue(t,e)}function Ie(t){return Ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ie(t)}var Oe={read:function(t,e,n){var r={};if("string"==typeof t)return Pe(r,t,n),r;var i,o=(i=function(t,e){if(0===e.length)return[];var n=[Ce(t,e.slice(0,1))];return e.length>1&&n.push(Ce(t,e.slice(1))),n}(t,e),function(t){if(Array.isArray(t))return t}(i)||function(t){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,i,o,u=[],a=1,f=0;try{for(i=(e=e.call(t)).next,!2;!(a=(n=i.call(e)).done)&&(u.push(n.value),2!==u.length);a=1);}catch(t){f=1,r=t}finally{try{if(!a&&null!=e.return&&(o=e.return(),Object(o)!==o))return}finally{if(f)throw r}}return u}}(i)||function(t){if(t){if("string"==typeof t)return Ae(t,2);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Ae(t,2):void 0}}(i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=o[0],a=o[1],f=Pe(r,u,n);if(a){var c=Pe(r,a,n);f||c||(delete r._raw,Pe(r,Ce(t,e),n))}return r}},Te=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,n){return e=Ie(e),function(t,e){if(e&&("object"==xe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,we()?Reflect.construct(e,n||[],Ie(t).constructor):e.apply(t,n))}(this,e,[t])).name="ParseError",n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:1,configurable:1}}),Object.defineProperty(t,"prototype",{writable:0}),e&&Ue(t,e)}(e,t),Object.defineProperty(n=e,"prototype",{writable:0}),n;var n}(Se(Error));function Ce(t,e){for(var n=e.reduce(function(t,e){return t+e.length},0),r=new Uint8Array(n),i=0,o=0;o<e.length;o++){var u=e[o],a=t.buffer.slice(u.dataOffset,u.dataOffset+u.length);r.set(new Uint8Array(a),i),i+=u.length}return new DataView(r.buffer)}function Pe(t,e,r){try{var i=function(t,e){var r=function(t){if(t)return t;if("undefined"!=typeof DOMParser)return new DOMParser;try{var e=require("@xmldom/xmldom");return new(0,e.DOMParser)({onError:e.onErrorStopParsing})}catch(t){return}}(e);if(!r)throw console.warn("Warning: DOMParser is not available. It is needed to be able to parse XMP tags."),Error();var i="string"==typeof t?t:n(t,0,t.byteLength);return{doc:Ee(r,i.replace(/^.+(<\?xpacket begin)/,"$1").replace(/(<\?xpacket end=".*"\?>).+$/,"$1")),raw:i}}(e,r),u=i.doc,a=i.raw;return t._raw=(t._raw||"")+a,o(t,Me(Le(ke(u),1))),1}catch(t){return 0}}function Ee(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{var r=t.parseFromString(e,"application/xml"),i=r.getElementsByTagName("parsererror");if(i.length>0)throw new Te(i[0].textContent);return r}catch(r){if("ParseError"===r.name&&function(t){for(var e=["prefix is non-null and namespace is null","prefix not bound to a namespace","prefix inte bundet till en namnrymd",/Namespace prefix .+ is not defined/],n=0;n<e.length;n++)if(RegExp(e[n]).test(t.message))return 1;return 0}(r)&&!n)return Ee(t,function(t){var e=t.match(/<([A-Za-z_][A-Za-z0-9._-]*)([^>]*)>/);if(!e)return t;var n=e[1],r=function(t){for(var e,n=[],r=/xmlns:([\w-]+)=["'][^"']+["']/g;null!==(e=r.exec(t));)-1===n.indexOf(e[1])&&n.push(e[1]);return n}(t),i=function(t){for(var e,n=[],r=/\b([A-Za-z_][A-Za-z0-9._-]*):[A-Za-z_][A-Za-z0-9._-]*\b/g;null!==(e=r.exec(t));){var i=e[1];"xmlns"!==i&&"xml"!==i&&-1===n.indexOf(i)&&n.push(i)}return n}(t).filter(function(t){return-1===r.indexOf(t)});return 0===i.length?t:function(t,e,n){var r=RegExp("<"+e+"([^>]*)>");return t.replace(r,"<"+e+"$1"+n+">")}(t,n,function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n],i=be[r]||"http://fallback.namespace/"+r;e.push(" xmlns:"+r+'="'+i+'"')}return e.join("")}(i))}(e),1);throw r}}function ke(t){for(var e=0;e<t.childNodes.length;e++){if("x:xmpmeta"===t.childNodes[e].tagName)return ke(t.childNodes[e]);if("rdf:RDF"===t.childNodes[e].tagName)return t.childNodes[e]}throw Error()}function Le(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=function(t){for(var e=[],n=0;n<t.childNodes.length;n++)e.push(t.childNodes[n]);return e}(t);return 1===(e=r).length&&"#text"===e[0].nodeName?n?{}:function(t){return t.nodeValue}(r[0]):function(t){var e={};return t.forEach(function(t){if(function(t){return t.nodeName&&"#text"!==t.nodeName}(t)){var n=function(t){return{attributes:Ne(t),value:Le(t)}}(t);void 0!==e[t.nodeName]?(Array.isArray(e[t.nodeName])||(e[t.nodeName]=[e[t.nodeName]]),e[t.nodeName].push(n)):e[t.nodeName]=n}}),e}(r)}function Ne(t){for(var e={},n=0;n<t.attributes.length;n++)e[t.attributes[n].nodeName]=decodeURIComponent(escape(t.attributes[n].value));return e}function Me(t){var e={};if("string"==typeof t)return t;for(var n in t){var r=t[n];Array.isArray(r)||(r=[r]),r.forEach(function(t){o(e,Re(t.attributes)),"object"===xe(t.value)&&o(e,Fe(t.value))})}return e}function Re(t){var e={};for(var n in t)try{Be(n)&&(e[je(n)]={value:t[n],attributes:{},description:De(t[n],n)})}catch(t){}return e}function Be(t){return"rdf:parseType"!==t&&!_e(t)}function _e(t){return"xmlns"===t.split(":")[0]}function je(t){return/^MicrosoftPhoto(_\d+_)?:Rating$/i.test(t)?"RatingPercent":t.split(":")[1]}function De(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(Array.isArray(t)){var n=function(t){return t.map(function(t){return void 0!==t.value?De(t.value):De(t)}).join(", ")}(t);return e&&"function"==typeof ge[e]?ge[e](t,n):n}if("object"===xe(t))return function(t){var e=[];for(var n in t)e.push("".concat(ze(n),": ").concat(De(t[n].value)));return e.join("; ")}(t);try{return e&&"function"==typeof ge[e]?ge[e](t):decodeURIComponent(escape(t))}catch(e){return t}}function ze(t){return"CiAdrCity"===t?"CreatorCity":"CiAdrCtry"===t?"CreatorCountry":"CiAdrExtadr"===t?"CreatorAddress":"CiAdrPcode"===t?"CreatorPostalCode":"CiAdrRegion"===t?"CreatorRegion":"CiEmailWork"===t?"CreatorWorkEmail":"CiTelWork"===t?"CreatorWorkPhone":"CiUrlWork"===t?"CreatorWorkUrl":t}function Fe(t){var e={};for(var n in t)try{_e(n)||(e[je(n)]=Ge(t[n],n))}catch(t){}return e}function Ge(t,e){return function(t){return Array.isArray(t)}(t)?function(t,e){return Ke(t[t.length-1],e)}(t,e):function(t){return"Resource"===t.attributes["rdf:parseType"]&&"string"==typeof t.value&&""===t.value.trim()}(t)?{value:"",attributes:{},description:""}:He(t)?Ve(t,e):Xe(t)?Ye(t,e):$e(t)?qe(t,e):function(t){return void 0!==Ze(t.value)}(t)?function(t,e){var n=Ze(t.value).value["rdf:li"],r=We(t),i=[];return void 0===n?n=[]:Array.isArray(n)||(n=[n]),n.forEach(function(t){i.push(function(t){return He(t)?Ve(t):Xe(t)?Ye(t).value:$e(t)?qe(t).value:Ke(t)}(t))}),{value:i,attributes:r,description:De(i,e)}}(t,e):Ke(t,e)}function He(t){return"Resource"===t.attributes["rdf:parseType"]&&void 0!==t.value["rdf:value"]||void 0!==t.value["rdf:Description"]&&void 0!==t.value["rdf:Description"].value["rdf:value"]}function Ve(t,e){var n=We(t);void 0!==t.value["rdf:Description"]&&(t=t.value["rdf:Description"]),o(n,We(t),function(t){var e={};for(var n in t.value)"rdf:value"===n||_e(n)||(e[je(n)]=t.value[n].value);return e}(t));var r=function(t){return Je(t.value["rdf:value"])||t.value["rdf:value"].value}(t);return{value:r,attributes:n,description:De(r,e)}}function We(t){var e={};for(var n in t.attributes)"rdf:parseType"===n||"rdf:resource"===n||_e(n)||(e[je(n)]=t.attributes[n]);return e}function Xe(t){return"Resource"===t.attributes["rdf:parseType"]||void 0!==t.value["rdf:Description"]&&void 0===t.value["rdf:Description"].value["rdf:value"]}function Ye(t,e){var n={value:{},attributes:{}};return void 0!==t.value["rdf:Description"]&&(o(n.value,Re(t.value["rdf:Description"].attributes)),o(n.attributes,We(t)),t=t.value["rdf:Description"]),o(n.value,Fe(t.value)),n.description=De(n.value,e),n}function $e(t){return 0===Object.keys(t.value).length&&void 0===t.attributes["xml:lang"]&&void 0===t.attributes["rdf:resource"]}function qe(t,e){var n=Re(t.attributes);return{value:n,attributes:{},description:De(n,e)}}function Ze(t){return t["rdf:Bag"]||t["rdf:Seq"]||t["rdf:Alt"]}function Ke(t,e){var n=Je(t)||Me(t.value);return{value:n,attributes:We(t),description:De(n,e)}}function Je(t){return t.attributes&&t.attributes["rdf:resource"]}function Qe(t){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qe(t)}var tn={read:function(t,e,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o={},u=[],a=0;a<e.length;a++){var f=e[a],c=sn(t,f.offset,f.length,f.type,n);if(c instanceof Promise)u.push(c.then(function(t){var e,n,o,u=t.name,a=t.value,f=t.description;try{if(hn(u,a))return{__exif:$t.read(yn(a),cn,r,i).tags};if(mn(u,a))return{__iptc:te.read(yn(a),0,r)};if(u&&!hn(u,a)&&!mn(u,a))return e={},o={value:a,description:f},(n=function(t){var e=function(t){if("object"!=Qe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""}(t);return"symbol"==Qe(e)?e:e+""}(n=u))in e?Object.defineProperty(e,n,{value:o,enumerable:1,configurable:1,writable:1}):e[n]=o,e}catch(t){}return{}}));else{var s=c.name,l=c.value,d=c.description;s&&(o[s]={value:l,description:d})}}return{readTags:o,readTagsPromise:u.length>0?Promise.all(u):void 0}}},en="STATE_KEYWORD",nn="STATE_COMPRESSION",rn="STATE_LANG",on="STATE_TRANSLATED_KEYWORD",un="STATE_TEXT",an=1,fn=1,cn=6;function sn(t,e,n,r,i){for(var o,a=[],f=[],c=[],s=en,l=u,d=0;d<n&&e+d<t.byteLength;d++)if(s!==nn){if(s===un){o=new DataView(t.buffer.slice(e+d,e+n));break}var p=t.getUint8(e+d);0===p?s=dn(r,s):s===en?a.push(p):s===rn?f.push(p):s===on&&c.push(p)}else l=ln({type:r,dataView:t,offset:e+d}),r===J&&(d+=an),s=dn(r,s);if(l!==u&&!i)return{};var v=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"string";if(0===e&&"function"==typeof DecompressionStream){var i=new DecompressionStream("deflate"),o=new Blob([t]).stream().pipeThrough(i);return"dataview"===r?new Response(o).arrayBuffer().then(function(t){return new DataView(t)}):new Response(o).arrayBuffer().then(function(t){return new TextDecoder(n).decode(t)})}return void 0!==e?Promise.reject("Unknown compression method ".concat(e,".")):t}(o,l,function(t){return t===K||t===Q?"latin1":"utf-8"}(r));return v instanceof Promise?v.then(function(t){return pn(t,r,f,a)}).catch(function(){return pn("<text using unknown compression>".split(""),r,f,a)}):pn(v,r,f,a)}function ln(t){var e=t.type,n=t.dataView,r=t.offset;if(e===J){if(n.getUint8(r)===fn)return n.getUint8(r+1)}else if(e===Q)return n.getUint8(r);return u}function dn(t,e){return e===en&&[J,Q].includes(t)?nn:e===nn?t===J?rn:un:e===rn?on:un}function pn(t,e,r,i){var o=function(t){return t instanceof DataView?n(t,0,t.byteLength):t}(t);return{name:vn(e,r,i),value:o,description:e===J?gn(t):o}}function vn(t,e,n){var r=i(n);if(t===K||0===e.length)return r;var o=i(e);return"".concat(r," (").concat(o,")")}function gn(t){return Qt("UTF-8",t)}function hn(t,e){return"raw profile type exif"===t.toLowerCase()&&"exif"===e.substring(1,5)}function mn(t,e){return"raw profile type iptc"===t.toLowerCase()&&"iptc"===e.substring(1,5)}function yn(t){return function(t){for(var e=new DataView(new ArrayBuffer(t.length/2)),n=0;n<t.length;n+=2)e.setUint8(n/2,parseInt(t.substring(n,n+2),16));return e}(t.match(/\n(exif|iptc)\n\s*\d+\n([\s\S]*)$/)[2].replace(/\n/g,""))}var bn={read:function(t,e){for(var r={},i=0;i<e.length;i++){var o=Mt.getLongAt(t,e[i]+Y),u=n(t,e[i]+$,X);u===tt?(r["Pixels Per Unit X"]=xn(t,e[i],o),r["Pixels Per Unit Y"]=An(t,e[i],o),r["Pixel Units"]=Sn(t,e[i],o)):u===et&&(r["Modify Date"]=wn(t,e[i],o))}return r}};function xn(t,e,n){if(Un(t,e,n,0,4)){var r=Mt.getLongAt(t,e+q+0);return{value:r,description:""+r}}}function An(t,e,n){if(Un(t,e,n,4,4)){var r=Mt.getLongAt(t,e+q+4);return{value:r,description:""+r}}}function Sn(t,e,n){if(Un(t,e,n,8,1)){var r=Mt.getByteAt(t,e+q+8);return{value:r,description:1===r?"meters":"Unknown"}}}function wn(t,e,n){if(Un(t,e,n,0,7)){var r=Mt.getShortAt(t,e+q),i=Mt.getByteAt(t,e+q+2),o=Mt.getByteAt(t,e+q+3),u=Mt.getByteAt(t,e+q+4),a=Mt.getByteAt(t,e+q+5),f=Mt.getByteAt(t,e+q+6);return{value:[r,i,o,u,a,f],description:"".concat(In(r,4),"-").concat(In(i,2),"-").concat(In(o,2)," ").concat(In(u,2),":").concat(In(a,2),":").concat(In(f,2))}}}function Un(t,e,n,r,i){return r+i<=n&&e+q+r+i<=t.byteLength}function In(t,e){return"".concat("0".repeat(e-(""+t).length)).concat(t)}var On={read:function(t,e){var n={},r=Mt.getByteAt(t,e);return n.Alpha=function(t){var e=16&t;return{value:e?1:0,description:e?"Yes":"No"}}(r),n.Animation=function(t){var e=2&t;return{value:e?1:0,description:e?"Yes":"No"}}(r),n.ImageWidth=Pn(t,e+Tn),n.ImageHeight=Pn(t,e+Cn),n}},Tn=4,Cn=7;function Pn(t,e){var n=Mt.getByteAt(t,e)+256*Mt.getByteAt(t,e+1)+65536*Mt.getByteAt(t,e+2)+1;return{value:n,description:n+"px"}}var En={get:function(t,e){var n,r={},i=0,o=kn(t,"exif","FocalLength",e),u=kn(t,"exif","FocalPlaneXResolution",e),a=kn(t,"exif","FocalPlaneYResolution",e),f=kn(t,"exif","FocalPlaneResolutionUnit",e),c=kn(t,"file","Image Width",e),s=kn(t,"file","Image Height",e),l=kn(t,"exif","FocalLengthIn35mmFilm",e)||function(t,e,n,r,i,o){if(t&&e&&n&&r&&i&&o)try{var u;switch(n){case 2:u=25.4;break;case 3:u=10;break;case 4:u=1;break;default:return}var a=t[0]/t[1]*u,f=i/(e[0]/e[1]*u),c=Math.sqrt(Math.pow(r/a,2)+Math.pow(f,2));return o[0]/o[1]*(43.27/c)}catch(t){}}(u,a,f,c,s,o);l&&(r.FocalLength35efl={value:l,description:(n=l,0===n?"Unknown":n+" mm")},i=1);var d=function(t,e){if(t&&e)try{var n=e/(t[0]/t[1]);return{value:n,description:n.toFixed(1)}}catch(t){}}(o,l);d&&(r.ScaleFactorTo35mmEquivalent=d,i=1);var p=function(t){if(t)try{var e=2*Math.atan(36/(2*t))*(180/Math.PI);return{value:e,description:e.toFixed(1)+" deg"}}catch(t){}}(l);if(p&&(r.FieldOfView=p,i=1),i)return r}};function kn(t,e,n,r){return r&&t[e]&&t[e][n]?t[e][n].value:!r&&t[n]?t[n].value:void 0}function Ln(t){this.name="MetadataMissingError",this.message=t||"No Exif data",this.stack=Error().stack}Ln.prototype=Error();var Nn={MetadataMissingError:Ln},Mn={load:Bn,loadView:jn,errors:Nn},Rn=Nn;function Bn(t){var e,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t){return"string"==typeof t}(t)?(i.async=1,function(t,e){return/^\w+:\/\//.test(t)?"undefined"!=typeof fetch?function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).length,n={method:"GET"};return Number.isInteger(e)&&e>=0&&(n.headers={range:"bytes=0-".concat(e-1)}),fetch(t,n).then(function(t){return t.arrayBuffer()})}(t,e):function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).length;return new Promise(function(n,r){var i={};Number.isInteger(e)&&e>=0&&(i.headers={range:"bytes=0-".concat(e-1)});var o=function(t){return/^https:\/\//.test(t)?require("https").get:require("http").get}(t);o(t,i,function(t){if(t.statusCode>=200&&t.statusCode<=299){var e=[];t.on("data",function(t){return e.push(Buffer.from(t))}),t.on("error",function(t){return r(t)}),t.on("end",function(){return n(Buffer.concat(e))})}else r("Could not fetch file: ".concat(t.statusCode," ").concat(t.statusMessage)),t.resume()}).on("error",function(t){return r(t)})})}(t,e):function(t){return/^data:[^;,]*(;base64)?,/.test(t)}(t)?Promise.resolve(function(t){var e=t.substring(t.indexOf(",")+1);if(-1!==t.indexOf(";base64")){if("undefined"!=typeof atob)return Uint8Array.from(atob(e),function(t){return t.charCodeAt(0)}).buffer;if("undefined"==typeof Buffer)return;return"undefined"!=typeof Buffer.from?Buffer.from(e,"base64"):new Buffer(e,"base64")}var n=decodeURIComponent(e);return"undefined"!=typeof Buffer?"undefined"!=typeof Buffer.from?Buffer.from(n):new Buffer(n):Uint8Array.from(n,function(t){return t.charCodeAt(0)}).buffer}(t)):function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).length;return new Promise(function(n,r){var i=function(){try{return require("fs")}catch(t){return}}();i.open(t,function(o,u){o?r(o):i.stat(t,function(o,a){if(o)r(o);else{var f=Math.min(a.size,void 0!==e?e:a.size),c=Buffer.alloc(f),s={buffer:c,length:f};i.read(u,s,function(e){e?r(e):i.close(u,function(e){e&&console.warn("Could not close file ".concat(t,":"),e),n(c)})})}})})})}(t,e)}(t,i).then(function(t){return _n(t,i)})):function(t){return"undefined"!=typeof File&&t instanceof File}(t)?(i.async=1,(e=t,n=i,r=n.length,new Promise(function(t,n){var i=new FileReader;i.onload=function(e){return t(e.target.result)},i.onerror=function(){return n(i.error)},Number.isInteger(r)&&r>=0&&void 0!==e.slice?i.readAsArrayBuffer(e.slice(0,r)):i.readAsArrayBuffer(e)})).then(function(t){return _n(t,i)})):_n(t,i)}function _n(t,e){return function(t){try{return Buffer.isBuffer(t)}catch(t){return 0}}(t)&&(t=new Uint8Array(t).buffer),jn(function(t){try{return new DataView(t)}catch(e){return new c(t)}}(t),e)}function jn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{expanded:0,async:0,computed:0,includeUnknown:0,domParser:void 0},n=e.expanded,r=void 0===n?0:n,i=e.async,u=void 0===i?0:i,a=e.computed,f=void 0===a?0:a,c=e.includeUnknown,l=void 0===c?0:c,d=e.domParser,p=void 0===d?void 0:d,v=0,g={},h=[],m=xt.parseAppMarkers(t,u),y=m.fileType,b=(m.fileDataOffset,m.jfifDataOffset,m.tiffHeaderOffset),x=m.iptcDataOffset,A=m.xmpChunks,S=(m.iccChunks,m.mpfDataOffset,m.pngHeaderOffset,m.pngTextChunks),w=m.pngChunkOffsets,U=m.vp8xChunkOffset;if(m.gifHeaderOffset,function(t){return void 0!==t}(b)){v=1;var I=$t.read(t,b,l,f),O=I.tags;I.byteOrder,O.Thumbnail&&(g.Thumbnail=O.Thumbnail,delete O.Thumbnail),r?(g.exif=O,function(t){if(t.exif){if(t.exif.GPSLatitude&&t.exif.GPSLatitudeRef)try{t.gps=t.gps||{},t.gps.Latitude=s(t.exif.GPSLatitude.value),"S"===t.exif.GPSLatitudeRef.value.join("")&&(t.gps.Latitude=-t.gps.Latitude)}catch(t){}if(t.exif.GPSLongitude&&t.exif.GPSLongitudeRef)try{t.gps=t.gps||{},t.gps.Longitude=s(t.exif.GPSLongitude.value),"W"===t.exif.GPSLongitudeRef.value.join("")&&(t.gps.Longitude=-t.gps.Longitude)}catch(t){}if(t.exif.GPSAltitude&&t.exif.GPSAltitudeRef)try{t.gps=t.gps||{},t.gps.Altitude=t.exif.GPSAltitude.value[0]/t.exif.GPSAltitude.value[1],1===t.exif.GPSAltitudeRef.value&&(t.gps.Altitude=-t.gps.Altitude)}catch(t){}}}(g)):g=o({},g,O),O.MakerNote&&delete O.MakerNote.__offset}if(function(t){return void 0!==t}(x)){v=1;var T=te.read(t,x,l);r?g.iptc=T:g=o({},g,T)}if(function(t){return Array.isArray(t)&&t.length>0}(A)){v=1;var C=Oe.read(t,A,p);r?g.xmp=C:(delete C._raw,g=o({},g,C))}if(function(t){return void 0!==t}(S)){v=1;var P=tn.read(t,S,u,l,f),E=P.readTags,k=P.readTagsPromise;R(E),k&&h.push(k.then(function(t){return t.forEach(R)}))}if(function(t){return void 0!==t}(w)){v=1;var L=bn.read(t,w);r?g.png=g.png?o({},g.png,L):L:g=o({},g,L)}if(function(t){return void 0!==t}(U)){v=1;var N=On.read(t,U);r?g.riff=g.riff?o({},g.riff,N):N:g=o({},g,N)}var M=En.get(g,r);if(M&&(r?g.composite=M:g=o({},g,M)),delete g.Thumbnail,y&&(r?(g.file||(g.file={}),g.file.FileType=y):g.FileType=y,v=1),!v)throw new Nn.MetadataMissingError;return u?Promise.all(h).then(function(){return g}):g;function R(t){if(r){for(var e=0,n=["exif","iptc"];e<n.length;e++){var i=n[e],u="__".concat(i);t[u]&&(g[i]=g[i]?o({},g.exif,t[u]):t[u],delete t[u])}g.png=g.png?o({},g.png,t):t,g.pngText=g.pngText?o({},g.png,t):t}else delete(g=o({},g,t.__exif?t.__exif:{},t.__iptc?t.__iptc:{},t)).__exif,delete g.__iptc}}return e}()});
//# sourceMappingURL=exif-reader.js.map