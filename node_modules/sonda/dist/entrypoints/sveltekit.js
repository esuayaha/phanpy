import { Config, SondaVitePlugin } from "sonda";

//#region src/entrypoints/sveltekit.ts
function SondaSvelteKitPlugin(userOptions = {}) {
	const options = new Config(userOptions, {
		integration: "sveltekit",
		filename: "sonda_[env]_[index]"
	});
	if (!options.enabled) return { name: "sonda/sveltekit" };
	return {
		...SondaVitePlugin(options),
		name: "sonda/sveltekit",
		configResolved(config) {
			const env = config.build.ssr ? "server" : "client";
			const generateForServer = userOptions.server ?? false;
			if (env === "server" && !generateForServer) userOptions.enabled = false;
			options.filename = options.filename.replace("[env]", env);
		}
	};
}

//#endregion
export { SondaSvelteKitPlugin as default };