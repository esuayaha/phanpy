import{e as r,c as fr,s as Ie,p as Yr,u as bt,A as ce,a as vi,Y as Xr,y as Ae,F as Zr,W as hr,T as ne,J as Qr,d as ie,M as pr,k as It,m as Kt,l as it,q as Mn,z as Dn,G as cn,aW as Jr,N as ea,aX as mr,I as ta,a0 as na,V as ia,t as ra,aO as aa,H as oa,aY as sa,b as ua}from"./pwa-viewport-B748TGs7.js";import{a7 as ca,O as la,a3 as da,D as fa,y as Lt,ah as ui,ai as Vi,aj as gr,Y as ha,_ as jn,I as ee,t as Ht,r as Pn,s as gt,h as Rn,i as vr,d as ct,l as mi,v as pa,f as dn,w as br,G as Un,ak as ma,al as ga,am as va,a1 as ba,p as $t,an as ya,ao as xa,F as Gi,u as wa,a as ka,a9 as Ea,a8 as Aa,c as Yi,ap as ci,aq as Sa}from"./ScheduledAtField-D2XxRl4Z.js";import{_ as Ca}from"./__vite-browser-external-D7Ct-6yo.js";import"./ICONS-B5bH-5PR.js";const bi=[["aa","Afar","Afaraf"],["ab","Abkhaz","аҧсуа бызшәа"],["ae","Avestan","avesta"],["af","Afrikaans","Afrikaans"],["ak","Akan","Akan"],["am","Amharic","አማርኛ"],["an","Aragonese","aragonés"],["ar","Arabic","اللغة العربية"],["as","Assamese","অসমীয়া"],["av","Avaric","авар мацӀ"],["ay","Aymara","aymar aru"],["az","Azerbaijani","azərbaycan dili"],["ba","Bashkir","башҡорт теле"],["be","Belarusian","беларуская мова"],["bg","Bulgarian","български език"],["bh","Bihari","भोजपुरी"],["bi","Bislama","Bislama"],["bm","Bambara","bamanankan"],["bn","Bengali","বাংলা"],["bo","Tibetan","བོད་ཡིག"],["br","Breton","brezhoneg"],["bs","Bosnian","bosanski jezik"],["ca","Catalan","Català"],["ce","Chechen","нохчийн мотт"],["ch","Chamorro","Chamoru"],["co","Corsican","corsu"],["cr","Cree","ᓀᐦᐃᔭᐍᐏᐣ"],["cs","Czech","čeština"],["cu","Old Church Slavonic","ѩзыкъ словѣньскъ"],["cv","Chuvash","чӑваш чӗлхи"],["cy","Welsh","Cymraeg"],["da","Danish","dansk"],["de","German","Deutsch"],["dv","Divehi","Dhivehi"],["dz","Dzongkha","རྫོང་ཁ"],["ee","Ewe","Eʋegbe"],["el","Greek","Ελληνικά"],["en","English","English"],["eo","Esperanto","Esperanto"],["es","Spanish","Español"],["et","Estonian","eesti"],["eu","Basque","euskara"],["fa","Persian","فارسی"],["ff","Fula","Fulfulde"],["fi","Finnish","suomi"],["fj","Fijian","Vakaviti"],["fo","Faroese","føroyskt"],["fr","French","Français"],["fy","Western Frisian","Frysk"],["ga","Irish","Gaeilge"],["gd","Scottish Gaelic","Gàidhlig"],["gl","Galician","galego"],["gu","Gujarati","ગુજરાતી"],["gv","Manx","Gaelg"],["ha","Hausa","هَوُسَ"],["he","Hebrew","עברית"],["hi","Hindi","हिन्दी"],["ho","Hiri Motu","Hiri Motu"],["hr","Croatian","Hrvatski"],["ht","Haitian","Kreyòl ayisyen"],["hu","Hungarian","magyar"],["hy","Armenian","Հայերեն"],["hz","Herero","Otjiherero"],["ia","Interlingua","Interlingua"],["id","Indonesian","Bahasa Indonesia"],["ie","Interlingue","Interlingue"],["ig","Igbo","Asụsụ Igbo"],["ii","Nuosu","ꆈꌠ꒿ Nuosuhxop"],["ik","Inupiaq","Iñupiaq"],["io","Ido","Ido"],["is","Icelandic","Íslenska"],["it","Italian","Italiano"],["iu","Inuktitut","ᐃᓄᒃᑎᑐᑦ"],["ja","Japanese","日本語"],["jv","Javanese","basa Jawa"],["ka","Georgian","ქართული"],["kg","Kongo","Kikongo"],["ki","Kikuyu","Gĩkũyũ"],["kj","Kwanyama","Kuanyama"],["kk","Kazakh","қазақ тілі"],["kl","Kalaallisut","kalaallisut"],["km","Khmer","ខេមរភាសា"],["kn","Kannada","ಕನ್ನಡ"],["ko","Korean","한국어"],["kr","Kanuri","Kanuri"],["ks","Kashmiri","कश्मीरी"],["ku","Kurmanji (Kurdish)","Kurmancî"],["kv","Komi","коми кыв"],["kw","Cornish","Kernewek"],["ky","Kyrgyz","Кыргызча"],["la","Latin","latine"],["lb","Luxembourgish","Lëtzebuergesch"],["lg","Ganda","Luganda"],["li","Limburgish","Limburgs"],["ln","Lingala","Lingála"],["lo","Lao","ລາວ"],["lt","Lithuanian","lietuvių kalba"],["lu","Luba-Katanga","Tshiluba"],["lv","Latvian","latviešu valoda"],["mg","Malagasy","fiteny malagasy"],["mh","Marshallese","Kajin M̧ajeļ"],["mi","Māori","te reo Māori"],["mk","Macedonian","македонски јазик"],["ml","Malayalam","മലയാളം"],["mn","Mongolian","Монгол хэл"],["mr","Marathi","मराठी"],["ms","Malay","Bahasa Melayu"],["ms-Arab","Jawi Malay","بهاس ملايو"],["mt","Maltese","Malti"],["my","Burmese","ဗမာစာ"],["na","Nauru","Ekakairũ Naoero"],["nb","Norwegian Bokmål","Norsk bokmål"],["nd","Northern Ndebele","isiNdebele"],["ne","Nepali","नेपाली"],["ng","Ndonga","Owambo"],["nl","Dutch","Nederlands"],["nn","Norwegian Nynorsk","Norsk Nynorsk"],["no","Norwegian","Norsk"],["nr","Southern Ndebele","isiNdebele"],["nv","Navajo","Diné bizaad"],["ny","Chichewa","chiCheŵa"],["oc","Occitan","occitan"],["oj","Ojibwe","ᐊᓂᔑᓈᐯᒧᐎᓐ"],["om","Oromo","Afaan Oromoo"],["or","Oriya","ଓଡ଼ିଆ"],["os","Ossetian","ирон æвзаг"],["pa","Punjabi","ਪੰਜਾਬੀ"],["pi","Pāli","पाऴि"],["pl","Polish","Polski"],["ps","Pashto","پښتو"],["pt","Portuguese","Português"],["qu","Quechua","Runa Simi"],["rm","Romansh","rumantsch grischun"],["rn","Kirundi","Ikirundi"],["ro","Romanian","Română"],["ru","Russian","Русский"],["rw","Kinyarwanda","Ikinyarwanda"],["sa","Sanskrit","संस्कृतम्"],["sc","Sardinian","sardu"],["sd","Sindhi","सिन्धी"],["se","Northern Sami","Davvisámegiella"],["sg","Sango","yângâ tî sängö"],["si","Sinhala","සිංහල"],["sk","Slovak","slovenčina"],["sl","Slovenian","slovenščina"],["sn","Shona","chiShona"],["so","Somali","Soomaaliga"],["sq","Albanian","Shqip"],["sr","Serbian","српски језик"],["ss","Swati","SiSwati"],["st","Southern Sotho","Sesotho"],["su","Sundanese","Basa Sunda"],["sv","Swedish","Svenska"],["sw","Swahili","Kiswahili"],["ta","Tamil","தமிழ்"],["te","Telugu","తెలుగు"],["tg","Tajik","тоҷикӣ"],["th","Thai","ไทย"],["ti","Tigrinya","ትግርኛ"],["tk","Turkmen","Türkmen"],["tl","Tagalog","Tagalog"],["tn","Tswana","Setswana"],["to","Tonga","faka Tonga"],["tr","Turkish","Türkçe"],["ts","Tsonga","Xitsonga"],["tt","Tatar","татар теле"],["tw","Twi","Twi"],["ty","Tahitian","Reo Tahiti"],["ug","Uyghur","ئۇيغۇرچە‎"],["uk","Ukrainian","Українська"],["ur","Urdu","اردو"],["uz","Uzbek","Ўзбек"],["ve","Venda","Tshivenḓa"],["vi","Vietnamese","Tiếng Việt"],["vo","Volapük","Volapük"],["wa","Walloon","walon"],["wo","Wolof","Wollof"],["xh","Xhosa","isiXhosa"],["yi","Yiddish","ייִדיש"],["yo","Yoruba","Yorùbá"],["za","Zhuang","Saɯ cueŋƅ"],["zh","Chinese","中文"],["zu","Zulu","isiZulu"],["zh-CN","Chinese (China)","简体中文"],["zh-HK","Chinese (Hong Kong)","繁體中文（香港）"],["zh-TW","Chinese (Taiwan)","繁體中文（臺灣）"],["zh-YUE","Cantonese","廣東話"],["ast","Asturian","Asturianu"],["chr","Cherokee","ᏣᎳᎩ ᎦᏬᏂᎯᏍᏗ"],["ckb","Sorani (Kurdish)","سۆرانی"],["cnr","Montenegrin","crnogorski"],["csb","Kashubian","Kaszëbsczi"],["gsw","Swiss German","Schwiizertütsch"],["jbo","Lojban","la .lojban."],["kab","Kabyle","Taqbaylit"],["ldn","Láadan","Láadan"],["lfn","Lingua Franca Nova","lingua franca nova"],["moh","Mohawk","Kanienʼkéha"],["nds","Low German","Plattdüütsch"],["pdc","Pennsylvania Dutch","Pennsilfaani-Deitsch"],["sco","Scots","Scots"],["sma","Southern Sami","Åarjelsaemien Gïele"],["smj","Lule Sami","Julevsámegiella"],["szl","Silesian","ślůnsko godka"],["tok","Toki Pona","toki pona"],["vai","Vai","ꕙꔤ"],["xal","Kalmyk","Хальмг келн"],["zba","Balaibalan","باليبلن"],["zgh","Standard Moroccan Tamazight","ⵜⴰⵎⴰⵣⵉⵖⵜ"]],Fa=new Intl.Segmenter;function Xi(h){if(h==="")return 0;let o=0;for(const f of Fa.segment(h))o++;return o}const La="(((?:[^A-Za-z0-9@＠$#＃\\uFFFE\\uFEFF\\uFFFF]|[\\u202A-\\u202E\\u061C\\u200E\\u200F\\u2066\\u2067\\u2068\\u2069]|^))((https?:\\/\\/)((?:(?:(?:[^/\\!'#%&'\\(\\)*\\+,\\\\\\-\\.\\/:;<=>\\?@\\[\\]\\^_{|}~\\$//\\x09-\\x0D\\x20\\x85\\xA0\\u1680\\u180E\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000//\\uFFFE\\uFEFF\\uFFFF//\\u202A-\\u202E\\u061C\\u200E\\u200F\\u2066\\u2067\\u2068\\u2069/](?:[_-]|[^/\\!'#%&'\\(\\)*\\+,\\\\\\-\\.\\/:;<=>\\?@\\[\\]\\^_{|}~\\$//\\x09-\\x0D\\x20\\x85\\xA0\\u1680\\u180E\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000//\\uFFFE\\uFEFF\\uFFFF//\\u202A-\\u202E\\u061C\\u200E\\u200F\\u2066\\u2067\\u2068\\u2069/])*)?[^/\\!'#%&'\\(\\)*\\+,\\\\\\-\\.\\/:;<=>\\?@\\[\\]\\^_{|}~\\$//\\x09-\\x0D\\x20\\x85\\xA0\\u1680\\u180E\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000//\\uFFFE\\uFEFF\\uFFFF//\\u202A-\\u202E\\u061C\\u200E\\u200F\\u2066\\u2067\\u2068\\u2069/]\\.)*(?:(?:[^/\\!'#%&'\\(\\)*\\+,\\\\\\-\\.\\/:;<=>\\?@\\[\\]\\^_{|}~\\$//\\x09-\\x0D\\x20\\x85\\xA0\\u1680\\u180E\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000//\\uFFFE\\uFEFF\\uFFFF//\\u202A-\\u202E\\u061C\\u200E\\u200F\\u2066\\u2067\\u2068\\u2069/](?:-|[^/\\!'#%&'\\(\\)*\\+,\\\\\\-\\.\\/:;<=>\\?@\\[\\]\\^_{|}~\\$//\\x09-\\x0D\\x20\\x85\\xA0\\u1680\\u180E\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000//\\uFFFE\\uFEFF\\uFFFF//\\u202A-\\u202E\\u061C\\u200E\\u200F\\u2066\\u2067\\u2068\\u2069/])*)?[^/\\!'#%&'\\(\\)*\\+,\\\\\\-\\.\\/:;<=>\\?@\\[\\]\\^_{|}~\\$//\\x09-\\x0D\\x20\\x85\\xA0\\u1680\\u180E\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000//\\uFFFE\\uFEFF\\uFFFF//\\u202A-\\u202E\\u061C\\u200E\\u200F\\u2066\\u2067\\u2068\\u2069/]\\.)(?:(?:(?:삼성|닷컴|닷넷|香格里拉|餐厅|食品|飞利浦|電訊盈科|集团|通販|购物|谷歌|诺基亚|联通|网络|网站|网店|网址|组织机构|移动|珠宝|点看|游戏|淡马锡|机构|書籍|时尚|新闻|政府|政务|招聘|手表|手机|我爱你|慈善|微博|广东|工行|家電|娱乐|天主教|大拿|大众汽车|在线|嘉里大酒店|嘉里|商标|商店|商城|公益|公司|八卦|健康|信息|佛山|企业|中文网|中信|世界|ポイント|ファッション|セール|ストア|コム|グーグル|クラウド|みんな|คอม|संगठन|नेट|कॉम|همراه|موقع|موبايلي|كوم|كاثوليك|عرب|شبكة|بيتك|بازار|العليان|ارامكو|اتصالات|ابوظبي|קום|сайт|рус|орг|онлайн|москва|ком|католик|дети|zuerich|zone|zippo|zip|zero|zara|zappos|yun|youtube|you|yokohama|yoga|yodobashi|yandex|yamaxun|yahoo|yachts|xyz|xxx|xperia|xin|xihuan|xfinity|xerox|xbox|wtf|wtc|wow|world|works|work|woodside|wolterskluwer|wme|winners|wine|windows|win|williamhill|wiki|wien|whoswho|weir|weibo|wedding|wed|website|weber|webcam|weatherchannel|weather|watches|watch|warman|wanggou|wang|walter|walmart|wales|vuelos|voyage|voto|voting|vote|volvo|volkswagen|vodka|vlaanderen|vivo|viva|vistaprint|vista|vision|visa|virgin|vip|vin|villas|viking|vig|video|viajes|vet|versicherung|vermögensberatung|vermögensberater|verisign|ventures|vegas|vanguard|vana|vacations|ups|uol|uno|university|unicom|uconnect|ubs|ubank|tvs|tushu|tunes|tui|tube|trv|trust|travelersinsurance|travelers|travelchannel|travel|training|trading|trade|toys|toyota|town|tours|total|toshiba|toray|top|tools|tokyo|today|tmall|tkmaxx|tjx|tjmaxx|tirol|tires|tips|tiffany|tienda|tickets|tiaa|theatre|theater|thd|teva|tennis|temasek|telefonica|telecity|tel|technology|tech|team|tdk|tci|taxi|tax|tattoo|tatar|tatamotors|target|taobao|talk|taipei|tab|systems|symantec|sydney|swiss|swiftcover|swatch|suzuki|surgery|surf|support|supply|supplies|sucks|style|study|studio|stream|store|storage|stockholm|stcgroup|stc|statoil|statefarm|statebank|starhub|star|staples|stada|srt|srl|spreadbetting|spot|sport|spiegel|space|soy|sony|song|solutions|solar|sohu|software|softbank|social|soccer|sncf|smile|smart|sling|skype|sky|skin|ski|site|singles|sina|silk|shriram|showtime|show|shouji|shopping|shop|shoes|shiksha|shia|shell|shaw|sharp|shangrila|sfr|sexy|sex|sew|seven|ses|services|sener|select|seek|security|secure|seat|search|scot|scor|scjohnson|science|schwarz|schule|school|scholarships|schmidt|schaeffler|scb|sca|sbs|sbi|saxo|save|sas|sarl|sapo|sap|sanofi|sandvikcoromant|sandvik|samsung|samsclub|salon|sale|sakura|safety|safe|saarland|ryukyu|rwe|run|ruhr|rugby|rsvp|room|rogers|rodeo|rocks|rocher|rmit|rip|rio|ril|rightathome|ricoh|richardli|rich|rexroth|reviews|review|restaurant|rest|republican|report|repair|rentals|rent|ren|reliance|reit|reisen|reise|rehab|redumbrella|redstone|red|recipes|realty|realtor|realestate|read|raid|radio|racing|qvc|quest|quebec|qpon|pwc|pub|prudential|pru|protection|property|properties|promo|progressive|prof|productions|prod|pro|prime|press|praxi|pramerica|post|porn|politie|poker|pohl|pnc|plus|plumbing|playstation|play|place|pizza|pioneer|pink|ping|pin|pid|pictures|pictet|pics|piaget|physio|photos|photography|photo|phone|philips|phd|pharmacy|pfizer|pet|pccw|pay|passagens|party|parts|partners|pars|paris|panerai|panasonic|pamperedchef|page|ovh|ott|otsuka|osaka|origins|orientexpress|organic|org|orange|oracle|open|ooo|onyourside|online|onl|ong|one|omega|ollo|oldnavy|olayangroup|olayan|okinawa|office|off|observer|obi|nyc|ntt|nrw|nra|nowtv|nowruz|now|norton|northwesternmutual|nokia|nissay|nissan|ninja|nikon|nike|nico|nhk|ngo|nfl|nexus|nextdirect|next|news|newholland|new|neustar|network|netflix|netbank|net|nec|nba|navy|natura|nationwide|name|nagoya|nadex|nab|mutuelle|mutual|museum|mtr|mtpc|mtn|msd|movistar|movie|mov|motorcycles|moto|moscow|mortgage|mormon|mopar|montblanc|monster|money|monash|mom|moi|moe|moda|mobily|mobile|mobi|mma|mls|mlb|mitsubishi|mit|mint|mini|mil|microsoft|miami|metlife|merckmsd|meo|menu|men|memorial|meme|melbourne|meet|media|med|mckinsey|mcdonalds|mcd|mba|mattel|maserati|marshalls|marriott|markets|marketing|market|map|mango|management|man|makeup|maison|maif|madrid|macys|luxury|luxe|lupin|lundbeck|ltda|ltd|lplfinancial|lpl|love|lotto|lotte|london|lol|loft|locus|locker|loans|loan|llp|llc|lixil|living|live|lipsy|link|linde|lincoln|limo|limited|lilly|like|lighting|lifestyle|lifeinsurance|life|lidl|liaison|lgbt|lexus|lego|legal|lefrak|leclerc|lease|lds|lawyer|law|latrobe|latino|lat|lasalle|lanxess|landrover|land|lancome|lancia|lancaster|lamer|lamborghini|ladbrokes|lacaixa|kyoto|kuokgroup|kred|krd|kpn|kpmg|kosher|komatsu|koeln|kiwi|kitchen|kindle|kinder|kim|kia|kfh|kerryproperties|kerrylogistics|kerryhotels|kddi|kaufen|juniper|juegos|jprs|jpmorgan|joy|jot|joburg|jobs|jnj|jmp|jll|jlc|jio|jewelry|jetzt|jeep|jcp|jcb|java|jaguar|iwc|iveco|itv|itau|istanbul|ist|ismaili|iselect|irish|ipiranga|investments|intuit|international|intel|int|insure|insurance|institute|ink|ing|info|infiniti|industries|inc|immobilien|immo|imdb|imamat|ikano|iinet|ifm|ieee|icu|ice|icbc|ibm|hyundai|hyatt|hughes|htc|hsbc|how|house|hotmail|hotels|hoteles|hot|hosting|host|hospital|horse|honeywell|honda|homesense|homes|homegoods|homedepot|holiday|holdings|hockey|hkt|hiv|hitachi|hisamitsu|hiphop|hgtv|hermes|here|helsinki|help|healthcare|health|hdfcbank|hdfc|hbo|haus|hangout|hamburg|hair|guru|guitars|guide|guge|gucci|guardian|group|grocery|gripe|green|gratis|graphics|grainger|gov|got|gop|google|goog|goodyear|goodhands|goo|golf|goldpoint|gold|godaddy|gmx|gmo|gmbh|gmail|globo|global|gle|glass|glade|giving|gives|gifts|gift|ggee|george|genting|gent|gea|gdn|gbiz|gay|garden|gap|games|game|gallup|gallo|gallery|gal|fyi|futbol|furniture|fund|fun|fujixerox|fujitsu|ftr|frontier|frontdoor|frogans|frl|fresenius|free|fox|foundation|forum|forsale|forex|ford|football|foodnetwork|food|foo|fly|flsmidth|flowers|florist|flir|flights|flickr|fitness|fit|fishing|fish|firmdale|firestone|fire|financial|finance|final|film|fido|fidelity|fiat|ferrero|ferrari|feedback|fedex|fast|fashion|farmers|farm|fans|fan|family|faith|fairwinds|fail|fage|extraspace|express|exposed|expert|exchange|everbank|events|eus|eurovision|etisalat|esurance|estate|esq|erni|ericsson|equipment|epson|epost|enterprises|engineering|engineer|energy|emerck|email|education|edu|edeka|eco|eat|earth|dvr|dvag|durban|dupont|duns|dunlop|duck|dubai|dtv|drive|download|dot|doosan|domains|doha|dog|dodge|doctor|docs|dnp|diy|dish|discover|discount|directory|direct|digital|diet|diamonds|dhl|dev|design|desi|dentist|dental|democrat|delta|deloitte|dell|delivery|degree|deals|dealer|deal|dds|dclk|day|datsun|dating|date|data|dance|dad|dabur|cyou|cymru|cuisinella|csc|cruises|cruise|crs|crown|cricket|creditunion|creditcard|credit|cpa|courses|coupons|coupon|country|corsica|coop|cool|cookingchannel|cooking|contractors|contact|consulting|construction|condos|comsec|computer|compare|company|community|commbank|comcast|com|cologne|college|coffee|codes|coach|clubmed|club|cloud|clothing|clinique|clinic|click|cleaning|claims|cityeats|city|citic|citi|citadel|cisco|circle|cipriani|church|chrysler|chrome|christmas|chloe|chintai|cheap|chat|chase|charity|channel|chanel|cfd|cfa|cern|ceo|center|ceb|cbs|cbre|cbn|cba|catholic|catering|cat|casino|cash|caseih|case|casa|cartier|cars|careers|career|care|cards|caravan|car|capitalone|capital|capetown|canon|cancerresearch|camp|camera|cam|calvinklein|call|cal|cafe|cab|bzh|buzz|buy|business|builders|build|bugatti|budapest|brussels|brother|broker|broadway|bridgestone|bradesco|box|boutique|bot|boston|bostik|bosch|boots|booking|book|boo|bond|bom|bofa|boehringer|boats|bnpparibas|bnl|bmw|bms|blue|bloomberg|blog|blockbuster|blanco|blackfriday|black|biz|bio|bingo|bing|bike|bid|bible|bharti|bet|bestbuy|best|berlin|bentley|beer|beauty|beats|bcn|bcg|bbva|bbt|bbc|bayern|bauhaus|basketball|baseball|bargains|barefoot|barclays|barclaycard|barcelona|bar|bank|band|bananarepublic|banamex|baidu|baby|azure|axa|aws|avianca|autos|auto|author|auspost|audio|audible|audi|auction|attorney|athleta|associates|asia|asda|arte|art|arpa|army|archi|aramco|arab|aquarelle|apple|app|apartments|aol|anz|anquan|android|analytics|amsterdam|amica|amfam|amex|americanfamily|americanexpress|alstom|alsace|ally|allstate|allfinanz|alipay|alibaba|alfaromeo|akdn|airtel|airforce|airbus|aigo|aig|agency|agakhan|africa|afl|afamilycompany|aetna|aero|aeg|adult|ads|adac|actor|active|aco|accountants|accountant|accenture|academy|abudhabi|abogado|able|abc|abbvie|abbott|abb|abarth|aarp|aaa|onion)(?=[^0-9a-zA-Z@+-]|$))|(?:(?:한국|香港|澳門|新加坡|台灣|台湾|中國|中国|გე|ລາວ|ไทย|ලංකා|ഭാരതം|ಭಾರತ|భారత్|சிங்கப்பூர்|இலங்கை|இந்தியா|ଭାରତ|ભારત|ਭਾਰਤ|ভাৰত|ভারত|বাংলা|भारोत|भारतम्|भारत|ڀارت|پاکستان|موريتانيا|مليسيا|مصر|قطر|فلسطين|عمان|عراق|سورية|سودان|تونس|بھارت|بارت|ایران|امارات|المغرب|السعودية|الجزائر|البحرين|الاردن|հայ|қаз|укр|срб|рф|мон|мкд|ею|бел|бг|ευ|ελ|zw|zm|za|yt|ye|ws|wf|vu|vn|vi|vg|ve|vc|va|uz|uy|us|um|uk|ug|ua|tz|tw|tv|tt|tr|tp|to|tn|tm|tl|tk|tj|th|tg|tf|td|tc|sz|sy|sx|sv|su|st|ss|sr|so|sn|sm|sl|sk|sj|si|sh|sg|se|sd|sc|sb|sa|rw|ru|rs|ro|re|qa|py|pw|pt|ps|pr|pn|pm|pl|pk|ph|pg|pf|pe|pa|om|nz|nu|nr|np|no|nl|ni|ng|nf|ne|nc|na|mz|my|mx|mw|mv|mu|mt|ms|mr|mq|mp|mo|mn|mm|ml|mk|mh|mg|mf|me|md|mc|ma|ly|lv|lu|lt|ls|lr|lk|li|lc|lb|la|kz|ky|kw|kr|kp|kn|km|ki|kh|kg|ke|jp|jo|jm|je|it|is|ir|iq|io|in|im|il|ie|id|hu|ht|hr|hn|hm|hk|gy|gw|gu|gt|gs|gr|gq|gp|gn|gm|gl|gi|gh|gg|gf|ge|gd|gb|ga|fr|fo|fm|fk|fj|fi|eu|et|es|er|eh|eg|ee|ec|dz|do|dm|dk|dj|de|cz|cy|cx|cw|cv|cu|cr|co|cn|cm|cl|ck|ci|ch|cg|cf|cd|cc|ca|bz|by|bw|bv|bt|bs|br|bq|bo|bn|bm|bl|bj|bi|bh|bg|bf|be|bd|bb|ba|az|ax|aw|au|at|as|ar|aq|ao|an|am|al|ai|ag|af|ae|ad|ac)(?=[^0-9a-zA-Z@+-]|$))|(?:xn--[\\-0-9a-z]+))))(?::([0-9]+))?(\\/(?:(?:[a-z\\u0400-\\u04FF0-9!\\*';:=\\+,\\.\\$\\/%#\\[\\]\\-\\u2013_~@\\|&\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u024F\\u0253\\u0254\\u0256\\u0257\\u0259\\u025B\\u0263\\u0268\\u026F\\u0272\\u0289\\u028B\\u02BB\\u0300-\\u036F\\u1E00-\\u1EFF]*(?:\\((?:[a-z\\u0400-\\u04FF0-9!\\*';:=\\+,\\.\\$\\/%#\\[\\]\\-\\u2013_~@\\|&\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u024F\\u0253\\u0254\\u0256\\u0257\\u0259\\u025B\\u0263\\u0268\\u026F\\u0272\\u0289\\u028B\\u02BB\\u0300-\\u036F\\u1E00-\\u1EFF]+|(?:[a-z\\u0400-\\u04FF0-9!\\*';:=\\+,\\.\\$\\/%#\\[\\]\\-\\u2013_~@\\|&\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u024F\\u0253\\u0254\\u0256\\u0257\\u0259\\u025B\\u0263\\u0268\\u026F\\u0272\\u0289\\u028B\\u02BB\\u0300-\\u036F\\u1E00-\\u1EFF]*\\([a-z\\u0400-\\u04FF0-9!\\*';:=\\+,\\.\\$\\/%#\\[\\]\\-\\u2013_~@\\|&\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u024F\\u0253\\u0254\\u0256\\u0257\\u0259\\u025B\\u0263\\u0268\\u026F\\u0272\\u0289\\u028B\\u02BB\\u0300-\\u036F\\u1E00-\\u1EFF]+\\)[a-z\\u0400-\\u04FF0-9!\\*';:=\\+,\\.\\$\\/%#\\[\\]\\-\\u2013_~@\\|&\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u024F\\u0253\\u0254\\u0256\\u0257\\u0259\\u025B\\u0263\\u0268\\u026F\\u0272\\u0289\\u028B\\u02BB\\u0300-\\u036F\\u1E00-\\u1EFF]*))\\)[a-z\\u0400-\\u04FF0-9!\\*';:=\\+,\\.\\$\\/%#\\[\\]\\-\\u2013_~@\\|&\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u024F\\u0253\\u0254\\u0256\\u0257\\u0259\\u025B\\u0263\\u0268\\u026F\\u0272\\u0289\\u028B\\u02BB\\u0300-\\u036F\\u1E00-\\u1EFF]*)*[\\+\\-a-z\\u0400-\\u04FF0-9=_#\\/\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u024F\\u0253\\u0254\\u0256\\u0257\\u0259\\u025B\\u0263\\u0268\\u026F\\u0272\\u0289\\u028B\\u02BB\\u0300-\\u036F\\u1E00-\\u1EFF]|(?:\\((?:[a-z\\u0400-\\u04FF0-9!\\*';:=\\+,\\.\\$\\/%#\\[\\]\\-\\u2013_~@\\|&\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u024F\\u0253\\u0254\\u0256\\u0257\\u0259\\u025B\\u0263\\u0268\\u026F\\u0272\\u0289\\u028B\\u02BB\\u0300-\\u036F\\u1E00-\\u1EFF]+|(?:[a-z\\u0400-\\u04FF0-9!\\*';:=\\+,\\.\\$\\/%#\\[\\]\\-\\u2013_~@\\|&\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u024F\\u0253\\u0254\\u0256\\u0257\\u0259\\u025B\\u0263\\u0268\\u026F\\u0272\\u0289\\u028B\\u02BB\\u0300-\\u036F\\u1E00-\\u1EFF]*\\([a-z\\u0400-\\u04FF0-9!\\*';:=\\+,\\.\\$\\/%#\\[\\]\\-\\u2013_~@\\|&\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u024F\\u0253\\u0254\\u0256\\u0257\\u0259\\u025B\\u0263\\u0268\\u026F\\u0272\\u0289\\u028B\\u02BB\\u0300-\\u036F\\u1E00-\\u1EFF]+\\)[a-z\\u0400-\\u04FF0-9!\\*';:=\\+,\\.\\$\\/%#\\[\\]\\-\\u2013_~@\\|&\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u024F\\u0253\\u0254\\u0256\\u0257\\u0259\\u025B\\u0263\\u0268\\u026F\\u0272\\u0289\\u028B\\u02BB\\u0300-\\u036F\\u1E00-\\u1EFF]*))\\)))|(?:@[a-z\\u0400-\\u04FF0-9!\\*';:=\\+,\\.\\$\\/%#\\[\\]\\-\\u2013_~@\\|&\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\u0100-\\u024F\\u0253\\u0254\\u0256\\u0257\\u0259\\u025B\\u0263\\u0268\\u026F\\u0272\\u0289\\u028B\\u02BB\\u0300-\\u036F\\u1E00-\\u1EFF]+\\/))*)?(\\?[a-z0-9!?\\*'@\\(\\);:&=\\+\\$\\/%#\\[\\]\\-_\\.,~|]*[a-z0-9\\-_&=#\\/])?))",Ta="gi",Zi={source:La,flags:Ta},yr=new RegExp(Zi.source,Zi.flags),Ia=/iPad|iPhone|iPod/.test(navigator.userAgent)&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent);function Qi({hidden:h,disabled:o=!1,supportedMimeTypes:f,setMediaAttachments:m}){const v=Ia?f:f?.filter(C=>!/^image\//i.test(C));return r("input",{type:"file",hidden:h,accept:v?.join(","),capture:"environment",disabled:o,onChange:C=>{const A=C.target.files;if(!A)return;const w=Array.from(A)[0];w&&(m(z=>[...z,{file:w,type:w.type,size:w.size,url:URL.createObjectURL(w),id:null,description:null}]),C.target.value=null)}})}const Ji="capture"in document.createElement("input");function za({maxCharacters:h=500,hidden:o}){const m=fr(Ie).composerCharacterCount,v=h-m;return o?r("span",{class:"char-counter",hidden:!0}):r("span",{class:"char-counter",title:`${v}/${h}`,style:{"--percentage":m/h*100},children:[r("meter",{class:`${v<=-10?"explode":v<=0?"danger":v<=20?"warning":""}`,value:m,max:h}),r("span",{class:"counter",children:v})]})}class _a{constructor(o,f,{tabInsertsSuggestions:m,defaultFirstOption:v,scrollIntoViewOptions:C}={}){this.input=o,this.list=f,this.tabInsertsSuggestions=m??!0,this.defaultFirstOption=v??!1,this.scrollIntoViewOptions=C??{block:"nearest",inline:"nearest"},this.isComposing=!1,f.id||(f.id=`combobox-${Math.random().toString().slice(2,6)}`),this.ctrlBindings=!!navigator.userAgent.match(/Macintosh/),this.keyboardEventHandler=A=>Ma(A,this),this.compositionEventHandler=A=>Ra(A,this),this.inputHandler=this.clearSelection.bind(this),o.setAttribute("role","combobox"),o.setAttribute("aria-controls",f.id),o.setAttribute("aria-expanded","false"),o.setAttribute("aria-autocomplete","list"),o.setAttribute("aria-haspopup","listbox")}destroy(){this.clearSelection(),this.stop(),this.input.removeAttribute("role"),this.input.removeAttribute("aria-controls"),this.input.removeAttribute("aria-expanded"),this.input.removeAttribute("aria-autocomplete"),this.input.removeAttribute("aria-haspopup")}start(){this.input.setAttribute("aria-expanded","true"),this.input.addEventListener("compositionstart",this.compositionEventHandler),this.input.addEventListener("compositionend",this.compositionEventHandler),this.input.addEventListener("input",this.inputHandler),this.input.addEventListener("keydown",this.keyboardEventHandler),this.list.addEventListener("click",er),this.indicateDefaultOption()}stop(){this.clearSelection(),this.input.setAttribute("aria-expanded","false"),this.input.removeEventListener("compositionstart",this.compositionEventHandler),this.input.removeEventListener("compositionend",this.compositionEventHandler),this.input.removeEventListener("input",this.inputHandler),this.input.removeEventListener("keydown",this.keyboardEventHandler),this.list.removeEventListener("click",er)}indicateDefaultOption(){var o;this.defaultFirstOption&&((o=Array.from(this.list.querySelectorAll('[role="option"]:not([aria-disabled="true"])')).filter(li)[0])===null||o===void 0||o.setAttribute("data-combobox-option-default","true"))}navigate(o=1){const f=Array.from(this.list.querySelectorAll('[aria-selected="true"]')).filter(li)[0],m=Array.from(this.list.querySelectorAll('[role="option"]')).filter(li),v=m.indexOf(f);if(v===m.length-1&&o===1||v===0&&o===-1){this.clearSelection(),this.input.focus();return}let C=o===1?0:m.length-1;if(f&&v>=0){const w=v+o;w>=0&&w<m.length&&(C=w)}const A=m[C];if(A)for(const w of m)w.removeAttribute("data-combobox-option-default"),A===w?(this.input.setAttribute("aria-activedescendant",A.id),A.setAttribute("aria-selected","true"),Oa(A),A.scrollIntoView(this.scrollIntoViewOptions)):w.removeAttribute("aria-selected")}clearSelection(){this.input.removeAttribute("aria-activedescendant");for(const o of this.list.querySelectorAll('[aria-selected="true"]'))o.removeAttribute("aria-selected");this.indicateDefaultOption()}}function Ma(h,o){if(!(h.shiftKey||h.metaKey||h.altKey)&&!(!o.ctrlBindings&&h.ctrlKey)&&!o.isComposing)switch(h.key){case"Enter":tr(o.input,o.list)&&h.preventDefault();break;case"Tab":o.tabInsertsSuggestions&&tr(o.input,o.list)&&h.preventDefault();break;case"Escape":o.clearSelection();break;case"ArrowDown":o.navigate(1),h.preventDefault();break;case"ArrowUp":o.navigate(-1),h.preventDefault();break;case"n":o.ctrlBindings&&h.ctrlKey&&(o.navigate(1),h.preventDefault());break;case"p":o.ctrlBindings&&h.ctrlKey&&(o.navigate(-1),h.preventDefault());break;default:if(h.ctrlKey)break;o.clearSelection()}}function er(h){if(!(h.target instanceof Element))return;const o=h.target.closest('[role="option"]');o&&o.getAttribute("aria-disabled")!=="true"&&Pa(o,{event:h})}function tr(h,o){const f=o.querySelector('[aria-selected="true"], [data-combobox-option-default="true"]');return f?(f.getAttribute("aria-disabled")==="true"||f.click(),!0):!1}function Pa(h,o){h.dispatchEvent(new CustomEvent("combobox-commit",{bubbles:!0,detail:o}))}function Oa(h){h.dispatchEvent(new Event("combobox-select",{bubbles:!0}))}function li(h){return!h.hidden&&!(h instanceof HTMLInputElement&&h.type==="hidden")&&(h.offsetWidth>0||h.offsetHeight>0)}function Ra(h,o){o.isComposing=h.type==="compositionstart",document.getElementById(o.input.getAttribute("aria-controls")||"")&&o.clearSelection()}const Ua=/\s|\(|\[/;function Ba(h,o,f,{multiWord:m,lookBackIndex:v,lastMatchPosition:C}={multiWord:!1,lookBackIndex:0,lastMatchPosition:null}){let A=h.lastIndexOf(o,f-1);if(A===-1||A<v)return;if(m){if(C!=null){if(C===A)return;A=C-o.length}if(h[A+1]===" "&&f>=A+o.length+1||h.lastIndexOf(`
`,f-1)>A||h.lastIndexOf(".",f-1)>A)return}else if(h.lastIndexOf(" ",f-1)>A)return;const w=h[A-1];return w&&!Ua.test(w)?void 0:{text:h.substring(A+o.length,f),position:A+o.length}}class Da extends Event{constructor(){super("update")}}const di=new WeakMap;class yi extends EventTarget{#t=new MutationObserver(()=>this.#f());#r=new ResizeObserver(()=>this.#d());#a;#n=document.createElement("div");#e=document.createElement("div");static for(o){let f=di.get(o);return f||(f=new yi(o),di.set(o,f)),f}constructor(o){super(),this.#a=new WeakRef(o),this.#n.style.position="absolute",this.#n.style.pointerEvents="none",this.#n.setAttribute("aria-hidden","true"),this.#n.appendChild(this.#e),this.#e.style.pointerEvents="none",this.#e.style.userSelect="none",this.#e.style.overflow="hidden",this.#e.style.display="block",this.#e.style.visibility="hidden",o instanceof HTMLTextAreaElement?(this.#e.style.whiteSpace="pre-wrap",this.#e.style.wordWrap="break-word"):(this.#e.style.whiteSpace="nowrap",this.#e.style.display="table-cell",this.#e.style.verticalAlign="middle"),o.after(this.#n),this.#f(),this.#h(),this.#t.observe(o,{attributeFilter:["style","dir"]}),this.#r.observe(o),document.addEventListener("scroll",this.#s,{capture:!0}),window.addEventListener("resize",this.#s,{capture:!0}),o.addEventListener("input",this.#m,{capture:!0})}get element(){return this.#e}forceUpdate(){this.#f(),this.#h()}disconnect(){this.#n?.remove(),this.#t.disconnect(),this.#r.disconnect(),document.removeEventListener("scroll",this.#s,{capture:!0}),window.removeEventListener("resize",this.#s,{capture:!0});const o=this.#o;o&&(o.removeEventListener("input",this.#m,{capture:!0}),di.delete(o))}get#o(){return this.#a?.deref()}#i(o){const f=this.#o;return f?o(f):this.disconnect()}#u=0;#c=0;#p(){this.#i(o=>{const f=window.getComputedStyle(o);this.#e.style.height=f.height,this.#e.style.width=f.width,o.clientHeight!==this.#e.clientHeight&&(this.#e.style.height=`calc(${f.height} + ${o.clientHeight-this.#e.clientHeight}px)`),o.clientWidth!==this.#e.clientWidth&&(this.#e.style.width=`calc(${f.width} + ${o.clientWidth-this.#e.clientWidth}px)`);const m=o.getBoundingClientRect(),v=this.#e.getBoundingClientRect();this.#u=this.#u+m.left-v.left,this.#c=this.#c+m.top-v.top,this.#e.style.transform=`translate(${this.#u}px, ${this.#c}px)`,this.#e.scrollTop=o.scrollTop,this.#e.scrollLeft=o.scrollLeft,this.dispatchEvent(new Da)})}#l=!1;#d(){this.#l||(this.#l=!0,requestAnimationFrame(()=>{this.#p(),this.#l=!1}))}#f(){this.#i(o=>{const f=window.getComputedStyle(o);for(const m of ja)this.#e.style[m]=f[m];this.#d()})}#h(){this.#i(o=>{this.#e.textContent=o.value,this.#p()})}#m=()=>this.#h();#s=o=>{this.#i(f=>{(o.target===document||o.target===window||o.target instanceof Node&&o.target.contains(f))&&this.#d()})}}const ja=["direction","writingMode","unicodeBidi","textOrientation","boxSizing","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"];class Bn{#t;#r;#a;constructor(o,f=0,m=f){this.#t=o,this.#r=f,this.#a=m}static fromSelection(o){const{selectionStart:f,selectionEnd:m}=o;return new Bn(o,f??void 0,m??void 0)}get collapsed(){return this.startOffset===this.endOffset}get commonAncestorContainer(){return this.#t}get endContainer(){return this.#t}get startContainer(){return this.#t}get startOffset(){return this.#r}get endOffset(){return this.#a}setStartOffset(o){this.#r=this.#o(o)}setEndOffset(o){this.#a=this.#o(o)}collapse(o=!1){o?this.setEndOffset(this.startOffset):this.setStartOffset(this.endOffset)}cloneContents(){return this.#i().cloneContents()}cloneRange(){return new Bn(this.#t,this.startOffset,this.endOffset)}getBoundingClientRect(){return this.#i().getBoundingClientRect()}getClientRects(){return this.#i().getClientRects()}toString(){return this.#i().toString()}getStyleClone(){return this.#n}get#n(){return yi.for(this.#t)}get#e(){return this.#n}#o(o){return Math.max(0,Math.min(o,this.#t.value.length))}#i(){const o=document.createRange(),f=this.#e.element.childNodes[0];return f&&(o.setStart(f,this.startOffset),o.setEnd(f,this.endOffset)),o}}const On=new WeakMap;let Na=class{constructor(o,f){this.expander=o,this.input=f,this.combobox=null,this.menu=null,this.match=null,this.justPasted=!1,this.lookBackIndex=0,this.oninput=this.onInput.bind(this),this.onpaste=this.onPaste.bind(this),this.onkeydown=this.onKeydown.bind(this),this.oncommit=this.onCommit.bind(this),this.onmousedown=this.onMousedown.bind(this),this.onblur=this.onBlur.bind(this),this.interactingWithList=!1,f.addEventListener("paste",this.onpaste),f.addEventListener("input",this.oninput),f.addEventListener("keydown",this.onkeydown),f.addEventListener("blur",this.onblur)}destroy(){this.input.removeEventListener("paste",this.onpaste),this.input.removeEventListener("input",this.oninput),this.input.removeEventListener("keydown",this.onkeydown),this.input.removeEventListener("blur",this.onblur)}dismissMenu(){this.deactivate()&&(this.lookBackIndex=this.input.selectionEnd||this.lookBackIndex)}activate(o,f){var m,v;this.input!==document.activeElement&&this.input!==((v=(m=document.activeElement)===null||m===void 0?void 0:m.shadowRoot)===null||v===void 0?void 0:v.activeElement)||(this.deactivate(),this.menu=f,f.id||(f.id=`text-expander-${Math.floor(Math.random()*1e5).toString()}`),this.expander.append(f),this.combobox=new _a(this.input,f),this.expander.dispatchEvent(new Event("text-expander-activate")),this.positionMenu(f,o.position),this.combobox.start(),f.addEventListener("combobox-commit",this.oncommit),f.addEventListener("mousedown",this.onmousedown),this.combobox.navigate(1))}positionMenu(o,f){const m=new Bn(this.input,f).getBoundingClientRect(),v={left:m.left,top:m.top+m.height},C=o.getBoundingClientRect(),A={left:v.left-C.left,top:v.top-C.top};if(A.left!==0||A.top!==0){const w=getComputedStyle(o);o.style.left=w.left?`calc(${w.left} + ${A.left}px)`:`${A.left}px`,o.style.top=w.top?`calc(${w.top} + ${A.top}px)`:`${A.top}px`}}deactivate(){const o=this.menu;return!o||!this.combobox?!1:(this.expander.dispatchEvent(new Event("text-expander-deactivate")),this.menu=null,o.removeEventListener("combobox-commit",this.oncommit),o.removeEventListener("mousedown",this.onmousedown),this.combobox.destroy(),this.combobox=null,o.remove(),!0)}onCommit({target:o}){var f;const m=o;if(!(m instanceof HTMLElement)||!this.combobox)return;const v=this.match;if(!v)return;const C=this.input.value.substring(0,v.position-v.key.length),A=this.input.value.substring(v.position+v.text.length),w={item:m,key:v.key,value:null,continue:!1};if(!this.expander.dispatchEvent(new CustomEvent("text-expander-value",{cancelable:!0,detail:w}))||!w.value)return;let S=(f=this.expander.getAttribute("suffix"))!==null&&f!==void 0?f:" ";w.continue&&(S="");const L=`${w.value}${S}`;this.input.value=C+L+A;const le=C.length+L.length;this.deactivate(),this.input.focus({preventScroll:!0}),this.input.selectionStart=le,this.input.selectionEnd=le,w.continue||(this.lookBackIndex=le,this.match=null),this.expander.dispatchEvent(new CustomEvent("text-expander-committed",{cancelable:!1,detail:{input:this.input}}))}onBlur(){if(this.interactingWithList){this.interactingWithList=!1;return}this.deactivate()}onPaste(){this.justPasted=!0}async onInput(){if(this.justPasted){this.justPasted=!1;return}const o=this.findMatch();if(o){this.match=o;const f=await this.notifyProviders(o);if(!this.match)return;f?this.activate(o,f):this.deactivate()}else this.match=null,this.deactivate()}findMatch(){const o=this.input.selectionEnd||0,f=this.input.value;o<=this.lookBackIndex&&(this.lookBackIndex=o-1);for(const{key:m,multiWord:v}of this.expander.keys){const C=Ba(f,m,o,{multiWord:v,lookBackIndex:this.lookBackIndex,lastMatchPosition:this.match?this.match.position:null});if(C)return{text:C.text,key:m,position:C.position}}}async notifyProviders(o){const f=[],m=z=>f.push(z),v=new CustomEvent("text-expander-change",{cancelable:!0,detail:{provide:m,text:o.text,key:o.key}});return this.expander.dispatchEvent(v)?(await Promise.all(f)).filter(z=>z.matched).map(z=>z.fragment)[0]:void 0}onMousedown(){this.interactingWithList=!0}onKeydown(o){o.key==="Escape"&&(this.match=null,this.deactivate()&&(this.lookBackIndex=this.input.selectionEnd||this.lookBackIndex,o.stopImmediatePropagation(),o.preventDefault()))}};class nr extends HTMLElement{get keys(){const o=this.getAttribute("keys"),f=o?o.split(" "):[],m=this.getAttribute("multiword"),v=m?m.split(" "):[],C=v.length===0&&this.hasAttribute("multiword");return f.map(A=>({key:A,multiWord:C||v.includes(A)}))}set keys(o){this.setAttribute("keys",o)}connectedCallback(){const o=this.querySelector('input[type="text"], textarea');if(!(o instanceof HTMLInputElement||o instanceof HTMLTextAreaElement))return;const f=new Na(this,o);On.set(this,f)}disconnectedCallback(){const o=On.get(this);o&&(o.destroy(),On.delete(this))}dismiss(){const o=On.get(this);o&&o.dismissMenu()}}window.customElements.get("text-expander")||(window.TextExpanderElement=nr,window.customElements.define("text-expander",nr));async function $a(h,o){const m=(await o.v1.customEmojis.list()).filter(C=>C.visibleInPicker),v=new ca(m,{keys:["shortcode"],findAllMatches:!0});return[m,v]}const xr=Yr($a,{isKeyItemEqual:(h,o)=>h.instance===o.instance,expires:1800*1e3}),vt=document.createElement("ul");vt.role="listbox";vt.className="text-expander-menu";const Ha=16,Ka=new IntersectionObserver(h=>{h.forEach(o=>{if(o.isIntersecting){const{left:f,width:m}=o.boundingClientRect,{innerWidth:v}=window;if(f+m>v){const C=la()?"right":"left";vt.style[C]=v-m-Ha+"px"}}})});Ka.observe(vt);function mt(h){return h.replace(/[&<>"']/g,function(o){return"&#"+o.charCodeAt(0)+";"})}function qa({onTrigger:h=null,...o},f){const{_:m}=bt(),v=ce(),{masto:C,instance:A}=vi(),w=ce(),z=ce(""),S=ce(!1);return Xr(f,()=>({setStyle:L=>{v.current&&Object.assign(v.current.style,L)},activated:()=>S.current})),Ae(()=>{w.current||xr(A,C).then(([,L])=>{w.current=L}).catch(L=>{})},[A,C]),Ae(()=>{const L=v.current;if(!L)return;const le=B=>{const{key:H,provide:he,text:F}=B.detail;if(z.current=F,F===""){he(Promise.resolve({matched:!1}));return}if(H===":"){const ve=!!h,de=w.current?.search(F,{limit:5});let ge="";de?.forEach(({item:ye})=>{const{shortcode:U,url:G}=ye;ge+=`
            <li role="option" data-value="${mt(U)}">
              <img src="${mt(G)}" width="16" height="16" alt="" loading="lazy" />
              ${mt(U)}
            </li>`}),ve&&(ge+=`<li role="option" data-value="" data-more="${F}">More…</li>`),vt.innerHTML=ge,he(Promise.resolve({matched:(de?.length||0)>0,fragment:vt}));return}const Q={"@":"accounts","＠":"accounts","#":"hashtags","＃":"hashtags"}[H];if(Q){he(new Promise(async ve=>{try{let de;if(Q==="accounts")de=await C.v1.accounts.search.list({q:F,limit:5,resolve:!1});else{const U=await C.v2.search.list({type:Q,q:F,limit:5});de=U[Q]||U}if(F!==z.current)return;const ge=de;let ye="";ge.forEach(U=>{const{name:G,avatarStatic:re,displayName:Fe,username:Me,acct:_e,emojis:pe,history:Ne,roles:Je,url:Be}=U,$e=da(Fe,pe),Y=Zr(Be);if(_e)ye+=`
                    <li role="option" data-value="${mt(_e)}">
                      <span class="avatar">
                        <img src="${mt(re)}" width="16" height="16" alt="" loading="lazy" />
                      </span>
                      <span>
                        <b>${$e||Me}</b>
                        <br><span class="bidi-isolate">@${mt(_e)}</span>
                        ${Je?.map(xe=>` <span class="tag collapsed">
                            ${xe.name}
                            ${!!Y&&`<span class="more-insignificant">
                                ${Y}
                              </span>`}
                          </span>`)||""}
                      </span>
                    </li>
                  `;else{const xe=Ne?.reduce?.((Ee,He)=>Ee+ +He.uses,0);ye+=`
                    <li role="option" data-value="${mt(G)}">
                      <span class="grow">#<b>${mt(G)}</b></span>
                      ${xe?`<span class="count">${fa(xe)}</span>`:""}
                    </li>
                  `}}),Q==="accounts"&&(ye+=`<li role="option" data-value="" data-more="${F}">${m({id:"24misb"})}</li>`),vt.innerHTML=ye,ve({matched:ge.length>0,fragment:vt})}catch{ve({matched:!1})}}));return}he(Promise.resolve({matched:!1}))},O=B=>{const{key:H,item:he}=B.detail,{value:F,more:Q}=he.dataset;H===":"?(B.detail.value=F?`:${F}:`:"​",Q&&(B.detail.continue=!0,setTimeout(()=>{h?.({name:"custom-emojis",defaultSearchTerm:Q})},300))):H==="@"?(B.detail.value=F?`@${F}`:"​",Q&&(B.detail.continue=!0,setTimeout(()=>{h?.({name:"mention",defaultSearchTerm:Q})},300))):B.detail.value=`${H}${F}`},N=B=>{const{input:H}=B.detail;if(H){const he=new Event("input",{bubbles:!0});H.dispatchEvent(he)}},P=()=>{S.current=!0},j=()=>{S.current=!1};return L.addEventListener("text-expander-change",le),L.addEventListener("text-expander-value",O),L.addEventListener("text-expander-committed",N),L.addEventListener("text-expander-activate",P),L.addEventListener("text-expander-deactivate",j),()=>{L.removeEventListener("text-expander-change",le),L.removeEventListener("text-expander-value",O),L.removeEventListener("text-expander-committed",N),L.removeEventListener("text-expander-activate",P),L.removeEventListener("text-expander-deactivate",j)}},[w.current,h,m,C]),r("text-expander",{ref:v,...o})}const xi=hr(qa),wr={300:Lt(5,"minute"),1800:Lt(30,"minute"),3600:Lt(1,"hour"),21600:Lt(6,"hour"),86400:Lt(1,"day"),259200:Lt(3,"day"),604800:Lt(1,"week")};function Wa({lang:h,poll:o,disabled:f,onInput:m=()=>{},maxOptions:v,maxExpiration:C,minExpiration:A,maxCharactersPerOption:w}){const{_:z}=bt(),{options:S,expiresIn:L,multiple:le}=o;return r("div",{class:`poll ${le?"multiple":""}`,children:[r("div",{class:"poll-choices",children:S.map((O,N)=>r("div",{class:"poll-choice",children:[r(xi,{keys:":",class:"poll-field-container",children:r("input",{required:!0,type:"text",value:O,disabled:f,maxlength:w,placeholder:z({id:"LDUSXg",values:{0:N+1}}),lang:h,spellCheck:"true",autocomplete:"off",dir:"auto","data-allow-custom-emoji":"true",onInput:P=>{const{value:j}=P.target;S[N]=j,m(o)}})}),r("button",{type:"button",class:"plain4 poll-button",disabled:f||S.length<=1,onClick:()=>{S.splice(N,1),m(o)},title:z({id:"t/YqKh"}),children:"−"})]},N))}),r("div",{class:"poll-toolbar",children:[r("button",{type:"button",class:"plain2 poll-button",disabled:f||S.length>=v,onClick:()=>{S.push(""),m(o)},title:z({id:"m16xKo"}),children:"+"})," ",r("div",{class:"poll-config",children:[r("label",{class:"multiple-choices",children:[r("input",{type:"checkbox",checked:le,disabled:f,onChange:O=>{const{checked:N}=O.target;o.multiple=N,m(o)}})," ",r(ne,{id:"zytZXj"})]}),r("label",{class:"expires-in",children:[r(ne,{id:"lkz6PL"})," ",r("select",{value:L,disabled:f,onChange:O=>{const{value:N}=O.target;o.expiresIn=N,m(o)},children:Object.entries(wr).filter(([O])=>O>=A&&O<=C).map(([O,N])=>r("option",{value:O,children:N()},O))})]}),r("div",{class:"spacer"}),r("button",{type:"button",class:"light danger small",disabled:f,onClick:()=>{m(null)},children:r(ne,{id:"CDpQAX"})})]})]})]})}const Va=/[a-z0-9_]+([a-z0-9_.-]+[a-z0-9_]+)?/i,Ga=new RegExp(`(^|[^=\\/\\w])([@＠]${Va.source}(?:@[\\p{L}\\w.-]+[\\w]+)?)`,"uig"),Ya=new RegExp("(^|[^=\\/\\w])([#＃][\\p{L}\\p{N}_]+([\\p{L}\\p{N}_.]+[\\p{L}\\p{N}_]+)?)(?![\\/\\w])","iug"),Xa="[a-zA-Z0-9_]{2,}",Za=new RegExp(`(^|[^=\\/\\w])(:${Xa}:)(?=[^A-Za-z0-9_:]|$)`,"g"),Qa=new Intl.Segmenter;function Ja(h,{maxCharacters:o=1/0}){const{composerCharacterCount:f}=Ie;if(f>o){let m="",v="";const C=Qa.segment(h);for(const{segment:A,index:w}of C)w<o?m+=A:v+=A;return v&&(v='<mark class="compose-highlight-exceeded">'+ui(v)+"</mark>"),ui(m)+v}return ui(h).replace(yr,'$2<mark class="compose-highlight-url">$3</mark>').replace(Ga,'$1<mark class="compose-highlight-mention">$2</mark>').replace(Ya,'$1<mark class="compose-highlight-hashtag">$2</mark>').replace(Za,'$1<mark class="compose-highlight-emoji-shortcode">$2</mark>')}function ir(h){if(!h)return;const{value:o,offsetHeight:f,scrollHeight:m,clientHeight:v}=h;if(f<window.innerHeight){const C=f-v,A=o?m+C+"px":null;h.style.height=A}}const eo=async h=>{if(Vi){const m=await Vi.detect(h);if(m?.length)return m.slice(0,2).map(v=>v.detectedLanguage)}const{detectAll:o}=await Qr(async()=>{const{detectAll:m}=await import("./tinyld.light.node-D9KYf3Y3.js");return{detectAll:m}},[],import.meta.url),f=o(h);return f?.length?f.slice(0,2).map(m=>m.lang):null},to=hr((h,o)=>{const[f,m]=ie(o.current?.value||""),{maxCharacters:v,onTrigger:C=null,...A}=h,w=ce();gr({ref:o,onResize:()=>{if(w.current&&o.current){const{height:O}=o.current.getBoundingClientRect();O&&w.current.setStyle({minHeight:O+"px"})}}});const z=ce(0),S=ce(),L=ha(O=>{if(!S.current)return;if(z.current>3){S.current.innerHTML="",S.current=null,L?.cancel?.();return}let N,P;z.current<=3&&(N=Date.now()),S.current.innerHTML=Ja(O,{maxCharacters:v})+`
`,z.current<=3&&(P=Date.now()),N&&P&&P-N>50&&z.current++},500),le=jn(()=>{const O=S.current?.cloneNode(!0);if(!O)return;O.querySelectorAll("mark").forEach(P=>{P.remove()});const N=O.innerText?.trim();N&&(async()=>{const P=await eo(N);P?.length&&C?.({name:"auto-detect-language",languages:P})})()},2e3);return r(xi,{ref:w,keys:"@ ＠ : # ＃",class:"compose-field-container",onTrigger:C,children:[r("textarea",{class:"compose-field",autoCapitalize:"sentences",autoComplete:"on",autoCorrect:"on",spellCheck:"true",dir:"auto",rows:"6",cols:"50",...A,ref:o,name:"status",value:f,onKeyDown:O=>{const{key:N,target:P}=O,j=w.current?.activated();if(N==="Enter"&&!(O.ctrlKey||O.metaKey||j)&&!O.isComposing)try{const{value:B,selectionStart:H}=P,F=B.slice(0,H).split(`
`).slice(-1)[0];if(F&&/^\s*(-|\d+\.)\s/.test(F)){const[Q,ve,de,ge,ye]=F.match(/^(\s*)(-|\d+\.)(\s+)(.+)?/)||[];if(ye){O.preventDefault();const[U]=de.match(/\d+/)||[],G=U?`${+U+1}.`:"-",re=`
${ve}${G}${ge}`;P.setRangeText(re,H,H);const Fe=H+re.length;P.setSelectionRange(Fe,Fe)}else{const U=H-F.length;P.setRangeText("",U,H)}ir(P),P.dispatchEvent(new Event("input"))}}catch{}S.current&&(S.current.scrollTop=P.scrollTop)},onInput:O=>{const{target:N}=O,P=N.value;m(P),ir(N),h.onInput?.(O),L(P),le()},onScroll:O=>{if(S.current){const{scrollTop:N}=O.target;S.current.scrollTop=N}},onPaste:O=>{try{const N=O.clipboardData.getData("text").trim();N&&C?.({name:"pasted-link",url:N})}catch{}}}),r("div",{ref:S,class:"compose-highlight","aria-hidden":"true"})]})}),gi=100,sn=1,rr=2,ar=.5,kr=pr(({emoji:h,onClick:o,showCode:f})=>{const m=v=>{const A=v.currentTarget.closest("main");if(A){const w=A.getBoundingClientRect(),z=v.currentTarget.getBoundingClientRect(),S=v.currentTarget.classList;z.left<w.left+88?(S.add("edge-left"),S.remove("edge-right")):z.right>w.right-88?(S.add("edge-right"),S.remove("edge-left")):S.remove("edge-left","edge-right")}};return r("button",{type:"button",className:"plain4",onClick:o,"data-title":f?void 0:h.shortcode,onPointerEnter:m,onFocus:m,children:[r("picture",{children:[!!h.staticUrl&&r("source",{srcSet:h.staticUrl,media:"(prefers-reduced-motion: reduce)"}),r("img",{className:"shortcode-emoji",src:h.url||h.staticUrl,alt:h.shortcode,width:"24",height:"24",loading:"lazy",decoding:"async"})]}),f&&r(It,{children:[" ",r("code",{children:h.shortcode})]})]})}),no=pr(({emojis:h,onSelect:o})=>{const{i18n:f}=bt(),[m,v]=ie(gi),C=h.length>m;return r("section",{children:[h.slice(0,m).map(A=>r(kr,{emoji:A,onClick:()=>{o(`:${A.shortcode}:`)}},A.shortcode)),C&&r("button",{type:"button",class:"plain small",onClick:()=>v(m+gi),children:r(ne,{id:"iAB71E",values:{0:f.number(h.length-m)}})})]})}),un="composer-customEmojiSize";function io({masto:h,instance:o,onClose:f=()=>{},onSelect:m=()=>{},defaultSearchTerm:v}){const{_:C}=bt(),[A,w]=ie("default"),z=ce([]),[S,L]=ie([]),le=Kt(()=>it.account.get("recentlyUsedCustomEmojis")||[]),O=ce();Ae(()=>{w("loading"),(async()=>{try{const[U,G]=await xr(o,h);O.current=G,L(U),w("default")}catch{w("error")}})()},[]);const N=Kt(()=>{const U={"--recent--":le.filter(re=>S.find(Fe=>Fe.shortcode===re.shortcode))},G=[];return S.forEach(re=>{if(z.current?.push?.(re),!re.category){G.push(re);return}U[re.category]||(U[re.category]=[]),U[re.category].push(re)}),G.length&&(U["--others--"]=G),U},[S]),P=ce(),[j,B]=ie(null),[H,he]=ie(it.local.get(un)||sn),F=Mn(()=>{const U=Math.max(sn,H-ar);he(U),U===sn?it.local.del(un):it.local.set(un,U)},[H]),Q=Mn(()=>{const U=Math.min(rr,H+ar);he(U),U===sn?it.local.del(un):it.local.set(un,U)},[H]),ve=Mn(U=>{const{value:G}=U.target;if(G){const re=O.current?.search(G,{limit:gi});B(re.map(Fe=>Fe.item)),P.current?.scrollTo?.(0,0)}else B(null)},[S]);Ae(()=>{v&&S?.length&&ve({target:{value:v}})},[v,ve,S]);const de=Mn(U=>{m?.(U),f?.(),queueMicrotask(()=>{let G=it.account.get("recentlyUsedCustomEmojis")||[];const re=G.findIndex(Fe=>Fe.shortcode===U.shortcode);re!==-1?(G.splice(re,1),G.unshift(U)):(G.unshift(U),G=G.filter(Fe=>z.current?.find?.(Me=>Me.shortcode===Fe.shortcode)),G=G.slice(0,10)),it.account.set("recentlyUsedCustomEmojis",G)})},[m]),ge=ce();Ae(()=>{ge.current&&(ge.current.focus(),ge.current.value&&(ge.current.selectionStart=ge.current.value.length,ge.current.selectionEnd=ge.current.value.length))},[]);const ye=!!S?.length;return r("div",{id:"custom-emojis-sheet",class:"sheet",style:{"--custom-emoji-size":H},children:[!!f&&r("button",{type:"button",class:"sheet-close",onClick:f,children:r(ee,{icon:"x",alt:C({id:"yz7wBu"})})}),r("header",{children:[r("div",{children:[r("b",{children:r(ne,{id:"8i6Ueo"})})," ",A==="loading"?r(Dn,{}):r("small",{class:"insignificant",children:[" • ",o]})]}),ye&&r("form",{onSubmit:U=>{U.preventDefault();const G=j[0];G&&de(`:${G.shortcode}:`)},children:r("input",{ref:ge,type:"search",placeholder:C({id:"EarrCe"}),onInput:ve,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellCheck:"false",dir:"auto",enterKeyHint:"search",defaultValue:v||""})})]}),r("main",{ref:P,children:ye?r(It,{children:[j!==null?r("ul",{class:"custom-emojis-matches custom-emojis-list",children:j.map(U=>r("li",{class:"custom-emojis-match",children:r(kr,{emoji:U,onClick:()=>{de(`:${U.shortcode}:`)},showCode:!0})},U.shortcode))}):r("div",{class:"custom-emojis-list",children:[A==="error"&&r("div",{class:"ui-state",children:r("p",{children:r(ne,{id:"Kzwsg2"})})}),A==="default"&&Object.entries(N).map(([U,G])=>!!G?.length&&r("div",{class:"section-container",children:[r("div",{class:"section-header",children:{"--recent--":C({id:"uabU9X"}),"--others--":C({id:"NuKR0h"})}[U]||U}),r(no,{emojis:G,onSelect:de})]}))]}),r("div",{class:"size-range",children:[r("button",{type:"button",class:"plain4",onClick:F,disabled:H<=sn,children:r(ee,{icon:"zoom-out",size:"l",alt:C({id:"FjkaiT"})})}),r("button",{type:"button",class:"plain4",onClick:Q,disabled:H>=rr,children:r(ee,{icon:"zoom-in",size:"l",alt:C({id:"AWOSPo"})})})]})]}):r("div",{class:"ui-state",children:r("p",{children:r(ne,{id:"oQIgSu"})})})})]})}function or({hidden:h,supportedMimeTypes:o,maxMediaAttachments:f,mediaAttachments:m,disabled:v=!1,setMediaAttachments:C}){return r("input",{type:"file",hidden:h,accept:o?.join(","),multiple:f===void 0||f-m>=2,disabled:v,onChange:A=>{const w=A.target.files;if(!w)return;const z=Array.from(w).map(S=>({file:S,type:S.type,size:S.size,url:URL.createObjectURL(S),id:null,description:null}));m.length+z.length>f?alert(cn._({id:"ctFhjs",values:{maxMediaAttachments:f}})):C(S=>S.concat(z)),A.target.value=""}})}const ro="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20version='1.0'%20viewBox='0%200%20641%20223'%3e%3cpath%20fill='%23aaa'%20d='M86%20214c-9-1-17-4-24-8l-6-3-5-5-5-4-4-6-4-6-3-8-2-8v-27l2-9%203-9%204-6%204-6%205-5%205-5%207-3%206-4%207-2%207-2%2012-1h12l7%201%208%202%207%204%207%203%205%205%205%204-10%2010-10%209-4-3-10-5-5-1H88l-5%202-6%203-3%204-4%204-2%205-2%206v6l-1%207%201%207%202%207%203%205%202%204%204%203%204%203%205%202%206%202h9l10-1%205-2%206-3v-16H91v-27h59v54l-1%203-2%203-5%204-4%204-5%203-5%202-8%202-8%202-10%201H92l-6-1zm266-62V91h34v46h44V91h34v121h-34v-46h-44v46h-34v-61zm-182-1V90h34v121h-34v-60zm59-1V90h35l36%201%205%202c3%200%208%202%2010%204l5%202%204%205%205%204%203%207%203%207%201%2013v13l-4%206-3%207-4%204-5%205-5%202-5%203-6%202-5%201-18%201h-18v32h-34v-61zm67-2%203-2%202-4%202-5v-5l-2-4-2-4-3-2-3-3h-30v31h30l3-2zm226%2039v-24l-8-12-18-28a1751%201751%200%200%200-20-31v-2h39l7%2012%2012%2021%206%209%2013-21%2013-21h38v2l-41%2061-7%2010v48h-34v-24zM109%2066l-4-1-5-5-5-4-1-5-3-9v-5l1-5c2-7%203-10%208-15l4-4%207-2%207-2h7l6%201%205%202%205%202%203%204%204%203%202%206%202%205v13l-2%205-2%206-4%204-3%203-5%202-4%202-9%201h-9l-5-2zm22-11%204-2%203-4%202-5V34l-2-4-2-4-3-2-4-3-5-1h-6l-4%202-5%202-2%204-3%205-1%203v4l1%205%202%205%202%202%205%203%204%202h10l4-2zM37%2039V11h33l3%201%203%202%204%203%203%203%201%205%201%204v5l-1%204-3%204-3%205-4%201-3%202-11%201H49v16H37V39zm31%200%203-2%201-2%201-2v-4l-1-3-3-2-2-2H49v18h15l4-1zm107%2025a512%20512%200%200%200-19-53h14l4%2014%206%2019%201%204%201-1%207-19%205-17h9l6%2019%207%2018v-1l2-6%205-17%204-13h14v1l-4%2012-16%2041v2h-5l-5-1-6-15-6-15-1%201-3%207-6%2015-2%208h-11l-1-3zm74-25V11h42v11h-29v2l-1%205v4h29v11h-28v11h2l15%201h13v11h-43V39zm55%200V11h33l5%203%205%202%202%204%202%205v10l-2%203-1%204-5%203-5%203%205%205%208%2010%203%204h-14l-7-9-8-10h-9v19h-12V39zm33-3%202-3v-6l-3-3-2-3h-18v16h1v1h17l2-2zm26%203V11h42v11h-29l-1%206v5h29v11h-28v5l-1%205%201%201v1h30v11h-43V39zm54%200V11h17l18%201%204%202%205%203%202%204%203%204%202%206%201%206v5c-1%206-3%2012-6%2015l-3%204-5%203-5%202-17%201h-16V39zm33%2014%205-5%202-3v-6l-1-6-1-3-1-3-4-3-3-2h-5l-6-1-3%201h-3v34h9l8-1%203-2zm50-14V11h34l5%202%204%202%202%203%202%203v9l-2%202-3%204-1%201%203%203%203%204%201%203%201%204-1%204-1%204-3%203-3%203-5%201-5%201h-31V39zm34%2015%202-1v-6l-2-2-2-2h-20v13h20l2-2zm-3-22%204-2v-6l-2-1-2-2h-19v12h16l4-1zm42%2024V45l-6-9-11-17-5-8h15l4%208%207%2011%202%203%207-11%207-11h14l-11%2016-11%2017v23h-12V56z'/%3e%3c/svg%3e",ao={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Phanpy",PHANPY_PRIVACY_POLICY_URL:"https://github.com/cheeaun/phanpy/blob/main/PRIVACY.MD",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_GIPHY_API_KEY:oo}=ao,fi=20;function so({onClose:h=()=>{},onSelect:o=()=>{}}){const{i18n:f,_:m}=bt(),[v,C]=ie("default"),[A,w]=ie([]),z=ce(null),S=ce(null),L=ce(0),le=ce(null);function O({offset:P}){S.current?.value&&(C("loading"),le.current?.scrollTo?.({top:0,left:0,behavior:"smooth"}),(async()=>{try{const j={api_key:oo,q:S.current.value,rating:"g",limit:fi,bundle:"messaging_non_clips",offset:P,lang:f.locale||"en"},B=await fetch("https://api.giphy.com/v1/gifs/search?"+new URLSearchParams(j),{referrerPolicy:"no-referrer"}).then(H=>H.json());L.current=B.pagination?.offset||0,w(B),C("results")}catch{C("error")}})())}Ae(()=>{S.current?.focus()},[]);const N=jn(()=>{O({offset:0})},1e3);return r("div",{id:"gif-picker-sheet",class:"sheet",children:[!!h&&r("button",{type:"button",class:"sheet-close",onClick:h,children:r(ee,{icon:"x",alt:m({id:"yz7wBu"})})}),r("header",{children:r("form",{ref:z,onSubmit:P=>{P.preventDefault(),O({offset:0})},children:[r("input",{ref:S,type:"search",name:"q",placeholder:m({id:"wxlF9B"}),required:!0,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellCheck:"false",dir:"auto",enterKeyHint:"search",onInput:N}),r("input",{type:"image",class:"powered-button",src:ro,width:"86",height:"30",alt:m({id:"c1Q/eU"})})]})}),r("main",{ref:le,class:v==="loading"?"loading":"",children:[v==="default"&&r("div",{class:"ui-state",children:r("p",{class:"insignificant",children:r(ne,{id:"9KEidY"})})}),v==="loading"&&!A?.data?.length&&r("div",{class:"ui-state",children:r(Dn,{abrupt:!0})}),A?.data?.length>0?r(It,{children:[r("ul",{children:A.data.map(P=>{const{id:j,images:B,title:H,alt_text:he}=P,{fixed_height_small:F,fixed_height_downsampled:Q,fixed_height:ve,original:de}=B,ge=F?.url?F:Q?.url?Q:ve;let{url:ye,webp:U,width:G,height:re}=ge;+re>100&&(G=G/re*100,re=100);const Fe=URL.parse(ye),Me=Fe.origin+Fe.pathname;let _e;if(U){const pe=URL.parse(U);_e=pe.origin+pe.pathname}return r("li",{children:r("button",{type:"button",onClick:()=>{const{mp4:pe,url:Ne}=de,Je=pe||Ne,Be=URL.parse(Je),$e=Be.origin+Be.pathname;h(),o({url:$e,type:pe?"video/mp4":"image/gif",alt_text:he||H})},children:r("figure",{style:{"--figure-width":G+"px"},children:[r("picture",{children:[_e&&r("source",{srcset:_e,type:"image/webp"}),r("img",{src:Me,width:G,height:re,loading:"lazy",decoding:"async",alt:he,referrerpolicy:"no-referrer",onLoad:pe=>{pe.target.style.backgroundColor="transparent"}})]}),r("figcaption",{children:he||H})]})})},j)})}),r("p",{class:"pagination",children:[A.pagination?.offset>0&&r("button",{type:"button",class:"light small",disabled:v==="loading",onClick:()=>{O({offset:A.pagination?.offset-fi})},children:[r(ee,{icon:"chevron-left"}),r("span",{children:r(ne,{id:"DHhJ7s"})})]}),r("span",{}),A.pagination?.offset+A.pagination?.count<A.pagination?.total_count&&r("button",{type:"button",class:"light small",disabled:v==="loading",onClick:()=>{O({offset:A.pagination?.offset+fi})},children:[r("span",{children:r(ne,{id:"hXzOVo"})})," ",r(ee,{icon:"chevron-right"})]})]})]}):v==="results"&&r("div",{class:"ui-state",children:r("p",{children:"No results"})}),v==="error"&&r("div",{class:"ui-state",children:r("p",{children:r(ne,{id:"PbFw9n"})})})]})]})}var ln={exports:{}};const hi=Jr(Ca);var uo=ln.exports,sr;function co(){return sr||(sr=1,(function(h,o){(function(f,m){h.exports=m()})(Object(typeof self<"u"?self:uo),function(){return(function(){"use strict";var f={d:function(e,t){for(var n in t)f.o(t,n)&&!f.o(e,n)&&Object.defineProperty(e,n,{enumerable:1,get:t[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:1})}},m={};function v(e,t,n){for(var a=[],s=0;s<n&&t+s<e.byteLength;s++)a.push(e.getUint8(t+s));return A(a)}function C(e,t){for(var n=[],a=0;t+a<e.byteLength;){var s=e.getUint8(t+a);if(s===0)break;n.push(s),a++}return A(n)}function A(e){return e.map(function(t){return String.fromCharCode(t)}).join("")}function w(){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])arguments[0][t]=arguments[e][t];return arguments[0]}f.r(m),f.d(m,{default:function(){return Wr},errors:function(){return Vr},load:function(){return Ni},loadView:function(){return ni}});var z=void 0;function S(e){return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(e)}function L(e){var t=(function(n){if(S(n)!="object"||!n)return n;var a=n[Symbol.toPrimitive];if(a!==void 0){var s=a.call(n,"string");if(S(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return n+""})(e);return S(t)=="symbol"?t:t+""}var le=(function(){return e=function n(a){if((function(s,u){if(!(s instanceof u))throw new TypeError("Cannot call a class as a function")})(this,n),(function(s){return S(s)!=="object"||s.length===void 0||s.readUInt8===void 0||s.readUInt16LE===void 0||s.readUInt16BE===void 0||s.readUInt32LE===void 0||s.readUInt32BE===void 0||s.readInt32LE===void 0||s.readInt32BE===void 0})(a))throw Error("DataView: Passed buffer type is unsupported.");this.buffer=a,this.byteLength=this.buffer.length},(t=[{key:"getUint8",value:function(n){return this.buffer.readUInt8(n)}},{key:"getUint16",value:function(n,a){return a?this.buffer.readUInt16LE(n):this.buffer.readUInt16BE(n)}},{key:"getUint32",value:function(n,a){return a?this.buffer.readUInt32LE(n):this.buffer.readUInt32BE(n)}},{key:"getInt32",value:function(n,a){return a?this.buffer.readInt32LE(n):this.buffer.readInt32BE(n)}}])&&(function(n,a){for(var s=0;s<a.length;s++){var u=a[s];u.enumerable=u.enumerable||0,u.configurable=1,"value"in u&&(u.writable=1),Object.defineProperty(n,L(u.key),u)}})(e.prototype,t),Object.defineProperty(e,"prototype",{writable:0}),e;var e,t})();function O(e){return e[0][0]/e[0][1]+e[1][0]/e[1][1]/60+e[2][0]/e[2][1]/3600}var N=2,P=65496,j=2,B=4,H=2,he=10,F=18,Q=33,ve=79,de=65472,ge=65474,ye=65476,U=65499,G=65501,re=65498,Fe=65504,Me=65505,_e=65517,pe=65519,Ne=65534,Je=65535,Be="Exif",$e="http://ns.adobe.com/xap/1.0/\0",Y="http://ns.adobe.com/xmp/extension/\0",xe="Photoshop 3.0";function Ee(e,t){var n=Be.length;return e.getUint16(t)===Me&&v(e,t+B,n)===Be&&e.getUint8(t+B+n)===0}function He(e,t){return e.getUint16(t)===Me&&(function(n,a){var s=$e.length;return v(n,a+B,s)===$e})(e,t)}function De(e,t){return e.getUint16(t)===Me&&(function(n,a){var s=Y.length;return v(n,a+B,s)===Y})(e,t)}function Ge(e,t){return{dataOffset:e+Q,length:t-(Q-H)}}function Ye(e,t){return{dataOffset:e+ve,length:t-(ve-H)}}function te(e,t){var n=xe.length;return e.getUint16(t)===_e&&v(e,t+B,n)===xe&&e.getUint8(t+B+n)===0}function fe(e,t){var n=e.getUint16(t);return n>=Fe&&n<=pe||n===Ne||n===de||n===ge||n===ye||n===U||n===G||n===re}function we(e,t){return e.getUint16(t)===Je}var se=`PNG\r

`,Le=4,Te=4,X=0,Se=Le,ae=Le+Te,rt="XML:com.adobe.xmp\0",Ke="tEXt",qe="iTXt",at="zTXt",lt="pHYs",qt="tIME",Wt="eXIf";function fn(e,t){return v(e,t+Se,Te)===qe&&v(e,t+ae,rt.length)===rt}function hn(e,t,n){var a=v(e,t+Se,Te);return a===Ke||a===qe||a===at&&n}function ze(e,t){return v(e,t+Se,Te)===Wt}function Pe(e,t){var n=[lt,qt],a=v(e,t+Se,Te);return n.includes(a)}function Nn(e,t){t+=ae+rt.length+1+1;for(var n=0;n<2&&t<e.byteLength;)e.getUint8(t)===0&&n++,t++;if(!(n<2))return t}function $n(e,t,n,a,s,u,l,c){if(c===void 0)return[];for(var d=[],g=n.items,b=0;b<c;b++){var y={extents:[]};y.itemId=et(e,g,t),g+=a.item.itemId,y.constructionMethod=t===1||t===2?15&e.getUint16(g):void 0,g+=a.item.constructionMethod,y.dataReferenceIndex=e.getUint16(g),g+=a.item.dataReferenceIndex,y.baseOffset=yt(e,g,a.item.baseOffset),g+=a.item.baseOffset,y.extentCount=e.getUint16(g),g+=a.item.extentCount;for(var E=0;E<y.extentCount;E++){var x={};x.extentIndex=We(e,t,g,l),g+=a.item.extent.extentIndex,x.extentOffset=yt(e,g,s),g+=a.item.extent.extentOffset,x.extentLength=yt(e,g,u),g+=a.item.extent.extentLength,y.extents.push(x)}d.push(y)}return d}function et(e,t,n){return n<2?e.getUint16(t):n===2?e.getUint32(t):void 0}function We(e,t,n,a){if((t===1||t===2)&&a>0)return yt(e,n,a)}function yt(e,t,n){return n===4?e.getUint32(t):n===8?(console.warn("This file uses an 8-bit offset which is currently not supported by ExifReader. Contact the maintainer to get it fixed."),(function(a,s){return a.getUint32(s+4)})(e,t)):0}var xt=1165519206,dt=1835625829;function ot(e,t){var n=(function(c,d){var g=c.getUint32(d);return(function(b){return b===0})(g)?{length:c.byteLength-d,contentOffset:d+4+4}:(function(b){return b===1})(g)&&(function(b,y){return b.getUint32(y+8)===0})(c,d)?{length:c.getUint32(d+12),contentOffset:d+4+4+8}:{length:g,contentOffset:d+4+4}})(e,t),a=n.length,s=n.contentOffset;if(!(a<8)){var u=e.getUint32(t+4);if(u===1718909296)return(function(c,d,g){return{type:"ftyp",majorBrand:v(c,d,4),length:g}})(e,s,a);if(u===1768977008)return(function(c,d,g,b){return{type:"iprp",subBoxes:wt(c,g,b-(g-d)),length:b}})(e,t,s,a);if(u===1768973167)return(function(c,d,g,b){return{type:"ipco",properties:wt(c,g,b-(g-d)),length:b}})(e,t,s,a);if(u===1668246642)return(function(c,d,g){return{type:"colr",icc:pn(c,d),length:g}})(e,s,a);var l=e.getUint8(s);return u===1835365473?(function(c,d,g,b){return{type:"meta",subBoxes:wt(c,g+3,b-(g+3-d)),length:b}})(e,t,s+1,a):u===1768714083?(function(c,d,g,b){var y=(function(oe,ue){var ke={item:{dataReferenceIndex:2,extentCount:2,extent:{}}};oe<2?(ke.itemCount=2,ke.item.itemId=2):oe===2&&(ke.itemCount=4,ke.item.itemId=4),ke.item.constructionMethod=oe===1||oe===2?2:0;var Ce={offsetSize:ue,lengthSize:ue,baseOffsetSize:ue+1,indexSize:ue+1};return Ce.itemCount=ue+2,Ce.items=Ce.itemCount+ke.itemCount,Ce.item={itemId:0},Ce.item.constructionMethod=Ce.item.itemId+ke.item.itemId,Ce.item.dataReferenceIndex=Ce.item.constructionMethod+ke.item.constructionMethod,{offsets:Ce,sizes:ke}})(d,g+3),E=y.offsets,x=y.sizes,_=c.getUint8(E.offsetSize)>>4;x.item.extent.extentOffset=_;var I=15&c.getUint8(E.lengthSize);x.item.extent.extentLength=I;var W=c.getUint8(E.baseOffsetSize)>>4;x.item.baseOffset=W;var V=(function(oe,ue,ke){if(ke===1||ke===2)return 15&oe.getUint8(ue)})(c,E.indexSize,d);x.item.extent.extentIndex=V!==void 0?V:0;var me=(function(oe,ue,ke){return ke<2?oe.getUint16(ue):ke===2?oe.getUint32(ue):void 0})(c,E.itemCount,d);return{type:"iloc",items:$n(c,d,E,x,_,I,V,me),length:b}})(e,l,s+1,a):u===1768517222?(function(c,d,g,b,y){var E=(function(_,I){var W={entryCount:I+3},V={};return V.entryCount=_===0?2:4,W.itemInfos=W.entryCount+V.entryCount,{offsets:W}})(g,b),x=E.offsets;return{type:"iinf",itemInfos:wt(c,x.itemInfos,y-(x.itemInfos-d)),length:y}})(e,t,l,s+1,a):u===1768842853?(function(c,d,g,b,y){b+=3;var E={type:"infe",length:y};return g!==0&&g!==1||(E.itemId=c.getUint16(b),b+=2,E.itemProtectionIndex=c.getUint16(b),b+=2,E.itemName=C(c,b),b+=E.itemName.length+1),g>=2&&(g===2?(E.itemId=c.getUint16(b),b+=2):g===3&&(E.itemId=c.getUint32(b),b+=4),E.itemProtectionIndex=c.getUint16(b),b+=2,E.itemType=c.getUint32(b),b+=4,E.itemName=C(c,b),b+=E.itemName.length+1,E.itemType===dt?(E.contentType=C(c,b),d+y>(b+=E.contentType.length+1)&&(E.contentEncoding=C(c,b),b+=E.contentEncoding.length+1)):E.itemType===1970432288&&(E.itemUri=C(c,b),b+=E.itemUri.length+1)),E})(e,t,l,s+1,a):{type:void 0,length:a}}}function ft(e,t){return e.subBoxes.find(function(n){return n.type==="iloc"}).items.find(function(n){return n.itemId===t})}function pn(e,t){var n=v(e,t,4);if(n==="prof"||n==="rICC")return{offset:t+4,length:e.getUint32(t+4),chunkNumber:1,chunksTotal:1}}function wt(e,t,n){for(var a=[xt,dt],s=[],u=t;u<t+n;){var l=ot(e,u);if(l===void 0)break;l.type===void 0||l.itemType!==void 0&&a.indexOf(l.itemType)===-1||s.push(l),u+=l.length}return s}var Vt=0,zt="<?xpacket begin",Gt={parseAppMarkers:function(e,t){if((function(n){return!!n&&n.byteLength>=N&&n.getUint16(0)===P})(e))return kt((function(n){for(var a,s,u,l,c=j;c+B+5<=n.byteLength;){if(Ee(n,c))a=n.getUint16(c+H),s=c+he;else if(He(n,c))l||(l=[]),a=n.getUint16(c+H),l.push(Ge(c,a));else if(De(n,c))l||(l=[]),a=n.getUint16(c+H),l.push(Ye(c,a));else if(te(n,c))a=n.getUint16(c+H),u=c+F;else{if(!fe(n,c)){if(we(n,c)){c++;continue}break}a=n.getUint16(c+H)}c+=H+a}return{hasAppMarkers:c>j,fileDataOffset:void 0,jfifDataOffset:void 0,tiffHeaderOffset:s,iptcDataOffset:u,xmpChunks:l,iccChunks:void 0,mpfDataOffset:void 0}})(e),"jpeg","JPEG");if((function(n){return!!n&&v(n,0,se.length)===se})(e))return kt((function(n,a){for(var s={hasAppMarkers:0},u=se.length;u+Le+Te<=n.byteLength;){if(fn(n,u)){var l=Nn(n,u);l!==void 0&&(s.hasAppMarkers=1,s.xmpChunks=[{dataOffset:l,length:n.getUint32(u+X)-(l-(u+ae))}])}else if(hn(n,u,a)){s.hasAppMarkers=1;var c=v(n,u+Se,Te);s.pngTextChunks||(s.pngTextChunks=[]),s.pngTextChunks.push({length:n.getUint32(u+X),type:c,offset:u+ae})}else ze(n,u)?(s.hasAppMarkers=1,s.tiffHeaderOffset=u+ae):Pe(n,u)&&(s.hasAppMarkers=1,s.pngChunkOffsets||(s.pngChunkOffsets=[]),s.pngChunkOffsets.push(u+X));u+=n.getUint32(u+X)+Le+Te+4}return s})(e,t),"png","PNG");if((function(n){if(!n)return 0;try{var a=ot(n,0);return a&&["heic","heix","hevc","hevx","heim","heis","hevm","hevs","mif1"].indexOf(a.majorBrand)!==-1}catch{return 0}})(e))return kt((function(n){return(function(a){var s={},u=(function(l){for(var c=0;c+4+4<=l.byteLength;){var d=ot(l,c);if(d===void 0)break;if(d.type==="meta")return d;c+=d.length}})(a);return u?(s.tiffHeaderOffset=(function(l,c){try{var d=(function(b){return b.subBoxes.find(function(y){return y.type==="iinf"}).itemInfos.find(function(y){return y.itemType===xt})})(c).itemId,g=ft(c,d);return(function(b,y){return y+4+b.getUint32(y)})(l,g.baseOffset+g.extents[0].extentOffset)}catch{return}})(a,u),s.xmpChunks=(function(l){try{var c=(function(b){return b.subBoxes.find(function(y){return y.type==="iinf"}).itemInfos.find(function(y){return y.itemType===dt&&y.contentType==="application/rdf+xml"})})(l).itemId,d=ft(l,c),g=ft(l,c).extents[0];return[{dataOffset:d.baseOffset+g.extentOffset,length:g.extentLength}]}catch{return}})(u),s.hasAppMarkers=s.tiffHeaderOffset!==void 0||s.xmpChunks!==void 0||s.iccChunks!==void 0,s):{hasAppMarkers:0}})(n)})(e),"heic","HEIC");if((function(n){return!!n&&v(n,0,4)==="RIFF"&&v(n,8,4)==="WEBP"})(e))return kt((function(n){for(var a,s,u,l=12,c=0;l+8<n.byteLength;){var d=v(n,l,4),g=n.getUint32(l+4,1);d==="EXIF"?(c=1,a=v(n,l+8,6)==="Exif\0\0"?l+8+6:l+8):d==="XMP "?(c=1,s=[{dataOffset:l+8,length:g}]):d==="VP8X"&&(c=1,u=l+8),l+=8+(g%2==0?g:g+1)}return{hasAppMarkers:c,tiffHeaderOffset:a,xmpChunks:s,iccChunks:void 0,vp8xChunkOffset:u}})(e),"webp","WebP");if((function(n){return!!n&&v(n,Vt,zt.length)===zt})(e))return kt((function(n){var a=[];return a.push({dataOffset:Vt,length:n.byteLength}),{xmpChunks:a}})(e),"xml","XML");throw Error("Invalid image format")}};function kt(e,t,n){return w({},e,{fileType:{value:t,description:n}})}var Et=18761,_t=Et,Mt={270:"ImageDescription",700:"ApplicationNotes",33723:"IPTC-NAA",34665:"Exif IFD Pointer"};function ht(e){return ht=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(e)}function Xe(e,t,n){return(t=(function(a){var s=(function(u){if(ht(u)!="object"||!u)return u;var l=u[Symbol.toPrimitive];if(l!==void 0){var c=l.call(u,"string");if(ht(c)!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return u+""})(a);return ht(s)=="symbol"?s:s+""})(t))in e?Object.defineProperty(e,t,{value:n,enumerable:1,configurable:1,writable:1}):e[t]=n,e}var Pt=w({},Mt,{}),Yt="exif",Ot="interoperability",Rt="pentax",Oe=Xe(Xe(Xe(Xe(Xe(Xe(Xe(Xe({},"0th",Pt),"1st",Mt),Yt,Pt),"gps",{}),Ot,{}),"mpf",{}),"canon",{}),Rt,{}),mn={1:1,2:1,3:2,4:4,5:8,7:1,9:4,10:8,13:4},pt={BYTE:1,ASCII:2,SHORT:3,LONG:4,RATIONAL:5,UNDEFINED:7,SLONG:9,SRATIONAL:10,IFD:13},D={getAsciiValue:function(e){return e.map(function(t){return String.fromCharCode(t)})},getByteAt:gn,getAsciiAt:function(e,t){return e.getUint8(t)},getShortAt:function(e,t,n){return e.getUint16(t,n===_t)},getLongAt:Ut,getRationalAt:function(e,t,n){return[Ut(e,t,n),Ut(e,t+4,n)]},getUndefinedAt:function(e,t){return gn(e,t)},getSlongAt:Xt,getSrationalAt:function(e,t,n){return[Xt(e,t,n),Xt(e,t+4,n)]},getIfdPointerAt:function(e,t,n){return Ut(e,t,n)},typeSizes:mn,tagTypes:pt,getTypeSize:function(e){if(pt[e]===void 0)throw Error("No such type found.");return mn[pt[e]]}};function gn(e,t){return e.getUint8(t)}function Ut(e,t,n){return e.getUint32(t,n===_t)}function Xt(e,t,n){return e.getInt32(t,n===_t)}var vn={1:D.getByteAt,2:D.getAsciiAt,3:D.getShortAt,4:D.getLongAt,5:D.getRationalAt,7:D.getUndefinedAt,9:D.getSlongAt,10:D.getSrationalAt,13:D.getIfdPointerAt};function Bt(e,t,n,a,s,u){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,c=D.getTypeSize("SHORT"),d={},g=(function(E,x,_){return x+D.getTypeSize("SHORT")<=E.byteLength?D.getShortAt(E,x,_):0})(e,a,s);a+=c;for(var b=0;b<g&&!(a+12>e.byteLength);b++){var y=tt(e,t,n,a,s,u);y!==void 0&&(d[y.name]={id:y.id,value:y.value,description:y.description},l&&(d[y.name].computed=bn(y.tagType,y.value)),(y.name==="MakerNote"||t===Rt&&y.name==="LevelInfo")&&(d[y.name].__offset=y.__offset)),a+=12}return d}function tt(e,t,n,a,s,u){var l,c,d=D.getTypeSize("SHORT"),g=d+D.getTypeSize("SHORT"),b=g+D.getTypeSize("LONG"),y=D.getShortAt(e,a,s),E=D.getShortAt(e,a+d,s),x=D.getLongAt(e,a+g,s);if(D.typeSizes[E]!==void 0&&(u||Oe[t][y]!==void 0)){l=(function(W,V){return D.typeSizes[W]*V<=D.getTypeSize("LONG")})(E,x)?Zt(e,c=a+b,E,x,s):(function(W,V,me,oe,ue){return V+me+D.typeSizes[oe]*ue<=W.byteLength})(e,n,c=D.getLongAt(e,a+b,s),E,x)?Zt(e,n+c,E,x,s,y===33723):"<faulty value>",E===D.tagTypes.ASCII&&(l=(function(W){try{return W.map(function(V){return decodeURIComponent(escape(V))})}catch{return W}})(l=(function(W){for(var V=[],me=0,oe=0;oe<W.length;oe++)W[oe]!=="\0"?(V[me]===void 0&&(V[me]=""),V[me]+=W[oe]):me++;return V})(l)));var _="undefined-".concat(y),I=l;if(Oe[t][y]!==void 0)if(Oe[t][y].name!==void 0&&Oe[t][y].description!==void 0){_=Oe[t][y].name;try{I=Oe[t][y].description(l)}catch{I=Qt(l)}}else E===D.tagTypes.RATIONAL||E===D.tagTypes.SRATIONAL?(_=Oe[t][y],I=""+l[0]/l[1]):(_=Oe[t][y],I=Qt(l));return{id:y,name:_,value:l,description:I,tagType:E,__offset:c}}}function Zt(e,t,n,a,s){var u=[];arguments.length>5&&arguments[5]!==void 0&&arguments[5]&&(a*=D.typeSizes[n],n=D.tagTypes.BYTE);for(var l=0;l<a;l++)u.push(vn[n](e,t,s)),t+=D.typeSizes[n];return n===D.tagTypes.ASCII?u=D.getAsciiValue(u):u.length===1&&(u=u[0]),u}function Qt(e){return e instanceof Array?e.join(", "):e}function bn(e,t){return e===D.tagTypes.ASCII?Array.isArray(t)&&t.length===1?t[0]:t:e===D.tagTypes.RATIONAL||e===D.tagTypes.SRATIONAL?(function(n){return Array.isArray(n)&&n.length===2?typeof n[0]=="number"&&typeof n[1]=="number":0})(t)?Jt(t):Array.isArray(t)?t.map(function(n){return Jt(n)}):t:t}function Jt(e){if(!Array.isArray(e)||e.length!==2)return e;var t=e[0],n=e[1];return Number.isFinite(t)&&Number.isFinite(n)?n===0?null:t/n:e}var en="Exif IFD Pointer",yn="GPS Info IFD Pointer",xn="Interoperability IFD Pointer",wn={read:function(e,t,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=(function(l,c){if(l.getUint16(c)===Et)return Et;if(l.getUint16(c)===19789)return 19789;throw Error("Illegal byte order value. Faulty image.")})(e,t),u=(function(l,c,d,g,b){return Bt(l,"0th",c,(function(y,E,x){return E+D.getLongAt(y,E+4,x)})(l,c,d),d,g,b)})(e,t,s,n,a);return{tags:u=Hn(u=Dt(u=kn(u,e,t,s,n,a),e,t,s,n,a),e,t,s,n,a),byteOrder:s}}};function kn(e,t,n,a,s,u){return e[en]!==void 0?w(e,Bt(t,Yt,n,n+e[en].value,a,s,u)):e}function Dt(e,t,n,a,s,u){return e[yn]!==void 0?w(e,Bt(t,"gps",n,n+e[yn].value,a,s,u)):e}function Hn(e,t,n,a,s,u){return e[xn]!==void 0?w(e,Bt(t,Ot,n,n+e[xn].value,a,s,u)):e}var nt={iptc:{632:"Caption/Abstract"}},En=function(e,t){var n=(function(){if(typeof TextDecoder<"u")return TextDecoder})();if(typeof n<"u"&&e!==void 0)try{return new n(e).decode(t instanceof DataView?t.buffer:Uint8Array.from(t))}catch{}return(function(a){try{return decodeURIComponent(escape(a))}catch{return a}})(t.map(function(a){return String.fromCharCode(a)}).join(""))},tn={read:function(e,t,n){try{if(Array.isArray(e))return k(new DataView(Uint8Array.from(e).buffer),{size:e.length},0,n);var a=(function(s,u){for(;u+12<=s.byteLength;){var l=An(s,u);if(Sn(l))return{naaBlock:l,dataOffset:u+l.headerSize};u+=l.headerSize+l.size+p(l)}throw Error("No IPTC NAA resource block.")})(e,t);return k(e,a.naaBlock,a.dataOffset,n)}catch{return{}}}};function An(e,t){if(e.getUint32(t,0)!==943868237)throw Error("Not an IPTC resource block.");var n=e.getUint8(t+4+2),a=(n%2==0?n+1:n)+1;return{headerSize:6+a+4,type:e.getUint16(t+4),size:e.getUint32(t+4+2+a)}}function Sn(e){return e.type===1028}function p(e){return e.size%2!=0?1:0}function k(e,t,n,a){for(var s={},u=void 0,l=n+t.size;n<l&&n<e.byteLength;){var c=M(e,n,s,u,a),d=c.tag,g=c.tagSize;if(d===null)break;d&&("encoding"in d&&(u=d.encoding),s[d.name]===void 0||d.repeatable===void 0?s[d.name]={id:d.id,value:d.value,description:d.description}:(s[d.name]instanceof Array||(s[d.name]=[{id:s[d.name].id,value:s[d.name].value,description:s[d.name].description}]),s[d.name].push({id:d.id,value:d.value,description:d.description}))),n+=5+g}return s}function M(e,t,n,a,s){if((function(g,b){return g.getUint8(b)!==28})(e,t))return{tag:null,tagSize:0};var u=e.getUint16(t+1),l=e.getUint16(t+3);if(!s&&!nt.iptc[u])return{tag:void 0,tagSize:l};var c=(function(g,b,y){for(var E=[],x=0;x<y;x++)E.push(g.getUint8(b+x));return E})(e,t+5,l),d={id:u,name:T(nt.iptc[u],u,c),value:c,description:K(nt.iptc[u],c,n,a)};return(function(g){return nt.iptc[g]&&nt.iptc[g].repeatable})(u)&&(d.repeatable=1),(function(g){return nt.iptc[g]&&nt.iptc[g].encoding_name!==void 0})(u)&&(d.encoding=nt.iptc[u].encoding_name(c)),{tag:d,tagSize:l}}function T(e,t,n){return e?(function(a){return typeof a=="string"})(e)?e:(function(a){return typeof a.name=="function"})(e)?e.name(n):e.name:"undefined-".concat(t)}function K(e,t,n,a){if((function(s){return s&&s.description!==void 0})(e))try{return e.description(t,n)}catch{}return(function(s,u){return s&&u instanceof Array})(e,t)?En(a,t):t}var q=function(e){return Math.pow(Math.sqrt(2),e[0]/e[1]).toFixed(2)},$=function(e){return"f/".concat(Number(e[0]/e[1]).toFixed(1))},J=function(e){return e[0]/e[1]+" mm"},Z=function(e){var t=Math.pow(2,e[0]/e[1]);return t<=1?"".concat(Math.round(1/t)):"1/".concat(Math.round(t))},Ze=function(e){return""+Math.round(e[0]/e[1])},be=function(e){return""+Math.round(e[0]/e[1])};function je(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var Re={"tiff:Orientation":function(e){return e==="1"?"Horizontal (normal)":e==="2"?"Mirror horizontal":e==="3"?"Rotate 180":e==="4"?"Mirror vertical":e==="5"?"Mirror horizontal and rotate 270 CW":e==="6"?"Rotate 90 CW":e==="7"?"Mirror horizontal and rotate 90 CW":e==="8"?"Rotate 270 CW":e},"tiff:ResolutionUnit":function(e){return(function(t){return t===2?"inches":t===3?"centimeters":"Unknown"})(parseInt(e,10))},"tiff:XResolution":function(e){return st(Ze,e)},"tiff:YResolution":function(e){return st(be,e)},"exif:ApertureValue":function(e){return st(q,e)},"exif:GPSLatitude":Cn,"exif:GPSLongitude":Cn,"exif:FNumber":function(e){return st($,e)},"exif:FocalLength":function(e){return st(J,e)},"exif:FocalPlaneResolutionUnit":function(e){return(function(t){return t===2?"inches":t===3?"centimeters":t===4?"millimeters":"Unknown"})(parseInt(e,10))},"exif:ColorSpace":function(e){return(function(t){return t===1?"sRGB":t===65535?"Uncalibrated":"Unknown"})((function(t){return t.substring(0,2)==="0x"?parseInt(t.substring(2),16):parseInt(t,10)})(e))},"exif:ComponentsConfiguration":function(e,t){return/^\d, \d, \d, \d$/.test(t)?(function(n){return n.map(function(a){return a===49?"Y":a===50?"Cb":a===51?"Cr":a===52?"R":a===53?"G":a===54?"B":void 0}).join("")})(t.split(", ").map(function(n){return n.charCodeAt(0)})):t},"exif:Contrast":function(e){return(function(t){return t===0?"Normal":t===1?"Soft":t===2?"Hard":"Unknown"})(parseInt(e,10))},"exif:CustomRendered":function(e){return(function(t){return t===0?"Normal process":t===1?"Custom process":"Unknown"})(parseInt(e,10))},"exif:ExposureMode":function(e){return(function(t){return t===0?"Auto exposure":t===1?"Manual exposure":t===2?"Auto bracket":"Unknown"})(parseInt(e,10))},"exif:ExposureProgram":function(e){return(function(t){return t===0?"Undefined":t===1?"Manual":t===2?"Normal program":t===3?"Aperture priority":t===4?"Shutter priority":t===5?"Creative program":t===6?"Action program":t===7?"Portrait mode":t===8?"Landscape mode":t===9?"Bulb":"Unknown"})(parseInt(e,10))},"exif:ExposureTime":function(e){return Ve(e)?(function(t){if(t[0]/t[1]>.25){var n=t[0]/t[1];return Number.isInteger(n)?""+n:n.toFixed(1)}return t[0]!==0?"1/".concat(Math.round(t[1]/t[0])):"0/".concat(t[1])})(e.split("/").map(function(t){return parseInt(t,10)})):e},"exif:MeteringMode":function(e){return(function(t){return t===1?"Average":t===2?"CenterWeightedAverage":t===3?"Spot":t===4?"MultiSpot":t===5?"Pattern":t===6?"Partial":t===255?"Other":"Unknown"})(parseInt(e,10))},"exif:Saturation":function(e){return(function(t){return t===0?"Normal":t===1?"Low saturation":t===2?"High saturation":"Unknown"})(parseInt(e,10))},"exif:SceneCaptureType":function(e){return(function(t){return t===0?"Standard":t===1?"Landscape":t===2?"Portrait":t===3?"Night scene":"Unknown"})(parseInt(e,10))},"exif:Sharpness":function(e){return(function(t){return t===0?"Normal":t===1?"Soft":t===2?"Hard":"Unknown"})(parseInt(e,10))},"exif:ShutterSpeedValue":function(e){return st(Z,e)},"exif:WhiteBalance":function(e){return(function(t){return t===0?"Auto white balance":t===1?"Manual white balance":"Unknown"})(parseInt(e,10))}};function st(e,t){return Ve(t)?e(t.split("/")):t}function Ve(e){return/^-?\d+\/-?\d+$/.test(e)}function Cn(e){var t,n=(function(d){if(Array.isArray(d))return d})(t=e.split(","))||(function(d){var g=d==null?null:typeof Symbol<"u"&&d[Symbol.iterator]||d["@@iterator"];if(g!=null){var b,y,E,x,_=[],I=1,W=0;try{for(E=(g=g.call(d)).next,!1;!(I=(b=E.call(g)).done)&&(_.push(b.value),_.length!==2);I=1);}catch(V){W=1,y=V}finally{try{if(!I&&g.return!=null&&(x=g.return(),Object(x)!==x))return}finally{if(W)throw y}}return _}})(t)||(function(d){if(d){if(typeof d=="string")return je(d,2);var g={}.toString.call(d).slice(8,-1);return g==="Object"&&d.constructor&&(g=d.constructor.name),g==="Map"||g==="Set"?Array.from(d):g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g)?je(d,2):void 0}})(t)||(function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})(),a=n[0],s=n[1];if(a!==void 0&&s!==void 0){var u=parseFloat(a),l=parseFloat(s),c=s.charAt(s.length-1);if(!Number.isNaN(u)&&!Number.isNaN(l))return""+(u+l/60)+c}return e}var Kn={xmp:"http://ns.adobe.com/xap/1.0/",tiff:"http://ns.adobe.com/tiff/1.0/",exif:"http://ns.adobe.com/exif/1.0/",dc:"http://purl.org/dc/elements/1.1/",xmpMM:"http://ns.adobe.com/xap/1.0/mm/",stEvt:"http://ns.adobe.com/xap/1.0/sType/ResourceEvent#",stRef:"http://ns.adobe.com/xap/1.0/sType/ResourceRef#",photoshop:"http://ns.adobe.com/photoshop/1.0/"};function At(e){return At=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(e)}function Fn(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function St(e){var t=typeof Map=="function"?new Map:void 0;return St=function(n){if(n===null||!(function(s){try{return Function.toString.call(s).indexOf("[native code]")!==-1}catch{return typeof s=="function"}})(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(n))return t.get(n);t.set(n,a)}function a(){return(function(s,u,l){if(qn())return Reflect.construct.apply(null,arguments);var c=[null];c.push.apply(c,u);var d=new(s.bind.apply(s,c));return l&&nn(d,l.prototype),d})(n,arguments,rn(this).constructor)}return a.prototype=Object.create(n.prototype,{constructor:{value:a,enumerable:0,writable:1,configurable:1}}),nn(a,n)},St(e)}function qn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qn=function(){return!!e})()}function nn(e,t){return nn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},nn(e,t)}function rn(e){return rn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rn(e)}var Er={read:function(e,t,n){var a={};if(typeof e=="string")return Ln(a,e,n),a;var s,u=(s=(function(b,y){if(y.length===0)return[];var E=[Wn(b,y.slice(0,1))];return y.length>1&&E.push(Wn(b,y.slice(1))),E})(e,t),(function(b){if(Array.isArray(b))return b})(s)||(function(b){var y=b==null?null:typeof Symbol<"u"&&b[Symbol.iterator]||b["@@iterator"];if(y!=null){var E,x,_,I,W=[],V=1,me=0;try{for(_=(y=y.call(b)).next,!1;!(V=(E=_.call(y)).done)&&(W.push(E.value),W.length!==2);V=1);}catch(oe){me=1,x=oe}finally{try{if(!V&&y.return!=null&&(I=y.return(),Object(I)!==I))return}finally{if(me)throw x}}return W}})(s)||(function(b){if(b){if(typeof b=="string")return Fn(b,2);var y={}.toString.call(b).slice(8,-1);return y==="Object"&&b.constructor&&(y=b.constructor.name),y==="Map"||y==="Set"?Array.from(b):y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(y)?Fn(b,2):void 0}})(s)||(function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()),l=u[0],c=u[1],d=Ln(a,l,n);if(c){var g=Ln(a,c,n);d||g||(delete a._raw,Ln(a,Wn(e,t),n))}return a}},Ar=(function(e){function t(a){var s;return(function(u,l){if(!(u instanceof l))throw new TypeError("Cannot call a class as a function")})(this,t),(s=(function(u,l,c){return l=rn(l),(function(d,g){if(g&&(At(g)=="object"||typeof g=="function"))return g;if(g!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b})(d)})(u,qn()?Reflect.construct(l,c||[],rn(u).constructor):l.apply(u,c))})(this,t,[a])).name="ParseError",s}return(function(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(s&&s.prototype,{constructor:{value:a,writable:1,configurable:1}}),Object.defineProperty(a,"prototype",{writable:0}),s&&nn(a,s)})(t,e),Object.defineProperty(n=t,"prototype",{writable:0}),n;var n})(St(Error));function Wn(e,t){for(var n=t.reduce(function(d,g){return d+g.length},0),a=new Uint8Array(n),s=0,u=0;u<t.length;u++){var l=t[u],c=e.buffer.slice(l.dataOffset,l.dataOffset+l.length);a.set(new Uint8Array(c),s),s+=l.length}return new DataView(a.buffer)}function Ln(e,t,n){try{var a=(function(l,c){var d=(function(b){if(b)return b;if(typeof DOMParser<"u")return new DOMParser;try{var y=require("@xmldom/xmldom");return new y.DOMParser({onError:y.onErrorStopParsing})}catch{return}})(c);if(!d)throw console.warn("Warning: DOMParser is not available. It is needed to be able to parse XMP tags."),Error();var g=typeof l=="string"?l:v(l,0,l.byteLength);return{doc:wi(d,g.replace(/^.+(<\?xpacket begin)/,"$1").replace(/(<\?xpacket end=".*"\?>).+$/,"$1")),raw:g}})(t,n),s=a.doc,u=a.raw;return e._raw=(e._raw||"")+u,w(e,Ai(Ei(ki(s),1))),1}catch{return 0}}function wi(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;try{var a=e.parseFromString(t,"application/xml"),s=a.getElementsByTagName("parsererror");if(s.length>0)throw new Ar(s[0].textContent);return a}catch(u){if(u.name==="ParseError"&&(function(l){for(var c=["prefix is non-null and namespace is null","prefix not bound to a namespace","prefix inte bundet till en namnrymd",/Namespace prefix .+ is not defined/],d=0;d<c.length;d++)if(RegExp(c[d]).test(l.message))return 1;return 0})(u)&&!n)return wi(e,(function(l){var c=l.match(/<([A-Za-z_][A-Za-z0-9._-]*)([^>]*)>/);if(!c)return l;var d=c[1],g=(function(y){for(var E,x=[],_=/xmlns:([\w-]+)=["'][^"']+["']/g;(E=_.exec(y))!==null;)x.indexOf(E[1])===-1&&x.push(E[1]);return x})(l),b=(function(y){for(var E,x=[],_=/\b([A-Za-z_][A-Za-z0-9._-]*):[A-Za-z_][A-Za-z0-9._-]*\b/g;(E=_.exec(y))!==null;){var I=E[1];I!=="xmlns"&&I!=="xml"&&x.indexOf(I)===-1&&x.push(I)}return x})(l).filter(function(y){return g.indexOf(y)===-1});return b.length===0?l:(function(y,E,x){var _=RegExp("<"+E+"([^>]*)>");return y.replace(_,"<"+E+"$1"+x+">")})(l,d,(function(y){for(var E=[],x=0;x<y.length;x++){var _=y[x],I=Kn[_]||"http://fallback.namespace/"+_;E.push(" xmlns:"+_+'="'+I+'"')}return E.join("")})(b))})(t),1);throw u}}function ki(e){for(var t=0;t<e.childNodes.length;t++){if(e.childNodes[t].tagName==="x:xmpmeta")return ki(e.childNodes[t]);if(e.childNodes[t].tagName==="rdf:RDF")return e.childNodes[t]}throw Error()}function Ei(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=(function(s){for(var u=[],l=0;l<s.childNodes.length;l++)u.push(s.childNodes[l]);return u})(e);return(t=a).length===1&&t[0].nodeName==="#text"?n?{}:(function(s){return s.nodeValue})(a[0]):(function(s){var u={};return s.forEach(function(l){if((function(d){return d.nodeName&&d.nodeName!=="#text"})(l)){var c=(function(d){return{attributes:Sr(d),value:Ei(d)}})(l);u[l.nodeName]!==void 0?(Array.isArray(u[l.nodeName])||(u[l.nodeName]=[u[l.nodeName]]),u[l.nodeName].push(c)):u[l.nodeName]=c}}),u})(a)}function Sr(e){for(var t={},n=0;n<e.attributes.length;n++)t[e.attributes[n].nodeName]=decodeURIComponent(escape(e.attributes[n].value));return t}function Ai(e){var t={};if(typeof e=="string")return e;for(var n in e){var a=e[n];Array.isArray(a)||(a=[a]),a.forEach(function(s){w(t,Vn(s.attributes)),At(s.value)==="object"&&w(t,Si(s.value))})}return t}function Vn(e){var t={};for(var n in e)try{Cr(n)&&(t[In(n)]={value:e[n],attributes:{},description:ut(e[n],n)})}catch{}return t}function Cr(e){return e!=="rdf:parseType"&&!Tn(e)}function Tn(e){return e.split(":")[0]==="xmlns"}function In(e){return/^MicrosoftPhoto(_\d+_)?:Rating$/i.test(e)?"RatingPercent":e.split(":")[1]}function ut(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;if(Array.isArray(e)){var n=(function(a){return a.map(function(s){return s.value!==void 0?ut(s.value):ut(s)}).join(", ")})(e);return t&&typeof Re[t]=="function"?Re[t](e,n):n}if(At(e)==="object")return(function(a){var s=[];for(var u in a)s.push("".concat(Fr(u),": ").concat(ut(a[u].value)));return s.join("; ")})(e);try{return t&&typeof Re[t]=="function"?Re[t](e):decodeURIComponent(escape(e))}catch{return e}}function Fr(e){return e==="CiAdrCity"?"CreatorCity":e==="CiAdrCtry"?"CreatorCountry":e==="CiAdrExtadr"?"CreatorAddress":e==="CiAdrPcode"?"CreatorPostalCode":e==="CiAdrRegion"?"CreatorRegion":e==="CiEmailWork"?"CreatorWorkEmail":e==="CiTelWork"?"CreatorWorkPhone":e==="CiUrlWork"?"CreatorWorkUrl":e}function Si(e){var t={};for(var n in e)try{Tn(n)||(t[In(n)]=Lr(e[n],n))}catch{}return t}function Lr(e,t){return(function(n){return Array.isArray(n)})(e)?(function(n,a){return Gn(n[n.length-1],a)})(e,t):(function(n){return n.attributes["rdf:parseType"]==="Resource"&&typeof n.value=="string"&&n.value.trim()===""})(e)?{value:"",attributes:{},description:""}:Ci(e)?Fi(e,t):Li(e)?Ti(e,t):Ii(e)?zi(e,t):(function(n){return _i(n.value)!==void 0})(e)?(function(n,a){var s=_i(n.value).value["rdf:li"],u=an(n),l=[];return s===void 0?s=[]:Array.isArray(s)||(s=[s]),s.forEach(function(c){l.push((function(d){return Ci(d)?Fi(d):Li(d)?Ti(d).value:Ii(d)?zi(d).value:Gn(d)})(c))}),{value:l,attributes:u,description:ut(l,a)}})(e,t):Gn(e,t)}function Ci(e){return e.attributes["rdf:parseType"]==="Resource"&&e.value["rdf:value"]!==void 0||e.value["rdf:Description"]!==void 0&&e.value["rdf:Description"].value["rdf:value"]!==void 0}function Fi(e,t){var n=an(e);e.value["rdf:Description"]!==void 0&&(e=e.value["rdf:Description"]),w(n,an(e),(function(s){var u={};for(var l in s.value)l==="rdf:value"||Tn(l)||(u[In(l)]=s.value[l].value);return u})(e));var a=(function(s){return Mi(s.value["rdf:value"])||s.value["rdf:value"].value})(e);return{value:a,attributes:n,description:ut(a,t)}}function an(e){var t={};for(var n in e.attributes)n==="rdf:parseType"||n==="rdf:resource"||Tn(n)||(t[In(n)]=e.attributes[n]);return t}function Li(e){return e.attributes["rdf:parseType"]==="Resource"||e.value["rdf:Description"]!==void 0&&e.value["rdf:Description"].value["rdf:value"]===void 0}function Ti(e,t){var n={value:{},attributes:{}};return e.value["rdf:Description"]!==void 0&&(w(n.value,Vn(e.value["rdf:Description"].attributes)),w(n.attributes,an(e)),e=e.value["rdf:Description"]),w(n.value,Si(e.value)),n.description=ut(n.value,t),n}function Ii(e){return Object.keys(e.value).length===0&&e.attributes["xml:lang"]===void 0&&e.attributes["rdf:resource"]===void 0}function zi(e,t){var n=Vn(e.attributes);return{value:n,attributes:{},description:ut(n,t)}}function _i(e){return e["rdf:Bag"]||e["rdf:Seq"]||e["rdf:Alt"]}function Gn(e,t){var n=Mi(e)||Ai(e.value);return{value:n,attributes:an(e),description:ut(n,t)}}function Mi(e){return e.attributes&&e.attributes["rdf:resource"]}function on(e){return on=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},on(e)}var Tr={read:function(e,t,n,a){for(var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,u={},l=[],c=0;c<t.length;c++){var d=t[c],g=Mr(e,d.offset,d.length,d.type,n);if(g instanceof Promise)l.push(g.then(function(x){var _,I,W,V=x.name,me=x.value,oe=x.description;try{if(Ri(V,me))return{__exif:wn.read(Bi(me),_r,a,s).tags};if(Ui(V,me))return{__iptc:tn.read(Bi(me),0,a)};if(V&&!Ri(V,me)&&!Ui(V,me))return _={},W={value:me,description:oe},(I=(function(ue){var ke=(function(Ce){if(on(Ce)!="object"||!Ce)return Ce;var Ft=Ce[Symbol.toPrimitive];if(Ft!==void 0){var Qe=Ft.call(Ce,"string");if(on(Qe)!="object")return Qe;throw new TypeError("@@toPrimitive must return a primitive value.")}return Ce+""})(ue);return on(ke)=="symbol"?ke:ke+""})(I=V))in _?Object.defineProperty(_,I,{value:W,enumerable:1,configurable:1,writable:1}):_[I]=W,_}catch{}return{}}));else{var b=g.name,y=g.value,E=g.description;b&&(u[b]={value:y,description:E})}}return{readTags:u,readTagsPromise:l.length>0?Promise.all(l):void 0}}},Yn="STATE_KEYWORD",Xn="STATE_COMPRESSION",Zn="STATE_LANG",Pi="STATE_TRANSLATED_KEYWORD",Qn="STATE_TEXT",Ir=1,zr=1,_r=6;function Mr(e,t,n,a,s){for(var u,l=[],c=[],d=[],g=Yn,b=z,y=0;y<n&&t+y<e.byteLength;y++)if(g!==Xn){if(g===Qn){u=new DataView(e.buffer.slice(t+y,t+n));break}var E=e.getUint8(t+y);E===0?g=Oi(a,g):g===Yn?l.push(E):g===Zn?c.push(E):g===Pi&&d.push(E)}else b=Pr({type:a,dataView:e,offset:t+y}),a===qe&&(y+=Ir),g=Oi(a,g);if(b!==z&&!s)return{};var x=(function(_,I,W){var V=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"string";if(I===0&&typeof DecompressionStream=="function"){var me=new DecompressionStream("deflate"),oe=new Blob([_]).stream().pipeThrough(me);return V==="dataview"?new Response(oe).arrayBuffer().then(function(ue){return new DataView(ue)}):new Response(oe).arrayBuffer().then(function(ue){return new TextDecoder(W).decode(ue)})}return I!==void 0?Promise.reject("Unknown compression method ".concat(I,".")):_})(u,b,(function(_){return _===Ke||_===at?"latin1":"utf-8"})(a));return x instanceof Promise?x.then(function(_){return Jn(_,a,c,l)}).catch(function(){return Jn("<text using unknown compression>".split(""),a,c,l)}):Jn(x,a,c,l)}function Pr(e){var t=e.type,n=e.dataView,a=e.offset;if(t===qe){if(n.getUint8(a)===zr)return n.getUint8(a+1)}else if(t===at)return n.getUint8(a);return z}function Oi(e,t){return t===Yn&&[qe,at].includes(e)?Xn:t===Xn?e===qe?Zn:Qn:t===Zn?Pi:Qn}function Jn(e,t,n,a){var s=(function(u){return u instanceof DataView?v(u,0,u.byteLength):u})(e);return{name:Or(t,n,a),value:s,description:t===qe?Rr(e):s}}function Or(e,t,n){var a=A(n);if(e===Ke||t.length===0)return a;var s=A(t);return"".concat(a," (").concat(s,")")}function Rr(e){return En("UTF-8",e)}function Ri(e,t){return e.toLowerCase()==="raw profile type exif"&&t.substring(1,5)==="exif"}function Ui(e,t){return e.toLowerCase()==="raw profile type iptc"&&t.substring(1,5)==="iptc"}function Bi(e){return(function(t){for(var n=new DataView(new ArrayBuffer(t.length/2)),a=0;a<t.length;a+=2)n.setUint8(a/2,parseInt(t.substring(a,a+2),16));return n})(e.match(/\n(exif|iptc)\n\s*\d+\n([\s\S]*)$/)[2].replace(/\n/g,""))}var Ur={read:function(e,t){for(var n={},a=0;a<t.length;a++){var s=D.getLongAt(e,t[a]+X),u=v(e,t[a]+Se,Te);u===lt?(n["Pixels Per Unit X"]=Br(e,t[a],s),n["Pixels Per Unit Y"]=Dr(e,t[a],s),n["Pixel Units"]=jr(e,t[a],s)):u===qt&&(n["Modify Date"]=Nr(e,t[a],s))}return n}};function Br(e,t,n){if(zn(e,t,n,0,4)){var a=D.getLongAt(e,t+ae+0);return{value:a,description:""+a}}}function Dr(e,t,n){if(zn(e,t,n,4,4)){var a=D.getLongAt(e,t+ae+4);return{value:a,description:""+a}}}function jr(e,t,n){if(zn(e,t,n,8,1)){var a=D.getByteAt(e,t+ae+8);return{value:a,description:a===1?"meters":"Unknown"}}}function Nr(e,t,n){if(zn(e,t,n,0,7)){var a=D.getShortAt(e,t+ae),s=D.getByteAt(e,t+ae+2),u=D.getByteAt(e,t+ae+3),l=D.getByteAt(e,t+ae+4),c=D.getByteAt(e,t+ae+5),d=D.getByteAt(e,t+ae+6);return{value:[a,s,u,l,c,d],description:"".concat(jt(a,4),"-").concat(jt(s,2),"-").concat(jt(u,2)," ").concat(jt(l,2),":").concat(jt(c,2),":").concat(jt(d,2))}}}function zn(e,t,n,a,s){return a+s<=n&&t+ae+a+s<=e.byteLength}function jt(e,t){return"".concat("0".repeat(t-(""+e).length)).concat(e)}var $r={read:function(e,t){var n={},a=D.getByteAt(e,t);return n.Alpha=(function(s){var u=16&s;return{value:u?1:0,description:u?"Yes":"No"}})(a),n.Animation=(function(s){var u=2&s;return{value:u?1:0,description:u?"Yes":"No"}})(a),n.ImageWidth=Di(e,t+Hr),n.ImageHeight=Di(e,t+Kr),n}},Hr=4,Kr=7;function Di(e,t){var n=D.getByteAt(e,t)+256*D.getByteAt(e,t+1)+65536*D.getByteAt(e,t+2)+1;return{value:n,description:n+"px"}}var qr={get:function(e,t){var n,a={},s=0,u=Ct(e,"exif","FocalLength",t),l=Ct(e,"exif","FocalPlaneXResolution",t),c=Ct(e,"exif","FocalPlaneYResolution",t),d=Ct(e,"exif","FocalPlaneResolutionUnit",t),g=Ct(e,"file","Image Width",t),b=Ct(e,"file","Image Height",t),y=Ct(e,"exif","FocalLengthIn35mmFilm",t)||(function(_,I,W,V,me,oe){if(_&&I&&W&&V&&me&&oe)try{var ue;switch(W){case 2:ue=25.4;break;case 3:ue=10;break;case 4:ue=1;break;default:return}var ke=_[0]/_[1]*ue,Ce=me/(I[0]/I[1]*ue),Ft=Math.sqrt(Math.pow(V/ke,2)+Math.pow(Ce,2));return oe[0]/oe[1]*(43.27/Ft)}catch{}})(l,c,d,g,b,u);y&&(a.FocalLength35efl={value:y,description:(n=y,n===0?"Unknown":n+" mm")},s=1);var E=(function(_,I){if(_&&I)try{var W=I/(_[0]/_[1]);return{value:W,description:W.toFixed(1)}}catch{}})(u,y);E&&(a.ScaleFactorTo35mmEquivalent=E,s=1);var x=(function(_){if(_)try{var I=2*Math.atan(36/(2*_))*(180/Math.PI);return{value:I,description:I.toFixed(1)+" deg"}}catch{}})(y);if(x&&(a.FieldOfView=x,s=1),s)return a}};function Ct(e,t,n,a){return a&&e[t]&&e[t][n]?e[t][n].value:!a&&e[n]?e[n].value:void 0}function ji(e){this.name="MetadataMissingError",this.message=e||"No Exif data",this.stack=Error().stack}ji.prototype=Error();var ei={MetadataMissingError:ji},Wr={load:Ni,loadView:ni,errors:ei},Vr=ei;function Ni(e){var t,n,a,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(function(u){return typeof u=="string"})(e)?(s.async=1,(function(u,l){return/^\w+:\/\//.test(u)?typeof fetch<"u"?(function(c){var d=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).length,g={method:"GET"};return Number.isInteger(d)&&d>=0&&(g.headers={range:"bytes=0-".concat(d-1)}),fetch(c,g).then(function(b){return b.arrayBuffer()})})(u,l):(function(c){var d=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).length;return new Promise(function(g,b){var y={};Number.isInteger(d)&&d>=0&&(y.headers={range:"bytes=0-".concat(d-1)});var E=(function(x){return/^https:\/\//.test(x),hi.get})(c);E(c,y,function(x){if(x.statusCode>=200&&x.statusCode<=299){var _=[];x.on("data",function(I){return _.push(Buffer.from(I))}),x.on("error",function(I){return b(I)}),x.on("end",function(){return g(Buffer.concat(_))})}else b("Could not fetch file: ".concat(x.statusCode," ").concat(x.statusMessage)),x.resume()}).on("error",function(x){return b(x)})})})(u,l):(function(c){return/^data:[^;,]*(;base64)?,/.test(c)})(u)?Promise.resolve((function(c){var d=c.substring(c.indexOf(",")+1);if(c.indexOf(";base64")!==-1)return typeof atob<"u"?Uint8Array.from(atob(d),function(b){return b.charCodeAt(0)}).buffer:typeof Buffer>"u"?void 0:typeof Buffer.from<"u"?Buffer.from(d,"base64"):new Buffer(d,"base64");var g=decodeURIComponent(d);return typeof Buffer<"u"?typeof Buffer.from<"u"?Buffer.from(g):new Buffer(g):Uint8Array.from(g,function(b){return b.charCodeAt(0)}).buffer})(u)):(function(c){var d=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).length;return new Promise(function(g,b){var y=(function(){try{return hi}catch{return}})();y.open(c,function(E,x){E?b(E):y.stat(c,function(_,I){if(_)b(_);else{var W=Math.min(I.size,d!==void 0?d:I.size),V=Buffer.alloc(W),me={buffer:V,length:W};y.read(x,me,function(oe){oe?b(oe):y.close(x,function(ue){ue&&console.warn("Could not close file ".concat(c,":"),ue),g(V)})})}})})})})(u,l)})(e,s).then(function(u){return ti(u,s)})):(function(u){return typeof File<"u"&&u instanceof File})(e)?(s.async=1,(t=e,n=s,a=n.length,new Promise(function(u,l){var c=new FileReader;c.onload=function(d){return u(d.target.result)},c.onerror=function(){return l(c.error)},Number.isInteger(a)&&a>=0&&t.slice!==void 0?c.readAsArrayBuffer(t.slice(0,a)):c.readAsArrayBuffer(t)})).then(function(u){return ti(u,s)})):ti(e,s)}function ti(e,t){return(function(n){try{return Buffer.isBuffer(n)}catch{return 0}})(e)&&(e=new Uint8Array(e).buffer),ni((function(n){try{return new DataView(n)}catch{return new le(n)}})(e),t)}function ni(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{expanded:0,async:0,computed:0,includeUnknown:0,domParser:void 0},n=t.expanded,a=n===void 0?0:n,s=t.async,u=s===void 0?0:s,l=t.computed,c=l===void 0?0:l,d=t.includeUnknown,g=d===void 0?0:d,b=t.domParser,y=b===void 0?void 0:b,E=0,x={},_=[],I=Gt.parseAppMarkers(e,u),W=I.fileType,V=(I.fileDataOffset,I.jfifDataOffset,I.tiffHeaderOffset),me=I.iptcDataOffset,oe=I.xmpChunks,ue=(I.iccChunks,I.mpfDataOffset,I.pngHeaderOffset,I.pngTextChunks),ke=I.pngChunkOffsets,Ce=I.vp8xChunkOffset;if(I.gifHeaderOffset,(function(R){return R!==void 0})(V)){E=1;var Ft=wn.read(e,V,g,c),Qe=Ft.tags;Ft.byteOrder,Qe.Thumbnail&&(x.Thumbnail=Qe.Thumbnail,delete Qe.Thumbnail),a?(x.exif=Qe,(function(R){if(R.exif){if(R.exif.GPSLatitude&&R.exif.GPSLatitudeRef)try{R.gps=R.gps||{},R.gps.Latitude=O(R.exif.GPSLatitude.value),R.exif.GPSLatitudeRef.value.join("")==="S"&&(R.gps.Latitude=-R.gps.Latitude)}catch{}if(R.exif.GPSLongitude&&R.exif.GPSLongitudeRef)try{R.gps=R.gps||{},R.gps.Longitude=O(R.exif.GPSLongitude.value),R.exif.GPSLongitudeRef.value.join("")==="W"&&(R.gps.Longitude=-R.gps.Longitude)}catch{}if(R.exif.GPSAltitude&&R.exif.GPSAltitudeRef)try{R.gps=R.gps||{},R.gps.Altitude=R.exif.GPSAltitude.value[0]/R.exif.GPSAltitude.value[1],R.exif.GPSAltitudeRef.value===1&&(R.gps.Altitude=-R.gps.Altitude)}catch{}}})(x)):x=w({},x,Qe),Qe.MakerNote&&delete Qe.MakerNote.__offset}if((function(R){return R!==void 0})(me)){E=1;var $i=tn.read(e,me,g);a?x.iptc=$i:x=w({},x,$i)}if((function(R){return Array.isArray(R)&&R.length>0})(oe)){E=1;var ii=Er.read(e,oe,y);a?x.xmp=ii:(delete ii._raw,x=w({},x,ii))}if((function(R){return R!==void 0})(ue)){E=1;var Hi=Tr.read(e,ue,u,g,c),Gr=Hi.readTags,Ki=Hi.readTagsPromise;qi(Gr),Ki&&_.push(Ki.then(function(R){return R.forEach(qi)}))}if((function(R){return R!==void 0})(ke)){E=1;var ri=Ur.read(e,ke);a?x.png=x.png?w({},x.png,ri):ri:x=w({},x,ri)}if((function(R){return R!==void 0})(Ce)){E=1;var ai=$r.read(e,Ce);a?x.riff=x.riff?w({},x.riff,ai):ai:x=w({},x,ai)}var oi=qr.get(x,a);if(oi&&(a?x.composite=oi:x=w({},x,oi)),delete x.Thumbnail,W&&(a?(x.file||(x.file={}),x.file.FileType=W):x.FileType=W,E=1),!E)throw new ei.MetadataMissingError;return u?Promise.all(_).then(function(){return x}):x;function qi(R){if(a){for(var Nt=0,Wi=["exif","iptc"];Nt<Wi.length;Nt++){var si=Wi[Nt],_n="__".concat(si);R[_n]&&(x[si]=x[si]?w({},x.exif,R[_n]):R[_n],delete R[_n])}x.png=x.png?w({},x.png,R):R,x.pngText=x.pngText?w({},x.png,R):R}else delete(x=w({},x,R.__exif?R.__exif:{},R.__iptc?R.__iptc:{},R)).__exif,delete x.__iptc}}return m})()})})(ln,ln.exports)),ln.exports}var lo=co();const fo=ea(lo),ho=["Caption/Abstract","Description","ImageDescription"];async function po(h){if(!h||!h.type?.startsWith?.("image/"))return null;try{const o=await fo.load(h);for(const f of ho)if(o[f]?.description)return o[f].description.trim();return null}catch{return null}}const mo={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Phanpy",PHANPY_PRIVACY_POLICY_URL:"https://github.com/cheeaun/phanpy/blob/main/PRIVACY.MD",PHANPY_TRANSLANG_INSTANCES:"translang.phanpy.social",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_IMG_ALT_API_URL:pi}=mo;function ur(h,o,f,m){const v=Math.sqrt(o/h),C=Math.floor(f*v),A=Math.floor(m*v);return{newWidth:C,newHeight:A}}function go({attachment:h,disabled:o,lang:f,supportedMimeTypes:m,descriptionLimit:v=1500,onDescriptionChange:C=()=>{},onRemove:A=()=>{}}){const{i18n:w,_:z}=bt(),[S,L]=ie("default"),le=Ht("@mastodon")||Ht("@gotosocial/edit-media-attributes"),{type:O,id:N,file:P}=h,j=Kt(()=>P?URL.createObjectURL(P):h.url,[P,h.url]),B=!!P?.size,H=B?mr():{},{mediaAttachments:{imageSizeLimit:he,imageMatrixLimit:F,videoSizeLimit:Q,videoMatrixLimit:ve,videoFrameRateLimit:de}={}}=H||{},[ge,ye]=ie(()=>B?O.startsWith("image")&&he&&P.size>he?{type:"imageSizeLimit",details:{imageSize:P.size,imageSizeLimit:he}}:O.startsWith("video")&&Q&&P.size>Q?{type:"videoSizeLimit",details:{videoSize:P.size,videoSizeLimit:Q}}:null:null),[U,G]=ie({});Ae(()=>{!B||!F||U?.matrix>F&&ye({type:"imageMatrixLimit",details:{imageMatrix:U?.matrix,imageMatrixLimit:F,width:U?.width,height:U?.height}})},[U,F,B]);const[re,Fe]=ie({});Ae(()=>{!B||!ve||re?.matrix>ve&&ye({type:"videoMatrixLimit",details:{videoMatrix:re?.matrix,videoMatrixLimit:ve,width:re?.width,height:re?.height}})},[re,ve,B]);const[Me,_e]=ie(h.description);Ae(()=>{if(!P||!O.startsWith("image/")||N||h.description)return;let te=!1;return(async()=>{L("loading");try{const fe=await po(P);!te&&fe&&_e(fe)}catch{}finally{te||L("default")}})(),()=>{te=!0}},[]);let[pe,Ne]=O.split("/");const Je=new Set,Be={};m?.length&&m.forEach(te=>{const[fe,we]=te.split("/");Be[we]=fe,Je.add(fe)}),Ne&&!Je.has(pe)&&Be[Ne]&&(pe=Be[Ne]);const $e=jn(C,250);Ae(()=>{$e(Me)},[Me,$e]);const[Y,xe]=ie(!1),Ee=ce(null);Ae(()=>{let te;return Y&&Ee.current&&(te=setTimeout(()=>{Ee.current.focus()},100)),()=>{clearTimeout(te)}},[Y]);const He=r(It,{children:N&&!le?r("div",{class:"media-desc",children:[r("span",{class:"tag",children:r(ne,{id:"3wG7HI"})}),r("p",{title:Me,children:h.description||r("i",{children:"No description"})})]}):r("textarea",{ref:Ee,value:Me||"",lang:f,placeholder:{image:z({id:"Lh8B0N"}),video:z({id:"mN4S+e"}),gifv:z({id:"mN4S+e"}),audio:z({id:"ieZytw"})}[pe],autoCapitalize:"sentences",autoComplete:"on",autoCorrect:"on",spellCheck:"true",dir:"auto",disabled:o||S==="loading",class:S==="loading"?"loading":"",maxlength:v,onInput:te=>{const{value:fe}=te.target;_e(fe)}})}),De=ce(null);Ae(()=>()=>{De.current?.hideToast?.()},[]);const Ge=ce(null),Ye=te=>{const{type:fe,details:we}=te;switch(fe){case"imageSizeLimit":{const{imageSize:se,imageSizeLimit:Le}=we;return z({id:"d83/LB",values:{0:Pn(se),1:Pn(Le)}})}case"imageMatrixLimit":{const{imageMatrix:se,imageMatrixLimit:Le,width:Te,height:X}=we,{newWidth:Se,newHeight:ae}=ur(se,Le,Te,X);return z({id:"DuvOX/",values:{0:w.number(Te),1:w.number(X),2:w.number(Se),3:w.number(ae)}})}case"videoSizeLimit":{const{videoSize:se,videoSizeLimit:Le}=we;return z({id:"d83/LB",values:{0:Pn(se),1:Pn(Le)}})}case"videoMatrixLimit":{const{videoMatrix:se,videoMatrixLimit:Le,width:Te,height:X}=we,{newWidth:Se,newHeight:ae}=ur(se,Le,Te,X);return z({id:"DuvOX/",values:{0:w.number(Te),1:w.number(X),2:w.number(Se),3:w.number(ae)}})}case"videoFrameRateLimit":return z({id:"S1fBwy"})}};return r(It,{children:[r("div",{class:"media-attachment",children:[r("div",{class:"media-preview",tabIndex:"0",onClick:()=>{xe(!0)},children:pe==="image"?r("img",{src:j,alt:"",onLoad:te=>{if(!B)return;const{naturalWidth:fe,naturalHeight:we}=te.target;G({matrix:fe*we,width:fe,height:we})}}):pe==="video"||pe==="gifv"?r("video",{src:j+"#t=0.1",playsinline:!0,muted:!0,disablePictureInPicture:!0,preload:"metadata",onLoadedMetadata:te=>{if(!B)return;const{videoWidth:fe,videoHeight:we}=te.target;fe&&we&&Fe({matrix:fe*we,width:fe,height:we})}}):pe==="audio"?r("audio",{src:j,controls:!0}):null}),He,r("div",{class:"media-aside",children:[r("button",{type:"button",class:"plain close-button",disabled:o,onClick:A,children:r(ee,{icon:"x",alt:z({id:"t/YqKh"})})}),!!ge&&r("button",{type:"button",class:"media-error",title:Ye(ge),onClick:()=>{Ge.current&&Ge.current.hideToast(),Ge.current=gt({text:Ye(ge),duration:1e4})},children:r(ee,{icon:"alert",alt:z({id:"SlfejT"})})})]})]}),Y&&r(Rn,{onClose:()=>{xe(!1)},children:r("div",{id:"media-sheet",class:"sheet sheet-max",children:[r("button",{type:"button",class:"sheet-close",onClick:()=>{xe(!1)},children:r(ee,{icon:"x",alt:z({id:"yz7wBu"})})}),r("header",{children:r("h2",{children:{image:z({id:"oMslIB"}),video:z({id:"WZw+zB"}),gifv:z({id:"WZw+zB"}),audio:z({id:"KMtgtM"})}[pe]})}),r("main",{tabIndex:"-1",children:[r("div",{class:"media-preview",children:pe==="image"?r("img",{src:j,alt:""}):pe==="video"||pe==="gifv"?r("video",{src:j,playsinline:!0,controls:!0}):pe==="audio"?r("audio",{src:j,controls:!0}):null}),r("div",{class:"media-form",children:[He,r("footer",{children:[pe==="image"&&/^(png|jpe?g|gif|webp)$/i.test(Ne)&&!!Ie.settings.mediaAltGenerator&&!!pi&&r(vr,{portal:{target:document.body},containerProps:{style:{zIndex:1001}},align:"center",position:"anchor",overflow:"auto",menuButton:r("button",{type:"button",class:"plain",children:r(ee,{icon:"more",size:"l",alt:z({id:"2FYpfJ"})})}),children:[r(ct,{disabled:S==="loading",onClick:()=>{L("loading"),De.current=gt({text:z({id:"8zsp51"}),duration:-1}),(async function(){try{const te=new FormData;te.append("image",P);const fe=await fetch(pi,{method:"POST",body:te}).then(we=>we.json());if(fe.error)throw new Error(fe.error);_e(fe.description)}catch(te){gt(te.message?z({id:"wy0Iwj",values:{0:te.message}}):z({id:"xhYfVj"}))}finally{L("default"),De.current?.hideToast?.()}})()},children:[r(ee,{icon:"sparkles2"}),f&&f!=="en"?r("small",{children:[r(ne,{id:"o5sTJw"}),r("br",{}),"(English)"]}):r("span",{children:r(ne,{id:"o5sTJw"})})]}),!!f&&f!=="en"&&r(ct,{disabled:S==="loading",onClick:()=>{L("loading"),De.current=gt({text:z({id:"8zsp51"}),duration:-1}),(async function(){try{const te=new FormData;te.append("image",P);const fe=`?lang=${f}`,we=await fetch(pi+fe,{method:"POST",body:te}).then(se=>se.json());if(we.error)throw new Error(we.error);_e(we.description)}catch(te){gt(z({id:"eNTGfp",values:{0:te?.message?`: ${te.message}`:""}}))}finally{L("default"),De.current?.hideToast?.()}})()},children:[r(ee,{icon:"sparkles2"}),r("small",{children:[r(ne,{id:"o5sTJw"}),r("br",{}),r(ne,{id:"m+pAEQ",values:{0:mi(f)},components:{0:r("span",{class:"more-insignificant"})}})]})]})]}),r("button",{type:"button",class:"light block",onClick:()=>{xe(!1)},disabled:S==="loading",children:r(ne,{id:"DPfwMq"})})]})]})]})]})})]})}function vo({onClose:h=()=>{},onSelect:o=()=>{},defaultSearchTerm:f}){const{_:m}=bt(),{masto:v}=vi(),[C,A]=ie("default"),[w,z]=ie([]),[S,L]=ie({}),[le,O]=ie(0),N=async F=>{if(!F?.length)return;const Q=await pa(F,S);Q&&L({...S,...Q})},P=F=>{F&&(A("loading"),(async()=>{try{const Q=await v.v1.accounts.search.list({q:F,limit:40,resolve:!1});z(Q),N(Q),A("default")}catch{A("error")}})())},j=jn(P,1e3);Ae(()=>{P()},[P]);const B=ce();Ae(()=>{B.current&&(B.current.focus(),B.current.value&&(B.current.selectionStart=B.current.value.length,B.current.selectionEnd=B.current.value.length))},[]),Ae(()=>{f&&P(f)},[f]);const H=F=>{const Q=F.acct;o(Q),h()};dn("enter",()=>{const F=w[le];F&&H(F)},{preventDefault:!0,enableOnFormTags:["input"],useKey:!0,ignoreEventWhen:F=>F.metaKey||F.ctrlKey||F.altKey||F.shiftKey});const he=ce();return dn("down",()=>{le<w.length-1?O(le+1):O(0),setTimeout(()=>{const F=he.current.querySelector(".selected");F&&F.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},1)},{preventDefault:!0,enableOnFormTags:["input"],useKey:!0,ignoreEventWhen:F=>F.metaKey||F.ctrlKey||F.altKey||F.shiftKey}),dn("up",()=>{le>0?O(le-1):O(w.length-1),setTimeout(()=>{const F=he.current.querySelector(".selected");F&&F.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},1)},{preventDefault:!0,enableOnFormTags:["input"],useKey:!0,ignoreEventWhen:F=>F.metaKey||F.ctrlKey||F.altKey||F.shiftKey}),r("div",{id:"mention-sheet",class:"sheet",children:[!!h&&r("button",{type:"button",class:"sheet-close",onClick:h,children:r(ee,{icon:"x",alt:m({id:"yz7wBu"})})}),r("header",{children:r("form",{onSubmit:F=>{F.preventDefault(),j.flush?.()},children:r("input",{ref:B,required:!0,type:"search",class:"block",placeholder:m({id:"eH1bqp"}),onInput:F=>{const{value:Q}=F.target;j(Q)},autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellCheck:"false",dir:"auto",enterKeyHint:"search",defaultValue:f||""})})}),r("main",{children:w?.length>0?r("ul",{ref:he,class:`accounts-list ${C==="loading"?"loading":""}`,children:w.map((F,Q)=>{const ve=S[F.id];return r("li",{class:Q===le?"selected":"",children:[r(br,{avatarSize:"xxl",account:F,relationship:ve,showStats:!0,showActivity:!0}),r("button",{type:"button",class:"plain2",onClick:()=>{H(F)},children:r(ee,{icon:"plus",size:"xl",alt:m({id:"m16xKo"})})})]},F.id)})}):C==="loading"?r("div",{class:"ui-state",children:r(Dn,{abrupt:!0})}):C==="error"?r("div",{class:"ui-state",children:r("p",{children:r(ne,{id:"AThL/k"})})}):null})]})}function bo({quoteSuggestion:h,hasCurrentQuoteStatus:o,onAccept:f,onCancel:m}){return h?r("div",{class:"quote-suggestion",children:[r("div",{class:"quote-suggestion-header",children:[r("b",{children:r(ne,{id:"UefSZg"})}),r("div",{class:"quote-suggestion-url",children:h.url})]}),r("div",{class:"quote-status",children:r(Un,{status:h.status,instance:h.instance,size:"s",readOnly:!0})}),r("div",{class:"quote-suggestion-actions",children:[r("span",{class:"spacer"}),r("button",{type:"button",class:"plain",onClick:m,children:o?r(ne,{id:"dEgA5A"}):r(ne,{id:"nc+Oa+"})}),r("button",{type:"button",class:"plain6",onClick:f,children:o?r(ne,{id:"UYZxOy"}):r(ne,{id:"vuFeUI"})})]})]}):null}const yo=bi.reduce((h,o)=>{const[f,m,v]=o;return h[f]={common:m,native:v},h},{}),xo=Object.keys(wr),cr=1440*60,lr=h=>{if(!h)return cr;const o=(Date.parse(h)-Date.now())/1e3;return xo.find(f=>f>=o)||cr},Tt=ta([ma(),...navigator.languages],bi.map(h=>h[0]),"en"),wo=/(^|[^\/\w])[@＠](([a-z0-9_]+)@[a-z0-9\.\-]+[a-z0-9]+)/gi,ko="$2xxxxxxxxxxxxxxxxxxxxxxx";function Eo(h){return h.replace(yr,ko).replace(wo,"$1@$3")}const Ao=na(h=>new Intl.ListFormat(h||void 0)),Ue={camera:{id:"TbrCz2"},media:{id:"MfJ43d"},customEmoji:{id:"ggiJLM"},gif:{id:"Fm6c4W"},poll:{id:"cZJ92q"},sensitive:{id:"x/s2/O"},scheduledPost:{id:"sX3iLV"}},So=Math.max(600*1e3,ga);function Co(h,o){if(!o||o.includes(h))return!0;const[f,m]=h.split("/"),v={};return o.forEach(C=>{const[A,w]=C.split("/");v[w]=A}),!!v[m]}function _o({onClose:h,replyToStatus:o,replyMode:f="all",editStatus:m,draftStatus:v,quoteStatus:C,standalone:A,hasOpener:w}){const{i18n:z,_:S,_:L}=bt(),le=va(z.locale),O=Ao(z.locale),{masto:N,instance:P}=vi(),[j,B]=ie("default"),H=ce(v?.uid||ba()),he=Kt(ia,[]),F=he.info,Q=mr(),{statuses:{maxCharacters:ve,maxMediaAttachments:de,charactersReservedPerUrl:ge}={},mediaAttachments:{supportedMimeTypes:ye,imageSizeLimit:U,imageMatrixLimit:G,videoSizeLimit:re,videoMatrixLimit:Fe,videoFrameRateLimit:Me,descriptionLimit:_e}={},polls:{maxOptions:pe,maxCharactersPerOption:Ne,maxExpiration:Je,minExpiration:Be}={}}=Q||{},$e=ye?.filter(p=>/^(image|video)/i.test(p)),Y=ce(),xe=ce(),[Ee,He]=ie("public"),[De,Ge]=ie("public"),[Ye,te]=ie(!1),[fe,we]=ie(!1),[se,Le]=ie(it.session.get("currentLanguage")||Tt),Te=ce(se),[X,Se]=ie([]),[ae,rt]=ie(null),[Ke,qe]=ie(null),[at,lt]=ie(null),[qt,Wt]=ie(C),[fn,hn]=ie(!1),ze=ra(),Pe=fn?null:qt||C,Nn=p=>{if(!$t())return!1;const{visibility:k,quoteApproval:M,account:T}=p,K=F&&F.id===T.id,q=["public","unlisted"].includes(k),$=K&&k==="private",J=M?.currentUser==="automatic"&&(q||$),Z=M?.currentUser==="manual"&&(q||$);return!q&&!K?!1:J?!0:!!Z},$n=async p=>{if($t()){if(X.length>0||ae||m||Ee==="direct")return;try{const k=await aa(P,p);if(k?.id){const M=Ie.statuses[`${k.instance}/${k.id}`];if(M&&Nn(M)){if(Pe?.id===M.id)return;lt({status:M,instance:k.instance,url:k.originalURL})}}}catch{}}},et=()=>{Y.current&&Y.current.dispatchEvent(new Event("input"))},We=p=>{setTimeout(()=>{Y.current&&(p!==void 0&&Y.current.setSelectionRange(p,p),Y.current?.focus())},300)},yt=({targetElement:p,text:k})=>{if(!p)return;const{selectionStart:M,selectionEnd:T,value:K}=p;let q=K.slice(0,M);q=q.replace(/\u200B$/,"");const $=q?/[\s\t\n\r]$/.test(q)?"":" ":"",J=K.slice(T),Z=/^[\s\t\n\r]/.test(J)?"":" ",Ze=q+$+k+Z+J;p.value=Ze,p.selectionStart=p.selectionEnd=T+k.length+Z.length,p.focus(),p.dispatchEvent(new Event("input"))},xt=ce(null),dt=ce(null),ot=()=>{setTimeout(()=>{xt.current&&xt.current.focus()},0)},ft=ce(null);Ae(()=>{const p=M=>{ft.current.classList.toggle("focused",M.type==="focusin");const T=M.target;T.hasAttribute("data-allow-custom-emoji")&&(dt.current=T),["INPUT","BUTTON","SELECT","TEXTAREA"].includes(T.tagName)&&(xt.current=T)},k=ft.current;return k&&(k.addEventListener("focusin",p),k.addEventListener("focusout",p)),()=>{k&&(k.removeEventListener("focusin",p),k.removeEventListener("focusout",p))}},[]),Ae(()=>{if(o){const{spoilerText:p,visibility:k,language:M,sensitive:T}=o;p&&xe.current&&(xe.current.value=p);const q=[...new Set([o.account.acct,...o.mentions.map($=>$.acct)])].filter($=>$!==F.acct);if(q.length>0){const $=`@${o.account.acct}`,J=q.filter(Z=>Z!==o.account.acct).map(Z=>`@${Z}`);if(f==="author-only")Y.current.value=`${$} `,et(),We();else if(f==="author-first")if(J.length>0){Y.current.value=`${$} 

${J.join(" ")}`,et();const Z=$.length+1;We(Z)}else Y.current.value=`${$} `,et(),We();else Y.current.value=`${q.map(Z=>`@${Z}`).join(" ")} `,et(),We()}He(k==="public"&&ze["posting:default:visibility"]?ze["posting:default:visibility"].toLowerCase():k),Le(M||ze["posting:default:language"]?.toLowerCase()||Tt),te(!!p)}else if(m){const{visibility:p,language:k,sensitive:M,poll:T,mediaAttachments:K,quoteApproval:q}=m,$=!!T?.options&&{...T,options:T.options.map(J=>J?.title||J),expiresIn:T?.expiresIn||lr(T.expiresAt)};B("loading"),(async()=>{try{const J=await N.v1.statuses.$select(m.id).source.fetch(),{text:Z,spoilerText:Ze}=J;if(Y.current.value=Z,Y.current.dataset.source=Z,et(),We(),xe.current.value=Ze,He(p),Le(k||ze["posting:default:language"]?.toLowerCase()||Tt),$t()){const be=ya(q);Ge(be)}te(M),$&&rt($),Se(K),B("default")}catch(J){alert(J?.reason||J),B("error")}})()}else if(We(),ze["posting:default:visibility"]&&He(ze["posting:default:visibility"].toLowerCase()),ze["posting:default:language"]&&Le(ze["posting:default:language"].toLowerCase()),ze["posting:default:sensitive"]&&te(!!ze["posting:default:sensitive"]),ze["posting:default:quote_policy"]){let p=ze["posting:default:quote_policy"].toLowerCase();if(ze["posting:default:visibility"]){const k=ze["posting:default:visibility"].toLowerCase();(k==="private"||k==="direct")&&(p="nobody")}Ge(p)}if(v){const{status:p,spoilerText:k,visibility:M,language:T,sensitive:K,sensitiveMedia:q,poll:$,mediaAttachments:J,scheduledAt:Z,quoteApprovalPolicy:Ze}=v,be=!!$?.options&&{...$,options:$.options.map(Re=>Re?.title||Re),expiresIn:$?.expiresIn||lr($.expiresAt)};Y.current.value=p,et();const je=/^\n|\s/.test(p)?0:void 0;We(je),k&&(xe.current.value=k),M&&He(M),Le(T||ze["posting:default:language"]?.toLowerCase()||Tt),q!==null&&we(q),K!==null&&te(K),be&&rt(be),J&&Se(J),Z&&qe(Z),Ze&&Ge(Ze)}},[v,m,o,f]);const pn=fr(Ie);Ae(()=>{pn.composerState.minimized||We()},[pn.composerState.minimized]);const wt=ce(),Vt=L({id:"hR9gtK"}),zt=()=>{const{value:p,dataset:k}=Y.current;if(j==="loading")return!1;const M=(p||"").trim().replace(new RegExp("^\\p{White_Space}+|\\p{White_Space}+$","gu"),""),T=X.length>0;if(!M&&!T||X.length>0&&X.every(Z=>Z.id))return!0;const q=o?.account.id===F.id,$=o&&p.trim()===`@${o.account.acct}`;return!!(!q&&$||p===k?.source)},Gt=()=>zt()?!0:confirm(Vt);Ae(()=>{const p=k=>{zt()||(k.preventDefault(),k.returnValue=Vt)};return window.addEventListener("beforeunload",p,{capture:!0}),()=>window.removeEventListener("beforeunload",p,{capture:!0})},[]);const kt=()=>{const{value:p}=Y.current,{value:k}=xe.current;return Xi(Eo(p))+Xi(k)},Et=()=>{const p=kt();Ie.composerCharacterCount=p};Ae(Et,[]);const _t=window.CloseWatcher,Mt=ce(!1);dn("esc",()=>{Mt.current=!0},{enabled:!_t,enableOnFormTags:!0,useKey:!0,ignoreEventWhen:p=>p.metaKey||p.ctrlKey||p.altKey||p.shiftKey}),dn("esc",()=>{!A&&Mt.current&&Gt()&&h(),Mt.current=!1},{enabled:!_t,enableOnFormTags:!0,keyup:!0,ignoreEventWhen:p=>{const k=document.querySelectorAll("#modal-container > *"),M=!!k,T=k.length===1&&k[0].querySelector("#compose-container");return M&&!T||p.metaKey||p.ctrlKey||p.altKey||p.shiftKey},useKey:!0}),xa(()=>{!A&&Gt()&&h()},[]);const ht=ce({}),Xe=()=>`${oa()}#${H.current}`,Pt=()=>{if(m||Ie.composerState.minimized)return;const p=Xe(),k={key:p,replyTo:o?{id:o.id,account:{id:o.account.id,username:o.account.username,acct:o.account.acct}}:null,draftStatus:{uid:H.current,status:Y.current.value,spoilerText:xe.current.value,visibility:Ee,language:se,sensitive:Ye,sensitiveMedia:fe,poll:ae,mediaAttachments:X,scheduledAt:Ke,quoteApprovalPolicy:De},quote:Pe?.id?{id:Pe.id}:null};!sa(k,ht.current)&&!zt()&&(Gi.drafts.set(p,{...k,state:"unsaved",updatedAt:Date.now()}).then(()=>{}).catch(M=>{}),ht.current=structuredClone(k))};wa(Pt,5e3),Ae(()=>(Pt(),()=>{Gi.drafts.del(Xe())}),[]),Ae(()=>{const p=M=>{if(document.querySelector(".sheet"))return;const{items:T}=M.clipboardData||M.dataTransfer,K=[],q=[];for(let $=0;$<T.length;$++){const J=T[$];if(J.kind==="file"){const Z=J.getAsFile();Co(Z.type,ye)?K.push(Z):q.push(Z)}}if(q.length>0&&alert(cn._({id:"rpXAF6",values:{0:q.length,1:q[0].name,2:O.format(q.map($=>$.name))}})),K.length>0&&X.length>=de){alert(cn._({id:"ctFhjs",values:{maxMediaAttachments:de}}));return}if(K.length>0){M.preventDefault(),M.stopPropagation();let $=K;if(de!==void 0){const Z=de-X.length;if($=$.slice(0,Z),$.length<=0){alert(cn._({id:"ctFhjs",values:{maxMediaAttachments:de}}));return}}const J=$.map(Z=>({file:Z,type:Z.type,size:Z.size,url:URL.createObjectURL(Z),id:null,description:null}));Se([...X,...J])}};window.addEventListener("paste",p);const k=M=>{M.dataTransfer.items.length>0&&(M.preventDefault(),M.stopPropagation())};return window.addEventListener("dragover",k),window.addEventListener("drop",p),()=>{window.removeEventListener("paste",p),window.removeEventListener("dragover",k),window.removeEventListener("drop",p)}},[X]);const[Yt,Ot]=ie(!1),[Rt,Oe]=ie(!1),[mn,pt]=ie(!1),[D,gn]=ie(null),[Ut,Xt]=Kt(()=>{const p=[],k=[],{contentTranslationHideLanguages:M=[]}=Ie.settings;return bi.forEach(T=>{const[K]=T;K===se||K===Te.current||K===Tt||M.includes(K)||D?.length&&D.includes(K)?p.push(T):k.push(T)}),p.sort(([T,K],[q,$])=>T===se?-1:q===se?1:K.localeCompare($)),k.sort(([T,K],[q,$])=>K.localeCompare($)),[p,k]},[se,D]),vn=Kt(()=>!!o?.createdAt&&Math.floor((Date.now()-Date.parse(o.createdAt))/(1e3*60*60*24*30)),[o]),Bt=()=>{Pt(),Ie.composerState.minimized=!0},tt=j==="loading"||de!==void 0&&X.length>=de||!!ae,Zt=j==="loading"||!!Ye,Qt=()=>{te(!0),setTimeout(()=>{xe.current?.focus()},0)},bn=pe==null||pe>1,Jt=j==="loading"||!!ae||!!X.length,en=()=>{rt({options:["",""],expiresIn:1440*60,multiple:!1}),setTimeout(()=>{ft.current?.querySelector('.poll-choice input[type="text"]')?.focus()},0)},yn=se!==Te.current||D?.length&&!D.includes(se),xn=Ee!=="public",wn=De!=="public",kn=Ee==="private"||Ee==="direct",Dt=ce(),[Hn,nt]=ie(!0),En=42;gr({ref:Dt,box:"border-box",onResize:({width:p})=>{const{scrollWidth:k}=Dt.current,M=k>p,T=p<En*4;nt(T||M),Dt.current.hidden=T}});const tn=!m,An=j==="loading"||!!Ke,Sn=()=>{const p=new Date(Date.now()+So);qe(p)};return r("div",{id:"compose-container-outer",ref:ft,children:[r("div",{id:"compose-container",tabIndex:-1,class:A?"standalone":"",children:[r("div",{class:"compose-top",children:[F?.avatarStatic&&r(br,{account:F,accountInstance:he.instanceURL,hideDisplayName:!0,useAvatarStatic:!0}),A?w&&r("button",{type:"button",class:"light pop-button",disabled:j==="loading",onClick:()=>{if(!window.opener){alert(L({id:"qiPXgY"}));return}if(window.opener.__STATES__.showCompose){if(window.opener.__STATES__.composerState?.publishing){alert(L({id:"Z2l5Bt"}));return}let p=L({id:"AB/GtR"});if(!confirm(p))return}h({fn:()=>{const p={editStatus:m,replyToStatus:o,replyMode:f,draftStatus:{uid:H.current,status:Y.current.value,spoilerText:xe.current.value,visibility:Ee,language:se,sensitive:Ye,sensitiveMedia:fe,poll:ae,mediaAttachments:X,scheduledAt:Ke},quoteStatus:Pe};window.opener.__COMPOSE__=p,window.opener.__STATES__.showCompose?(window.opener.__STATES__.showCompose=!1,setTimeout(()=>{window.opener.__STATES__.showCompose=!0},10)):window.opener.__STATES__.showCompose=!0,window.opener.__STATES__.composerState.minimized&&(window.opener.__STATES__.composerState.minimized=!1)}})},children:r(ee,{icon:"popin",alt:L({id:"/5ZKeE"})})}):r("span",{class:"compose-controls",children:[r("button",{type:"button",class:"plain4 pop-button",disabled:j==="loading",onClick:()=>{ka({editStatus:m,replyToStatus:o,draftStatus:{uid:H.current,status:Y.current.value,spoilerText:xe.current.value,visibility:Ee,language:se,sensitive:Ye,poll:ae,mediaAttachments:X,scheduledAt:Ke},quoteStatus:Pe})&&h()},children:r(ee,{icon:"popout",alt:L({id:"JsU2En"})})}),r("button",{type:"button",class:"plain4 min-button",onClick:Bt,children:r(ee,{icon:"minimize",alt:L({id:"3TSz9S"})})})," ",r("button",{type:"button",class:"plain4 close-button",disabled:j==="loading",onClick:()=>{Gt()&&h()},children:r(ee,{icon:"x",alt:L({id:"yz7wBu"})})})]})]}),!!o&&r("details",{class:"status-preview",open:!0,children:[r(Un,{status:o,size:"s",previewMode:!0}),r("summary",{class:"status-preview-legend reply-to",children:vn>0?r(ne,{id:"Q1Huya",values:{0:o.account.acct||o.account.username,1:le.format(-vn,"month")},components:{0:r("strong",{})}}):r(ne,{id:"dwLCPZ",values:{0:o.account.acct||o.account.username}})})]}),!!m&&r("details",{class:"status-preview",children:[r(Un,{status:m,size:"s",previewMode:!0}),r("summary",{class:"status-preview-legend",children:r(ne,{id:"wKtOLH"})})]}),r("form",{ref:wt,class:`form-visibility-${Ee}`,style:{pointerEvents:j==="loading"?"none":"auto",opacity:j==="loading"?.5:1},onClick:()=>{setTimeout(()=>{document.activeElement||xt.current?.focus?.()},10)},onKeyDown:p=>{p.key==="Enter"&&(p.ctrlKey||p.metaKey)&&wt.current.dispatchEvent(new Event("submit",{cancelable:!0}))},onSubmit:p=>{p.preventDefault();const k=new FormData(p.target),M=Object.fromEntries(k.entries());let{status:T,visibility:K,sensitive:q,sensitiveMedia:$,spoilerText:J,scheduledAt:Z,quoteApprovalPolicy:Ze}=M;if(q=q==="on",$=$==="on",Z=Z?new Date(Z).toISOString():void 0,ae){if(ae.options.length<2){alert(L({id:"zhrMYj"}));return}if(ae.options.some(be=>be==="")){alert(L({id:"uNVxXX"}));return}}X.length>0&&X.some(je=>!je.description?.trim?.())&&!confirm(L({id:"MQYucx"}))||(J=q&&J||void 0,T=T===""?void 0:T,Ie.composerState.publishing=!0,B("loading"),(async()=>{try{if(X.length>0){const Re=X.map(Ve=>{const{file:Cn,description:Kn,id:At}=Ve;if(At)return Ve;{const Fn=dr({file:Cn,description:Kn});return N.v2.media.create(Fn).then(St=>(St.id&&(Ve.id=St.id),St))}}),st=await Promise.allSettled(Re);if(st.some(Ve=>Ve.status==="rejected"||!Ve.value?.id)){Ie.composerState.publishing=!1,Ie.composerState.publishingError=!0,B("error"),st.forEach(Ve=>{Ve.status==="rejected"&&alert(Ve.reason||L({id:"eIiurD",values:{i}}))});return}}let be={status:T,spoiler_text:J,language:se,sensitive:q||$,poll:ae,media_ids:X.map(Re=>Re.id)};m?($t()&&(be.quote_approval_policy=Ze),(Ht("@mastodon")||Ht("@gotosocial/edit-media-attributes"))&&(be.media_attributes=X.map(Re=>({id:Re.id,description:Re.description})))):($t()&&Pe?.id&&(be.quoted_status_id=Pe.id,be.quote_approval_policy=Ze),be.visibility=K,be.in_reply_to_id=o?.id||void 0,be.scheduled_at=Z),be=dr(be);let je;if(m)je=await N.v1.statuses.$select(m.id).update(be),ua(je,P,{skipThreading:!0});else try{je=await N.v1.statuses.create(be,{requestInit:{headers:{"Idempotency-Key":H.current}}})}catch{je=await N.v1.statuses.create(be)}Ie.composerState.minimized=!1,Ie.composerState.publishing=!1,B("default"),h({type:m?"edit":o?"reply":"post",newStatus:je,instance:P,scheduledAt:Z})}catch(be){Ie.composerState.publishing=!1,Ie.composerState.publishingError=!0,alert(be?.reason||be),B("error")}})())},children:[r("div",{children:[r("div",{class:`compose-cw-container ${Ye?"":"collapsed"}`,children:[r("input",{type:"hidden",name:"sensitive",value:Ye?"on":"off"}),r(xi,{keys:":",class:"spoiler-text-field-container",onTrigger:p=>{p?.name==="custom-emojis"&&Oe({targetElement:xe,defaultSearchTerm:p?.defaultSearchTerm||null})},children:r("input",{ref:xe,type:"text",name:"spoilerText",placeholder:L({id:"gnKo7f"}),"data-allow-custom-emoji":"true",disabled:j==="loading",class:"spoiler-text-field",lang:se,spellCheck:"true",autocomplete:"off",dir:"auto",onInput:()=>{Et()},onKeyDown:p=>{p.key==="Enter"&&!p.ctrlKey&&!p.metaKey&&!p.isComposing&&(p.preventDefault(),We())}})}),r("button",{type:"button",class:"close-button plain4 small",onClick:()=>{te(!1),Y.current.focus()},children:r(ee,{icon:"x",alt:L({id:"dEgA5A"})})})]}),r(to,{ref:Y,"data-allow-custom-emoji":"true",placeholder:L(o?{id:"Sjj+EN"}:m?{id:"qzVesX"}:ae?{id:"/fY1js"}:{id:"owpNF1"}),required:X?.length===0,disabled:j==="loading",lang:se,onInput:()=>{Et()},maxCharacters:ve,onTrigger:p=>{p?.name==="custom-emojis"?Oe({targetElement:dt,defaultSearchTerm:p?.defaultSearchTerm||null}):p?.name==="mention"?Ot({defaultSearchTerm:p?.defaultSearchTerm||null}):p?.name==="auto-detect-language"&&p?.languages?gn(p.languages):p?.name==="pasted-link"&&p?.url&&$n(p.url)}})]}),X?.length>0&&r("div",{class:"media-attachments",children:[X.map((p,k)=>{const{id:M,file:T}=p,K=T?.size+T?.type+T?.name;return r(go,{attachment:p,disabled:j==="loading",lang:se,supportedMimeTypes:ye,descriptionLimit:_e,onDescriptionChange:q=>{Se($=>{const J=[...$];return J[k]={...J[k],description:q},J})},onRemove:()=>{Se(q=>q.filter(($,J)=>J!==k))}},M||K||k)}),r("label",{class:"media-sensitive",children:[r("input",{name:"sensitiveMedia",type:"checkbox",checked:fe,disabled:j==="loading",onChange:p=>{const k=p.target.checked;we(k)}})," ",r("span",{children:r(ne,{id:"jER18a"})})," ",r(ee,{icon:`eye-${fe?"close":"open"}`})]})]}),!!ae&&r(Wa,{lang:se,maxOptions:pe,maxExpiration:Je,minExpiration:Be,maxCharactersPerOption:Ne,poll:ae,disabled:j==="loading",onInput:p=>{if(p){const k={...p};rt(k)}else rt(null),ot()}}),!!Pe?.id&&r("div",{class:"quote-status",children:r(Un,{status:Pe,instance:P,size:"s",readOnly:!0})}),Ke&&r("div",{class:"toolbar scheduled-at",children:[r("span",{children:[r("label",{children:r(ne,{id:"GKuKcZ",components:{0:r(Ea,{scheduledAt:Ke,setScheduledAt:qe})}})})," ",r("small",{class:"tag insignificant",children:Aa()})]}),r("button",{type:"button",class:"plain4 close-button small",onClick:()=>{qe(null),ot()},children:r(ee,{icon:"x",alt:L({id:"dEgA5A"})})})]}),r(bo,{quoteSuggestion:at,hasCurrentQuoteStatus:!!Pe?.id,onAccept:()=>{const{status:p}=at,k=Y.current?.value||"",M=Y.current?.selectionStart||0,T=k.lastIndexOf(at.url,M),K=k.slice(0,T)+k.slice(T+at.url.length);Y.current&&(Y.current.value=K,Y.current.dispatchEvent(new Event("input"))),!!Pe?.id?(lt(null),Wt(p)):document.startViewTransition?document.startViewTransition(()=>{lt(null),Wt(p)}):(lt(null),Wt(p)),We()},onCancel:()=>lt(null)}),r("div",{class:"toolbar compose-footer",children:[r("span",{class:"add-toolbar-button-group spacer",children:[Hn&&r(vr,{portal:{target:document.body},containerProps:{style:{zIndex:1001}},menuButton:({open:p})=>r("button",{type:"button",class:`toolbar-button add-button ${p?"active":""}`,children:r(ee,{icon:"plus",title:L({id:"m16xKo"})})}),children:[Ji&&r(ct,{disabled:tt,className:"compose-menu-add-media",children:[r("label",{class:"compose-menu-add-media-field",children:r(Qi,{hidden:!0,supportedMimeTypes:$e,disabled:tt,setMediaAttachments:Se})}),r(ee,{icon:"camera"})," ",r("span",{children:S(Ue.camera)})]}),r(ct,{disabled:tt,className:"compose-menu-add-media",children:[r("label",{class:"compose-menu-add-media-field",children:r(or,{hidden:!0,supportedMimeTypes:ye,maxMediaAttachments:de,mediaAttachments:X,disabled:tt,setMediaAttachments:Se})}),r(ee,{icon:"media"})," ",r("span",{children:S(Ue.media)})]}),r(ct,{disabled:Zt,onClick:Qt,children:[r(ee,{icon:"alert"})," ",r("span",{children:S(Ue.sensitive)})]}),bn&&r(ct,{disabled:Jt,onClick:en,children:[r(ee,{icon:"poll"})," ",r("span",{children:S(Ue.poll)})]}),r(Yi,{}),r(ct,{onClick:()=>{Oe({targetElement:dt})},children:[r(ee,{icon:"emoji2"})," ",r("span",{children:S(Ue.customEmoji)})]}),!!Ie.settings.composerGIFPicker&&r(ct,{disabled:tt,onClick:()=>{pt(!0)},children:[r("span",{class:"icon icon-gif",role:"img"}),r("span",{children:S(Ue.gif)})]}),tn&&r(It,{children:[r(Yi,{}),r(ct,{disabled:An,onClick:Sn,children:[r(ee,{icon:"schedule"})," ",r("span",{children:S(Ue.scheduledPost)})]})]})]}),r("span",{class:"add-sub-toolbar-button-group",ref:Dt,hidden:!0,children:[Ji&&r("label",{class:"toolbar-button",children:[r(Qi,{supportedMimeTypes:$e,mediaAttachments:X,disabled:tt,setMediaAttachments:Se}),r(ee,{icon:"camera",alt:S(Ue.camera)})]}),r("label",{class:"toolbar-button",children:[r(or,{supportedMimeTypes:ye,maxMediaAttachments:de,mediaAttachments:X,disabled:tt,setMediaAttachments:Se}),r(ee,{icon:"media",alt:S(Ue.media)})]}),r("button",{type:"button",class:"toolbar-button",disabled:Zt,onClick:Qt,children:r(ee,{icon:"alert",alt:S(Ue.sensitive)})}),bn&&r("button",{type:"button",class:"toolbar-button",disabled:Jt,onClick:en,children:r(ee,{icon:"poll",alt:S(Ue.poll)})}),r("div",{class:"toolbar-divider"}),r("button",{type:"button",class:"toolbar-button",disabled:j==="loading",onClick:()=>{Oe({targetElement:dt})},children:r(ee,{icon:"emoji2",alt:S(Ue.customEmoji)})}),!!Ie.settings.composerGIFPicker&&r("button",{type:"button",class:"toolbar-button gif-picker-button",disabled:tt,onClick:()=>{pt(!0)},children:r("span",{class:"icon icon-gif","aria-label":S(Ue.gif)})}),tn&&r(It,{children:[r("div",{class:"toolbar-divider"}),r("button",{type:"button",class:`toolbar-button ${Ke?"highlight":""}`,disabled:An,onClick:Sn,children:r(ee,{icon:"schedule",alt:S(Ue.scheduledPost)})})]})]})]}),j==="loading"?r(Dn,{abrupt:!0}):r(za,{maxCharacters:ve,hidden:j==="loading"}),$t()&&r("label",{class:`toolbar-button ${wn?"highlight":""}`,children:[r(ee,{icon:"quote2",alt:"Quote settings"}),De==="followers"&&r(ee,{icon:"group",class:"insignificant"}),De==="nobody"&&r(ee,{icon:"block",class:"insignificant"}),r("select",{name:"quoteApprovalPolicy",value:De,onChange:p=>{Ge(p.target.value)},disabled:j==="loading",dir:"auto",children:[r("option",{value:"public",disabled:kn,children:r(ne,{id:"hDWXuG"})}),r("option",{value:"followers",disabled:kn,children:r(ne,{id:"9Ko+Xp"})}),r("option",{value:"nobody",children:r(ne,{id:"+bAQ3S"})})]})]}),r("label",{class:`toolbar-button ${xn?"highlight":""}`,title:S(ci[Ee]),children:[Ee==="public"||Ee==="direct"?r(ee,{icon:Sa[Ee],alt:S(ci[Ee])}):r("span",{class:"icon-text",children:S(ci[Ee])}),r("select",{name:"visibility",value:Ee,onChange:p=>{if(He(p.target.value),(p.target.value==="private"||p.target.value==="direct")&&Ge("nobody"),p.target.value==="direct"&&Pe?.id){const k=Pe.url;if(k){const M=Y.current.value;M.includes(k)||(Y.current.value=M+(M?`
`:"")+k,et())}hn(!0),gt(L({id:"Z/Vnvj"}))}else if(p.target.value!=="direct"&&fn){const k=(qt||C)?.url;if(k&&Y.current){const M=Y.current.value,T=M.indexOf(k);if(T!==-1){let K=M.slice(0,T)+M.slice(T+k.length);K=K.replace(/\n+$/,""),Y.current.value=K,et()}}hn(!1)}},disabled:j==="loading"||!!m,dir:"auto",children:[r("option",{value:"public",children:r(ne,{id:"7d1a0d"})}),(Ht("@pleroma/local-visibility-post")||Ht("@akkoma/local-visibility-post"))&&r("option",{value:"local",children:r(ne,{id:"d5zxa4"})}),r("option",{value:"unlisted",children:r(ne,{id:"pPYeIN"})}),r("option",{value:"private",children:r(ne,{id:"x5LEuB"})}),r("option",{value:"direct",children:r(ne,{id:"IV4QaU"})})]})]})," ",r("label",{class:`toolbar-button ${yn?"highlight":""}`,children:[r("span",{class:"icon-text",children:yo[se]?.native}),r("select",{name:"language",value:se,onChange:p=>{const{value:k}=p.target;Le(k||Tt),it.session.set("currentLanguage",k||Tt)},disabled:j==="loading",dir:"auto",children:[Ut.map(([p,k,M])=>{const T=mi({code:p,fallback:k});return r("option",{value:p,children:T!==M?`${M} - ${T}`:T},p)}),r("hr",{}),Xt.map(([p,k,M])=>{const T=mi({code:p,fallback:k});return r("option",{value:p,children:T!==M?`${M} - ${T}`:T},p)})]})]})," ",r("button",{type:"submit",disabled:j==="loading",children:L(Ke?{id:"gmB6oO"}:o?{id:"ImOQa9"}:m?{id:"EkH9pt"}:{id:"GMe2XV"})})]})]})]}),Yt&&r(Rn,{onClose:()=>{Ot(!1),ot()},children:r(vo,{masto:N,instance:P,onClose:()=>{Ot(!1)},defaultSearchTerm:Yt?.defaultSearchTerm,onSelect:p=>{const k=Y.current;k&&yt({targetElement:k,text:"@"+p})}})}),Rt&&r(Rn,{onClose:()=>{Oe(!1),ot()},children:r(io,{masto:N,instance:P,onClose:()=>{Oe(!1)},defaultSearchTerm:Rt?.defaultSearchTerm,onSelect:p=>{const k=Rt?.targetElement?.current||Y.current;k&&yt({targetElement:k,text:p})}})}),mn&&r(Rn,{onClose:()=>{pt(!1),ot()},children:r(so,{onClose:()=>pt(!1),onSelect:({url:p,type:k,alt_text:M})=>{if(X.length>=de){alert(cn._({id:"ctFhjs",values:{maxMediaAttachments:de}}));return}(async()=>{let T;try{T=gt({text:L({id:"/Cw4Tx"}),duration:-1});const K=await fetch(p,{referrerPolicy:"no-referrer"}).then(J=>J.blob()),q=new File([K],k==="video/mp4"?"video.mp4":"image.gif",{type:k}),$=[...X,{file:q,type:k,size:q.size,id:null,description:M||""}];Se($),T?.hideToast?.()}catch{T?.hideToast?.(),gt(L({id:"VKDnAx"}))}})()}})})]})}function dr(h){for(let o in h)(h[o]===null||h[o]===void 0)&&delete h[o];return h}export{_o as default};
//# sourceMappingURL=compose-CcFHHxFx.js.map
